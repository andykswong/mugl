(()=>{var e,t,i,r,n={299:(e,t,i)=>{i.d(t,{p:()=>ie,B:()=>re});var r=i(720),n=i(847),s=i(479);const a=(0,s.LI)(s.CJ);class o extends s.r{buffer=null;pipeline=null;constructor(e){super(),this.device=e}init(){const e=s.bl.createShader(this.device,{code:"#version 300 es\nlayout (location=0) in vec3 position;\nlayout (location=1) in vec4 color;\nout vec4 vColor;\nvoid main () {\n  gl_Position = vec4(position, 1);\n  vColor = color;\n}\n",usage:r.$X.Vertex}),t=s.bl.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nin vec4 vColor;\nout vec4 outColor;\nvoid main () {\n  outColor = vColor;\n}\n",usage:r.$X.Fragment});this.buffer=(0,s.gS)(this.device,a),this.pipeline=s.bl.createRenderPipeline(this.device,{vertex:e,fragment:t,buffers:(0,n.O5)([{attributes:[r.gB.F32x3,r.gB.F32x4]}])}),this.register([this.buffer,this.pipeline,e,t])}render(e){return s.bl.beginDefaultPass(this.device,{clearColor:[.1,.2,.3,1]}),s.bl.setRenderPipeline(this.device,this.pipeline),s.bl.setVertex(this.device,0,this.buffer),s.bl.draw(this.device,3),s.bl.submitRenderPass(this.device),!1}}const l=(0,s.MA)([0,1,2]),c=(0,s.om)([0,-.05,-.05,0,.05,.05]),u=new Float32Array(500),d=new Float32Array(100);for(let e=0;e<100;e++){d[e]=Math.random()*(2*Math.PI),u[5*e]=2*Math.floor(e/10)/10-1+.1,u[5*e+1]=e%10*2/10-1+.1;const t=Math.floor(e/10)/10,i=e%10/10,r=t*i+.2;u[5*e+2]=t,u[5*e+3]=i,u[5*e+4]=r}class f extends s.r{pipeline=null;indexBuffer=null;position=null;offsetColor=null;angle=null;bindGroup=null;ambient=null;ambientData=new Float32Array(4);t=0;constructor(e){super(),this.device=e}init(){const e=s.bl.createShader(this.device,{code:"#version 300 es\nlayout (location=0) in vec2 position;\nlayout (location=1) in vec2 offset;\nlayout (location=2) in vec3 color;\nlayout (location=3) in float angle;\nout vec3 vColor;\nvoid main() {\n  gl_Position = vec4(\n    cos(angle) * position.x + sin(angle) * position.y + offset.x,\n    -sin(angle) * position.x + cos(angle) * position.y + offset.y,\n    0, 1);\n  vColor = color;\n}\n",usage:r.$X.Vertex}),t=s.bl.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nlayout(std140) uniform Data {\n  vec3 ambient;\n};\nin vec3 vColor;\nout vec4 outColor;\nvoid main () {\n  outColor = vec4(ambient + vColor, 1.0);\n}\n",usage:r.$X.Fragment});this.indexBuffer=(0,s.gS)(this.device,l,r.FB.Index),this.position=(0,s.gS)(this.device,c),this.offsetColor=(0,s.gS)(this.device,u),this.angle=(0,s.gS)(this.device,d,r.FB.Vertex|r.FB.Stream),this.ambient=(0,s.gS)(this.device,this.ambientData,r.FB.Uniform|r.FB.Stream);const i=s.bl.createBindGroupLayout(this.device,{entries:[{label:"Data",type:r.$l.Buffer}]});this.bindGroup=s.bl.createBindGroup(this.device,{layout:i,entries:[{buffer:this.ambient}]}),this.pipeline=s.bl.createRenderPipeline(this.device,{vertex:e,fragment:t,buffers:(0,n.O5)([{attributes:[r.gB.F32x2]},{attributes:[r.gB.F32x2,r.gB.F32x3],instanced:!0},{attributes:[r.gB.F32],instanced:!0}]),bindGroups:[i]}),this.register([this.bindGroup,this.indexBuffer,this.position,this.offsetColor,this.angle,this.pipeline,e,t,i])}render(e){for(let t=0;t<100;t++)d[t]+=this.t-e-2*Math.PI*Math.floor(d[t]/Math.PI/2);this.t=e,s.bl.writeBuffer(this.device,this.angle,d);const t=Math.sin(e)/2;return this.ambientData[0]=this.ambientData[1]=this.ambientData[2]=t,s.bl.writeBuffer(this.device,this.ambient,this.ambientData),s.bl.beginDefaultPass(this.device,{clearColor:[0,0,0,1]}),s.bl.setRenderPipeline(this.device,this.pipeline),s.bl.setIndex(this.device,this.indexBuffer),s.bl.setVertex(this.device,0,this.position),s.bl.setVertex(this.device,1,this.offsetColor),s.bl.setVertex(this.device,2,this.angle),s.bl.setBindGroup(this.device,0,this.bindGroup),s.bl.drawIndexed(this.device,3,100),s.bl.submitRenderPass(this.device),!0}}const h=new Array(16);function p(e,t,i=0,r=0,n=e.length-i){for(let s=0;s<n;++s)t[r+s]=e[i+s];return t}function g(e=0,t=0,i=0,r=0){return[e,t,i,r]}function b(e=0,t=0,i=0){return[e,t,i]}function v(e,t){return function(e,t){let i=0;for(let r=0;r<e.length;++r)i+=e[r]*t[r];return i}(e,t)}function m(e,t=b()){return function(e,t,i){for(let r=0;r<e.length;++r)i[r]=e[r]*t;return i}(e,1/(function(e){return Math.sqrt(v(e,e))}(e)||1),t)}function x(e,t,i=b()){const r=e[2]*t[0]-t[2]*e[0],n=e[0]*t[1]-t[0]*e[1];return i[0]=e[1]*t[2]-t[1]*e[2],i[1]=r,i[2]=n,i}function B(e){for(let t=0;t<16;++t)e[t]=t%5?0:1;return e}function y(e,t,i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]){return function(e,t,i,r){const n=t.length/4,s=i.length/4;let a=0;h.length=n*s;for(let e=0;e<s;++e)for(let r=0;r<n;++r){a=0;for(let s=0;s<4;++s)a+=t[s*n+r]*i[4*e+s];h[e*n+r]=a}return p(h,r,0,0,h.length),r}(0,e,t,i)}b(),g(),g();const S=b(),w=b(),F=b();function D(e,t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]){return B(t),t[0]=e[0],t[5]=e[1],t[10]=e[2],t}function P(e,t,i,r=1/0,n=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]){const s=1/Math.tan(t/2);if(B(n),n[0]=s/e,n[5]=s,n[11]=-1,n[15]=0,isFinite(r)){const e=1/(i-r);n[10]=(i+r)*e,n[14]=2*i*r*e}else n[10]=-1,n[14]=-2*i;return n}function k(e,t=b(),i=b(0,1,0),r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]){const n=function(e,t,i=b()){return function(e,t,i){for(let r=0;r<e.length;++r)i[r]=e[r]-t[r];return i}(e,t,i)}(t,e,S);m(n,n);const s=x(n,i,w);m(s,s);const a=x(s,n,F);return m(a,a),r[0]=s[0],r[1]=a[0],r[2]=-n[0],r[4]=s[1],r[5]=a[1],r[6]=-n[1],r[8]=s[2],r[9]=a[2],r[10]=-n[2],r[12]=-v(s,e),r[13]=-v(a,e),r[14]=v(n,e),r[3]=r[7]=r[11]=0,r[15]=1,r}const M=512,R=(0,s.LI)({positions:s.Xv.positions,uvs:s.Xv.uvs}),C=(0,s.iy)(s.Xv),G=(0,s.LI)(s.lD);class T extends s.r{offscreenPass=null;vertBuffer=null;indexBuffer=null;quadVertBuffer=null;cubeDataBuffer=null;cubePipeline=null;quadPipeline=null;colorTex=null;uvTex=null;positionTex=null;depthTex=null;offscreenTexSampler=null;offscreenTexBindGroup=null;cubeBindGroup=null;cubeData=new Float32Array(40);constructor(e){super(),this.device=e}init(){const e=s.bl.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nlayout(std140) uniform Data {\n  mat4 model, vp;\n  vec3 color;\n};\nlayout(location = 0) in vec3 position;\nlayout(location = 1) in vec2 uv;\nout vec3 vPosition;\nout vec2 vUv;\nvoid main(void) {\n  vec4 worldPos = model * vec4(position, 1.0);\n  vPosition = worldPos.xyz;\n  vUv = uv;\n  gl_Position = vp * worldPos;\n}",usage:r.$X.Vertex}),t=s.bl.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nlayout(std140) uniform Data {\n  mat4 model;\n  mat4 vp;\n  vec3 color;\n};\nin vec3 vPosition;\nin vec2 vUv;\nlayout(location = 0) out vec4 out0;\nlayout(location = 1) out vec4 out1;\nlayout(location = 2) out vec4 out2;\nvoid main(void) {\n  out0 = vec4(color, 1.0);\n  out1 = vec4(vUv, 0.0, 0.0);\n  out2 = vec4(vPosition, 0.0);\n}",usage:r.$X.Fragment}),i=s.bl.createShader(this.device,{code:"#version 300 es\nlayout (location=0) in vec3 position;\nlayout (location=1) in vec2 uv;\nout vec2 vUv;\nvoid main(void) {\n  gl_Position = vec4(position, 1.0);\n  vUv = uv;\n}\n",usage:r.$X.Vertex}),a=s.bl.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nuniform sampler2D tex0, tex1, tex2;\nin vec2 vUv;\nout vec4 outColor;\nvoid main(void) {\n  vec4 colorSum =\n    texture(tex0, vUv * 2.0 - vec2(0.0, 1.0)) * step(0.5, 1.0 - vUv.x) * step(0.5, vUv.y) +\n    texture(tex1, vUv * 2.0 - vec2(0.0, 0.0)) * step(0.5, 1.0 - vUv.x) * step(0.5, 1.0 - vUv.y) +\n    texture(tex2, vUv * 2.0 - vec2(1.0, 1.0)) * step(0.5, vUv.x) * step(0.5, vUv.y);\n    outColor = vec4(colorSum.rgb, 1.0);\n}\n",usage:r.$X.Fragment}),o=s.bl.createBindGroupLayout(this.device,{entries:[{label:"Data",type:r.$l.Buffer}]});this.vertBuffer=(0,s.gS)(this.device,R),this.indexBuffer=(0,s.gS)(this.device,C,r.FB.Index),this.cubeDataBuffer=(0,s.gS)(this.device,this.cubeData,r.FB.Uniform|r.FB.Stream),this.cubeBindGroup=s.bl.createBindGroup(this.device,{layout:o,entries:[{buffer:this.cubeDataBuffer}]}),this.cubePipeline=s.bl.createRenderPipeline(this.device,{vertex:e,fragment:t,buffers:(0,n.O5)([{attributes:[r.gB.F32x3,r.gB.F32x2]}]),bindGroups:[o],depthStencil:{depthCompare:r.wb.LessEqual,depthWrite:!0},primitive:{cullMode:r.Wf.Back}});const l=s.bl.createBindGroupLayout(this.device,{entries:[{binding:0,label:"tex0",type:r.$l.Texture},{binding:1,label:"tex0",type:r.$l.Sampler},{binding:2,label:"tex1",type:r.$l.Texture},{binding:3,label:"tex1",type:r.$l.Sampler},{binding:4,label:"tex2",type:r.$l.Texture},{binding:5,label:"tex2",type:r.$l.Sampler}]});this.quadVertBuffer=(0,s.gS)(this.device,G),this.colorTex=s.bl.createTexture(this.device,{size:[M,M,1],sampleCount:4}),this.uvTex=s.bl.createTexture(this.device,{size:[M,M,1],sampleCount:4}),this.positionTex=s.bl.createTexture(this.device,{size:[M,M,1],sampleCount:4}),this.offscreenTexSampler=s.bl.createSampler(this.device,{magFilter:r.X9.Linear,minFilter:r.X9.Linear}),this.offscreenTexBindGroup=s.bl.createBindGroup(this.device,{layout:l,entries:[{binding:0,texture:this.colorTex},{binding:1,sampler:this.offscreenTexSampler},{binding:2,texture:this.uvTex},{binding:3,sampler:this.offscreenTexSampler},{binding:4,texture:this.positionTex},{binding:5,sampler:this.offscreenTexSampler}]}),this.quadPipeline=s.bl.createRenderPipeline(this.device,{vertex:i,fragment:a,bindGroups:[l],buffers:(0,n.O5)([{attributes:[r.gB.F32x3,r.gB.F32x2]}])}),this.depthTex=s.bl.createTexture(this.device,{format:r.EV.Depth16,size:[M,M,1],usage:r.v2.RenderAttachment,sampleCount:4}),this.offscreenPass=s.bl.createRenderPass(this.device,{colors:[{view:{texture:this.colorTex},clear:[.1,.2,.3,1]},{view:{texture:this.uvTex},clear:[.3,.1,.2,1]},{view:{texture:this.positionTex},clear:[.1,.3,.2,1]}],depthStencil:{texture:this.depthTex},clearDepth:1}),this.register([this.offscreenPass,this.cubePipeline,this.vertBuffer,this.indexBuffer,this.cubeDataBuffer,this.cubeBindGroup,this.quadPipeline,this.quadVertBuffer,this.offscreenTexBindGroup,this.colorTex,this.uvTex,this.positionTex,this.depthTex,this.offscreenTexSampler,t,e,a,i,o,l])}render(e){{const t=b(.5,.5,.5),i=y(P(this.width/this.height,Math.PI/4,.01,100),k(function(e,t,i=b()){return function(e,t,i){for(let r=0;r<e.length;++r)i[r]=e[r]+t[r];return i}(e,t,i)}([5*Math.cos(e),2.5*Math.sin(e),5*Math.sin(e)],t),t));let r=function(e,t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]){return B(t),p(e,t,0,12,3),t}(t);r=y(r,D([.5,.5,.5]),r),p(r,this.cubeData,0,0,16),p(i,this.cubeData,0,16,16),p([1,1,1],this.cubeData,0,32,3),s.bl.writeBuffer(this.device,this.cubeDataBuffer,this.cubeData)}return s.bl.beginRenderPass(this.device,this.offscreenPass),s.bl.setRenderPipeline(this.device,this.cubePipeline),s.bl.setIndex(this.device,this.indexBuffer),s.bl.setVertex(this.device,0,this.vertBuffer),s.bl.setBindGroup(this.device,0,this.cubeBindGroup),s.bl.drawIndexed(this.device,C.length),s.bl.submitRenderPass(this.device),s.bl.beginDefaultPass(this.device,{clearColor:[0,0,0,1],clearDepth:1}),s.bl.setRenderPipeline(this.device,this.quadPipeline),s.bl.setVertex(this.device,0,this.quadVertBuffer),s.bl.setBindGroup(this.device,0,this.offscreenTexBindGroup),s.bl.draw(this.device,6),s.bl.submitRenderPass(this.device),!0}}var I=i(838);const A=s.c4,_=(0,s.LI)({positions:s.Xv.positions,normals:s.Xv.normals,uvs:s.Xv.uvs}),U=(0,s.iy)(s.Xv);class L extends s.r{vertBuffer=null;indexBuffer=null;matBuffer=null;envBuffer=null;cubeDataBuffer=null;skyDataBuffer=null;cubePipeline=null;cubeTex=null;skyPipeline=null;skyTex=null;sampler=null;envBindGroup=null;cubeTexBindGroup=null;cubeDataBindGroup=null;skyTexBindGroup=null;skyDataBindGroup=null;cubeData=new Float32Array(36);skyData=new Float32Array(36);constructor(e){super(),this.device=e}init(){const e=(0,s.Kz)("airplane"),t=(0,s.Kz)("sky0"),i=(0,s.Kz)("sky1"),a=(0,s.Kz)("sky2"),o=s.bl.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nlayout(std140) uniform Data {\n  mat4 model, viewProj;\n  vec4 camPos;\n};\nlayout (location=0) in vec3 position;\nlayout (location=1) in vec2 uv;\nlayout (location=2) in vec3 normal;\nout vec3 vPosition;\nout vec2 vUv;\nout vec3 vNormal;\n\nvoid main(void) {\n  vec4 worldPos = model * vec4(position, 1.0);\n  vPosition = worldPos.xyz / worldPos.w;\n  vNormal = mat3(model) * normalize(normal);\n  vUv = uv;\n  gl_Position = viewProj * worldPos;\n}\n",usage:r.$X.Vertex}),l=s.bl.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nuniform sampler2D tex;\nlayout(std140) uniform Data {\n  mat4 model, viewProj;\n  vec4 camPos;\n};\nlayout(std140) uniform Material {\n  vec4 albedo;\n  vec2 metallicRoughness;\n};\nlayout(std140) uniform Env {\n  vec4 ambient;\n  vec4 lightDir;\n  vec4 lightColor;\n};\n\nin vec3 vPosition;\nin vec2 vUv;\nin vec3 vNormal;\nout vec4 color;\n\nconst float PI = 3.14159265359;\n\nvec3 toSrgb(vec3 color) {\n  return pow(color, vec3(1.0/2.2));\n}\n\nvec4 toLinear(vec4 srgbIn) {\n  return vec4(pow(srgbIn.rgb, vec3(2.2)), srgbIn.a);\n}\n\nvec3 diffuse(vec3 color) {\n  return color / PI;\n}\n\nfloat specularD(float aSqr, float nDotH) {\n  float f = (nDotH * nDotH) * (aSqr - 1.0) + 1.0;\n  return aSqr / (PI * f * f);\n}\n\nvec3 specularF(vec3 r0, vec3 r90, float vDotH) {\n  return r0 + (r90 - r0) * pow(clamp(1.0 - vDotH, 0.0, 1.0), 5.0);\n}\n\nfloat specularG(float aSqr, float nDotL, float nDotV) {\n  float gl = 2.0 * nDotL / (nDotL + sqrt(aSqr + (1.0 - aSqr) * (nDotL * nDotL)));\n  float gv = 2.0 * nDotV / (nDotV + sqrt(aSqr + (1.0 - aSqr) * (nDotV * nDotV)));\n  return gl * gv;\n}\n\nvoid main () {\n  vec3 n = normalize(vNormal);\n  vec3 v = normalize(camPos.xyz - vPosition);\n  vec3 l = normalize(-lightDir.xyz);\n  vec3 h = normalize(l + v);\n\n  float nDotL = clamp(dot(n, l), 0.001, 1.0);\n  float nDotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n  float nDotH = clamp(dot(n, h), 0.0, 1.0);\n  float vDotH = clamp(dot(v, h), 0.0, 1.0);\n\n  vec4 baseColor = toLinear(texture(tex, vUv)) * albedo;\n\n  vec3 f0 = vec3(0.04);\n  vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0) * (1.0 - metallicRoughness.x);\n  vec3 specularColor = mix(f0, baseColor.rgb, metallicRoughness.x);\n\n  float r0 = max(max(specularColor.r, specularColor.g), specularColor.b);\n  float r90 = clamp(r0 * 25.0, 0.0, 1.0);\n  vec3 specularEnvR0 = specularColor.rgb;\n  vec3 specularEnvR90 = vec3(1.0, 1.0, 1.0) * r90;\n\n  float a = clamp(metallicRoughness.y, 0.04, 1.0);\n  a *= a;\n  float aSqr = a * a;\n\n  vec3 color0 = vec3(0.0);\n\n  vec3 F = specularF(specularEnvR0, specularEnvR90, vDotH);\n  float D = specularD(aSqr, nDotH);\n  float G = specularG(aSqr, nDotL, nDotV);\n\n  vec3 diffuse = (1.0 - F) * diffuse(diffuseColor);\n  vec3 specular = F * G * D / (4.0 * nDotL * nDotV);\n\n  color0 += nDotL * lightColor.rgb * lightColor.a * (diffuse + specular);\n  color0 += ambient.rgb * diffuseColor;\n\n  color = vec4(toSrgb(color0), baseColor.a);\n}",usage:r.$X.Fragment}),c=s.bl.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nuniform samplerCube tex;\nin vec3 vPosition;\nout vec4 color;\nvoid main () {\n  color = texture(tex, normalize(vPosition));\n}",usage:r.$X.Fragment});this.matBuffer=(0,s.gS)(this.device,(0,s.om)([1,1,1,1,.5,.5,0,0]),r.FB.Uniform),this.envBuffer=(0,s.gS)(this.device,(0,s.om)([223/255*.75,246/255*.75,245/255*.75,1,1,-2,1,0,252/255,203/255,203/255,5]),r.FB.Uniform),this.vertBuffer=(0,s.gS)(this.device,_),this.indexBuffer=(0,s.gS)(this.device,U,r.FB.Index),this.cubeDataBuffer=(0,s.gS)(this.device,this.cubeData,r.FB.Uniform|r.FB.Stream),this.skyDataBuffer=(0,s.gS)(this.device,this.skyData,r.FB.Uniform|r.FB.Stream);const u=s.bl.createBindGroupLayout(this.device,{entries:[{binding:0,label:"tex",type:r.$l.Texture},{binding:1,label:"tex",type:r.$l.Sampler}]}),d=s.bl.createBindGroupLayout(this.device,{entries:[{binding:0,label:"Material",type:r.$l.Buffer},{binding:1,label:"Env",type:r.$l.Buffer}]}),f=s.bl.createBindGroupLayout(this.device,{entries:[{label:"Data",type:r.$l.Buffer}]});this.cubeTex=s.bl.createTexture(this.device,{size:[A,A,1]}),e&&(s.bl.copyExternalImageToTexture(this.device,{src:e},{texture:this.cubeTex}),I.generateMipmap(this.device,this.cubeTex)),this.sampler=s.bl.createSampler(this.device,{magFilter:r.X9.Linear,minFilter:r.X9.Linear,mipmapFilter:r.X9.Linear,maxAnisotropy:16}),this.cubeTexBindGroup=s.bl.createBindGroup(this.device,{layout:u,entries:[{binding:0,texture:this.cubeTex},{binding:1,sampler:this.sampler}]}),this.envBindGroup=s.bl.createBindGroup(this.device,{layout:d,entries:[{binding:0,buffer:this.matBuffer},{binding:1,buffer:this.envBuffer}]}),this.cubeDataBindGroup=s.bl.createBindGroup(this.device,{layout:f,entries:[{buffer:this.cubeDataBuffer}]});const h={vertex:o,fragment:l,buffers:(0,n.O5)([{attributes:[r.gB.F32x3,r.gB.F32x2,r.gB.F32x3]}]),bindGroups:[u,d,f],depthStencil:{depthWrite:!0,depthCompare:r.wb.LessEqual},primitive:{cullMode:r.Wf.Back}};if(this.cubePipeline=s.bl.createRenderPipeline(this.device,h),this.skyTex=s.bl.createTexture(this.device,{dimension:r.kd.CubeMap,size:[A,A,1]}),t&&i&&a){const e=[t,t,i,a,t,t];for(let t=0;t<6;++t)s.bl.copyExternalImageToTexture(this.device,{src:e[t]},{texture:this.skyTex,origin:[0,0,t]});I.generateMipmap(this.device,this.skyTex)}this.skyTexBindGroup=s.bl.createBindGroup(this.device,{layout:u,entries:[{binding:0,texture:this.skyTex},{binding:1,sampler:this.sampler}]}),this.skyDataBindGroup=s.bl.createBindGroup(this.device,{layout:f,entries:[{buffer:this.skyDataBuffer}]}),this.skyPipeline=s.bl.createRenderPipeline(this.device,{vertex:o,fragment:c,buffers:h.buffers,bindGroups:[u,f],depthStencil:h.depthStencil,primitive:{cullMode:r.Wf.Front}}),this.register([this.vertBuffer,this.indexBuffer,this.matBuffer,this.envBuffer,this.cubeDataBuffer,this.skyDataBuffer,this.cubePipeline,this.cubeTex,this.skyPipeline,this.skyTex,this.sampler,this.envBindGroup,this.cubeDataBindGroup,this.cubeTexBindGroup,this.skyDataBindGroup,this.skyTexBindGroup,o,l,c,u,d,f])}render(e){{const t=b(10*Math.cos(e),5*Math.sin(e),10*Math.sin(e)),i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r=y(P(this.width/this.height,Math.PI/4,.01,100),k(t,[0,0,0]));p(i,this.cubeData,0,0,16),p(r,this.cubeData,0,16,16),p(t,this.cubeData,0,32,3),s.bl.writeBuffer(this.device,this.cubeDataBuffer,this.cubeData),p(D([10,10,10]),this.skyData,0,0,16),p(r,this.skyData,0,16,16),p(t,this.skyData,0,32,3),s.bl.writeBuffer(this.device,this.skyDataBuffer,this.skyData)}return s.bl.beginDefaultPass(this.device,{clearColor:[0,0,0,1],clearDepth:1}),s.bl.setRenderPipeline(this.device,this.cubePipeline),s.bl.setIndex(this.device,this.indexBuffer),s.bl.setVertex(this.device,0,this.vertBuffer),s.bl.setBindGroup(this.device,0,this.cubeTexBindGroup),s.bl.setBindGroup(this.device,1,this.envBindGroup),s.bl.setBindGroup(this.device,2,this.cubeDataBindGroup),s.bl.drawIndexed(this.device,U.length),s.bl.setRenderPipeline(this.device,this.skyPipeline),s.bl.setIndex(this.device,this.indexBuffer),s.bl.setVertex(this.device,0,this.vertBuffer),s.bl.setBindGroup(this.device,0,this.skyTexBindGroup),s.bl.setBindGroup(this.device,1,this.skyDataBindGroup),s.bl.drawIndexed(this.device,U.length),s.bl.submitRenderPass(this.device),!0}}const E=512,O=[[-1,-1,-1,0,-1,8,-1,0,-1,-1,-1,0,0,0,0,0],[-2,-1,0,0,-1,1,1,0,0,1,2,0,0,0,0,0],[0,-1,0,0,-1,4,-1,0,0,-1,0,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0]],$=(0,s.LI)({positions:s.Xv.positions,colors:s.Xv.colors}),X=(0,s.iy)(s.Xv),V=(0,s.LI)(s.lD);class j extends s.r{offscreenPass=null;vertBuffer=null;indexBuffer=null;quadVertBuffer=null;cubeDataBuffer=null;kernelDataBuffer=null;cubePipeline=null;quadPipeline=null;offscreenTex=null;offscreenTexSampler=null;depthTex=null;offscreenTexBindGroup=null;cubeBindGroup=null;kernelBindGroup=null;cubeData=new Float32Array(16);kernelData=new Float32Array(20);constructor(e){super(),this.device=e}init(){const e=s.bl.createShader(this.device,{code:"#version 300 es\nlayout(std140) uniform Data {\n  mat4 mvp;\n};\nlayout (location=0) in vec4 position;\nlayout (location=1) in vec4 color;\nout vec4 vColor;\nvoid main(void) {\n  gl_Position = mvp * position;\n  vColor = color;\n}",usage:r.$X.Vertex}),t=s.bl.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nin vec4 vColor;\nout vec4 outColor;\nvoid main(void) {\n  outColor = vColor;\n}",usage:r.$X.Fragment}),i=s.bl.createShader(this.device,{code:"#version 300 es\nlayout (location=0) in vec4 position;\nlayout (location=1) in vec2 uv;\nout vec2 vUv;\nvoid main(void) {\n  gl_Position = position;\n  vUv = uv;\n}",usage:r.$X.Vertex}),a=s.bl.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nuniform sampler2D tex;\nlayout(std140) uniform Data {\n  mat4 kernel;\n  vec2 texSize;\n  float kernelWeight;\n};\nin vec2 vUv;\nout vec4 outColor;\nvoid main(void) {\n  vec2 onePixel = vec2(1.0, 1.0) / texSize;\n  vec4 colorSum =\n    texture(tex, vUv + onePixel * vec2(-1, -1)) * kernel[0][0] +\n    texture(tex, vUv + onePixel * vec2( 0, -1)) * kernel[0][1] +\n    texture(tex, vUv + onePixel * vec2( 1, -1)) * kernel[0][2] +\n    texture(tex, vUv + onePixel * vec2(-1,  0)) * kernel[1][0] +\n    texture(tex, vUv + onePixel * vec2( 0,  0)) * kernel[1][1] +\n    texture(tex, vUv + onePixel * vec2( 1,  0)) * kernel[1][2] +\n    texture(tex, vUv + onePixel * vec2(-1,  1)) * kernel[2][0] +\n    texture(tex, vUv + onePixel * vec2( 0,  1)) * kernel[2][1] +\n    texture(tex, vUv + onePixel * vec2( 1,  1)) * kernel[2][2] ;\n    outColor = vec4((colorSum / kernelWeight).rgb, 1);\n}",usage:r.$X.Fragment}),o=s.bl.createBindGroupLayout(this.device,{entries:[{label:"Data",type:r.$l.Buffer}]});this.vertBuffer=(0,s.gS)(this.device,$),this.indexBuffer=(0,s.gS)(this.device,X,r.FB.Index),this.cubeDataBuffer=(0,s.gS)(this.device,this.cubeData,r.FB.Uniform|r.FB.Stream),this.cubeBindGroup=s.bl.createBindGroup(this.device,{layout:o,entries:[{buffer:this.cubeDataBuffer}]}),this.cubePipeline=s.bl.createRenderPipeline(this.device,{vertex:e,fragment:t,buffers:(0,n.O5)([{attributes:[r.gB.F32x3,r.gB.F32x4]}]),bindGroups:[o],depthStencil:{depthCompare:r.wb.LessEqual,depthWrite:!0},primitive:{cullMode:r.Wf.Back}});const l=s.bl.createBindGroupLayout(this.device,{entries:[{binding:0,label:"tex",type:r.$l.Texture},{binding:1,label:"tex",type:r.$l.Sampler}]});this.quadVertBuffer=(0,s.gS)(this.device,V),this.kernelDataBuffer=(0,s.gS)(this.device,this.kernelData,r.FB.Uniform|r.FB.Stream),this.offscreenTex=s.bl.createTexture(this.device,{size:[E,E,1],sampleCount:1}),this.offscreenTexSampler=s.bl.createSampler(this.device,{magFilter:r.X9.Linear,minFilter:r.X9.Linear}),this.offscreenTexBindGroup=s.bl.createBindGroup(this.device,{layout:l,entries:[{binding:0,texture:this.offscreenTex},{binding:1,sampler:this.offscreenTexSampler}]}),this.kernelBindGroup=s.bl.createBindGroup(this.device,{layout:o,entries:[{buffer:this.kernelDataBuffer}]}),this.quadPipeline=s.bl.createRenderPipeline(this.device,{vertex:i,fragment:a,bindGroups:[l,o],buffers:(0,n.O5)([{attributes:[r.gB.F32x3,r.gB.F32x2]}])}),this.depthTex=s.bl.createTexture(this.device,{format:r.EV.Depth16,size:[E,E,1],usage:r.v2.RenderAttachment,sampleCount:1}),this.offscreenPass=s.bl.createRenderPass(this.device,{colors:[{view:{texture:this.offscreenTex},clear:[.25,.25,.25,1]}],depthStencil:{texture:this.depthTex},clearDepth:1}),this.register([this.cubePipeline,this.vertBuffer,this.indexBuffer,this.cubeDataBuffer,this.kernelDataBuffer,this.quadPipeline,this.quadVertBuffer,this.offscreenTex,this.offscreenTexSampler,this.depthTex,this.offscreenPass,this.cubeBindGroup,this.offscreenTexBindGroup,this.kernelBindGroup,t,e,a,i,l,o])}render(e){p(y(P(this.width/this.height,Math.PI/4,.01,100),k([10*Math.cos(e),5*Math.sin(e),10*Math.sin(e)],[0,0,0])),this.cubeData,0,0,16),s.bl.writeBuffer(this.device,this.cubeDataBuffer,this.cubeData);{const t=O[Math.floor(e/2)%O.length];let i=0;for(let e=0;e<t.length;++e)i+=t[e];i=i<=0?1:i,p(t,this.kernelData,0,0,16),this.kernelData[16]=E,this.kernelData[17]=E,this.kernelData[18]=i,s.bl.writeBuffer(this.device,this.kernelDataBuffer,this.kernelData)}return s.bl.beginRenderPass(this.device,this.offscreenPass),s.bl.setRenderPipeline(this.device,this.cubePipeline),s.bl.setIndex(this.device,this.indexBuffer),s.bl.setVertex(this.device,0,this.vertBuffer),s.bl.setBindGroup(this.device,0,this.cubeBindGroup),s.bl.drawIndexed(this.device,X.length),s.bl.submitRenderPass(this.device),s.bl.beginDefaultPass(this.device,{clearColor:[0,0,0,1],clearDepth:1}),s.bl.setRenderPipeline(this.device,this.quadPipeline),s.bl.setVertex(this.device,0,this.quadVertBuffer),s.bl.setBindGroup(this.device,0,this.offscreenTexBindGroup),s.bl.setBindGroup(this.device,1,this.kernelBindGroup),s.bl.draw(this.device,6),s.bl.submitRenderPass(this.device),!0}}const q=(0,s.LI)({positions:s.Xv.positions,uvs:s.Xv.uvs}),z=(0,s.iy)(s.Xv),W=z.length,N=new Uint16Array(2*W);for(let e=0;e<W;++e)N[e]=z[e];for(let e=0;e<W;e+=3)N[W+e]=z[e+2],N[W+e+1]=z[e+1],N[W+e+2]=z[e];const H=s.c4;class K extends s.r{vertBuffer=null;indexBuffer=null;data=new Float32Array(192);dataBuffer=null;texture=null;sampler=null;cubePipeline=null;cubeOutlinePipeline=null;textureBindGroup=null;dataBindGroup=null;constructor(e){super(),this.device=e}init(){const e=s.bl.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nlayout(std140) uniform Data {\n  mat4 mvp;\n  vec4 outline;\n};\nlayout (location=0) in vec3 position;\nlayout (location=1) in vec2 uv;\nout vec2 vUv;\nvoid main(void) {\n  vUv = uv;\n  gl_Position = mvp * vec4(position, 1.0);\n}\n",usage:r.$X.Vertex}),t=s.bl.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nin vec2 vUv;\nout vec4 outColor;\nuniform sampler2D tex;\nvoid main () {\n  outColor = texture(tex, vUv);\n}\n",usage:r.$X.Fragment}),i=s.bl.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nlayout(std140) uniform Data {\n  mat4 mvp;\n  vec4 outline;\n};\nout vec4 outColor;\nvoid main () {\n  outColor = outline;\n}\n",usage:r.$X.Fragment});this.vertBuffer=(0,s.gS)(this.device,q),this.indexBuffer=(0,s.gS)(this.device,N,r.FB.Index),this.dataBuffer=(0,s.gS)(this.device,this.data,r.FB.Uniform|r.FB.Stream),this.texture=s.bl.createTexture(this.device,{size:[H,H,1]});const a=(0,s.Kz)("airplane");a&&s.bl.copyExternalImageToTexture(this.device,{src:a},{texture:this.texture}),this.sampler=s.bl.createSampler(this.device,{});const o=s.bl.createBindGroupLayout(this.device,{entries:[{binding:0,label:"tex",type:r.$l.Texture},{binding:1,label:"tex",type:r.$l.Sampler}]}),l=s.bl.createBindGroupLayout(this.device,{entries:[{label:"Data",type:r.$l.Buffer,bufferDynamicOffset:!0}]});this.textureBindGroup=s.bl.createBindGroup(this.device,{layout:o,entries:[{binding:0,texture:this.texture},{binding:1,sampler:this.sampler}]}),this.dataBindGroup=s.bl.createBindGroup(this.device,{layout:l,entries:[{buffer:this.dataBuffer,bufferSize:256}]});const c={vertex:e,fragment:t,buffers:(0,n.O5)([{attributes:[r.gB.F32x3,r.gB.F32x2]}]),bindGroups:[o,l],depthStencil:{depthWrite:!0,depthCompare:r.wb.LessEqual,stencilBack:{compare:r.wb.Always,passOp:r.xS.Replace},stencilFront:{compare:r.wb.Always,passOp:r.xS.Replace}},primitive:{cullMode:r.Wf.Back}};this.cubePipeline=s.bl.createRenderPipeline(this.device,c),this.cubeOutlinePipeline=s.bl.createRenderPipeline(this.device,{vertex:e,fragment:i,buffers:c.buffers,bindGroups:[l],depthStencil:{depthWrite:!0,stencilBack:{compare:r.wb.NotEqual},stencilFront:{compare:r.wb.NotEqual},stencilWriteMask:0},primitive:c.primitive}),this.register([this.vertBuffer,this.indexBuffer,this.dataBuffer,this.texture,this.sampler,this.textureBindGroup,this.dataBindGroup,this.cubePipeline,this.cubeOutlinePipeline,e,t,i,o,l])}render(e){{const t=y(P(this.width/this.height,Math.PI/4,.01,100),k([10*Math.cos(e),5*Math.sin(e),10*Math.sin(e)],[0,0,0]));let i=t;p(i,this.data,0,0,16),i=y(t,D([1.1,1.1,1.1])),p(i,this.data,0,64,16),p([.1,.3,.2,1],this.data,0,80,4),i=y(t,D([10,10,10])),p(i,this.data,0,128,16)}return s.bl.writeBuffer(this.device,this.dataBuffer,this.data),s.bl.beginDefaultPass(this.device,{clearDepth:1,clearStencil:0}),s.bl.setRenderPipeline(this.device,this.cubePipeline),s.bl.setIndex(this.device,this.indexBuffer),s.bl.setVertex(this.device,0,this.vertBuffer),s.bl.setBindGroup(this.device,0,this.textureBindGroup),s.bl.setBindGroup(this.device,1,this.dataBindGroup,[0]),s.bl.setStencilRef(this.device,1),s.bl.drawIndexed(this.device,W),s.bl.setBindGroup(this.device,1,this.dataBindGroup,[512]),s.bl.setStencilRef(this.device,0),s.bl.drawIndexed(this.device,W,1,W),s.bl.setRenderPipeline(this.device,this.cubeOutlinePipeline),s.bl.setIndex(this.device,this.indexBuffer),s.bl.setVertex(this.device,0,this.vertBuffer),s.bl.setBindGroup(this.device,0,this.dataBindGroup,[256]),s.bl.setStencilRef(this.device,1),s.bl.drawIndexed(this.device,W),s.bl.submitRenderPass(this.device),!0}}const Y=s.c4,Q=[];for(let e=0;e<s.Xv.uvs.length;++e){const t=s.Xv.uvs[e];Q.push([2*t[0],2*t[1]])}const J=(0,s.LI)({positions:s.Xv.positions,uvs:Q}),Z=(0,s.iy)(s.Xv);class ee{cameraData=new Float32Array(16);constructor(e,t,i,n,a,o){this.device=e,this.vertexBuffer=n,this.indexBuffer=a,this.indexCount=o;const l=s.bl.createBindGroupLayout(e,{entries:[{label:"tex",type:r.$l.Texture,binding:0},{label:"tex",type:r.$l.Sampler,binding:1}]}),c=s.bl.createBindGroupLayout(e,{entries:[{label:"Camera",type:r.$l.Buffer}]});t.bindGroups=[l,c],this.pipeline=s.bl.createRenderPipeline(e,t),this.texture=s.bl.createTexture(e,{dimension:i,size:[Y,Y,1]}),this.sampler=s.bl.createSampler(e,{magFilter:r.X9.Linear,minFilter:r.X9.Linear,mipmapFilter:r.X9.Linear,addressModeU:r.OB.Repeat,addressModeV:r.OB.Repeat,maxAnisotropy:16}),this.cameraBuffer=(0,s.gS)(e,this.cameraData,r.FB.Uniform|r.FB.Stream),this.textureBindGroup=s.bl.createBindGroup(e,{layout:l,entries:[{binding:0,texture:this.texture},{binding:1,sampler:this.sampler}]}),this.cameraBindGroup=s.bl.createBindGroup(e,{layout:c,entries:[{buffer:this.cameraBuffer}]}),l.destroy(),c.destroy()}updateCamera(e){p(e,this.cameraData,0,0,16),s.bl.writeBuffer(this.device,this.cameraBuffer,this.cameraData)}render(e){s.bl.setRenderPipeline(e,this.pipeline),s.bl.setIndex(e,this.indexBuffer),s.bl.setVertex(e,0,this.vertexBuffer),s.bl.setBindGroup(e,0,this.textureBindGroup),s.bl.setBindGroup(e,1,this.cameraBindGroup),s.bl.drawIndexed(e,this.indexCount)}destroy(){this.pipeline.destroy(),this.textureBindGroup.destroy(),this.cameraBindGroup.destroy(),this.texture.destroy(),this.sampler.destroy(),this.cameraBuffer.destroy()}}class te extends s.r{vertBuffer=null;indexBuffer=null;cube=null;skybox=null;constructor(e){super(),this.device=e}init(){const e=(0,s.Kz)("airplane"),t=(0,s.Kz)("sky0"),i=(0,s.Kz)("sky1"),a=(0,s.Kz)("sky2"),o=s.bl.createShader(this.device,{code:"#version 300 es\nlayout(std140) uniform Camera {\n  mat4 mvp;\n};\nlayout (location=0) in vec3 position;\nlayout (location=1) in vec2 uv;\nout vec2 vUv;\nout vec3 vNormal;\nvoid main(void) {\n  vUv = uv;\n  vNormal = normalize(position);\n  gl_Position = mvp * vec4(position, 1.0);\n}\n",usage:r.$X.Vertex}),l=s.bl.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nuniform sampler2D tex;\nin vec2 vUv;\nout vec4 outColor;\nvoid main () {\n  outColor = texture(tex, vUv);\n}\n",usage:r.$X.Fragment}),c=s.bl.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nuniform samplerCube tex;\nin vec3 vNormal;\nout vec4 outColor;\nvoid main () {\n  outColor = texture(tex, normalize(vNormal));\n}\n",usage:r.$X.Fragment});this.vertBuffer=(0,s.gS)(this.device,J),this.indexBuffer=(0,s.gS)(this.device,Z,r.FB.Index);const u={vertex:o,fragment:l,buffers:(0,n.O5)([{attributes:[r.gB.F32x3,r.gB.F32x2]}]),depthStencil:{depthWrite:!0,depthCompare:r.wb.LessEqual},primitive:{cullMode:r.Wf.Back}};this.cube=new ee(this.device,u,r.kd.D2,this.vertBuffer,this.indexBuffer,Z.length),e&&(s.bl.copyExternalImageToTexture(this.device,{src:e},{texture:this.cube.texture}),I.generateMipmap(this.device,this.cube.texture));const d={vertex:o,fragment:c,buffers:u.buffers,depthStencil:u.depthStencil,primitive:{cullMode:r.Wf.Front}};if(this.skybox=new ee(this.device,d,r.kd.CubeMap,this.vertBuffer,this.indexBuffer,Z.length),t&&i&&a){const e=[t,t,i,a,t,t];for(let t=0;t<6;++t)s.bl.copyExternalImageToTexture(this.device,{src:e[t]},{texture:this.skybox.texture,origin:[0,0,t]});I.generateMipmap(this.device,this.skybox.texture)}this.register([this.vertBuffer,this.indexBuffer,o,l,c])}render(e){const t=y(P(this.width/this.height,Math.PI/4,.01,100),k([10*Math.cos(e),5*Math.sin(e),10*Math.sin(e)],[0,0,0]));let i=t;return this.cube.updateCamera(i),i=y(t,D([10,10,10]),t),this.skybox.updateCamera(i),s.bl.beginDefaultPass(this.device,{clearColor:[.1,.2,.3,1],clearDepth:1}),this.cube.render(this.device),this.skybox.render(this.device),s.bl.submitRenderPass(this.device),!0}destroy(){super.destroy(),this.cube.destroy(),this.skybox.destroy()}}class ie{constructor(e,t,i){this.id=e,this.title=t,this.factory=i}}const re=[new ie("basic","Hello World",(e=>new o(e))),new ie("instancing","Buffers & Instancing",(e=>new f(e))),new ie("texture","Texture & Sampler",(e=>new te(e))),new ie("stencil","Depth Stencil",(e=>new K(e))),new ie("postprocess","Post-processing",(e=>new j(e))),new ie("mrt","Multi Render Targets",(e=>new T(e))),new ie("pbr","Physically Based Rendering",(e=>new L(e)))]},479:(e,t,i)=>{i.d(t,{bl:()=>r,db:()=>o,r:()=>a,Xv:()=>h,Go:()=>s,lD:()=>f,c4:()=>l,CJ:()=>d,gS:()=>g,om:()=>b,MA:()=>v,Kz:()=>n,iy:()=>u,LI:()=>c});var r=i(838);function n(e){return document.getElementById(e)}class s{init(){}render(e){return!1}resize(e,t){}destroy(){}}class a extends s{resources=[];width=1;height=1;resize(e,t){this.width=e,this.height=t}destroy(){for(let e=0;e<this.resources.length;++e)this.resources[e].destroy();this.resources.length=0}register(e){for(let t=0;t<e.length;++t)this.resources.push(e[t])}}const o=1337,l=512;function c(e){const t=e.positions,i=e.uvs,r=e.normals,n=e.colors;let s=0,a=0;t&&(a=t.length,s+=3),i&&(s+=2),r&&(s+=3),n&&(s+=4);const o=new Float32Array(s*a);for(let e=0;e<a;++e){let a=0;t&&(o[e*s+a++]=t[e][0],o[e*s+a++]=t[e][1],o[e*s+a++]=t[e][2]),i&&(o[e*s+a++]=i[e][0],o[e*s+a++]=i[e][1]),r&&(o[e*s+a++]=r[e][0],o[e*s+a++]=r[e][1],o[e*s+a++]=r[e][2]),n&&(o[e*s+a++]=n[e][0],o[e*s+a++]=n[e][1],o[e*s+a++]=n[e][2],o[e*s+a++]=n[e][3])}return o}function u(e){const t=e.indices;if(!t)return new Uint16Array(0);const i=new Uint16Array(3*t.length);for(let e=0;e<t.length;++e)i[3*e]=t[e][0],i[3*e+1]=t[e][1],i[3*e+2]=t[e][2];return i}const d={positions:[[0,.5,0],[.5,-.5,0],[-.5,-.5,0]],colors:[[1,0,0,1],[0,1,0,1],[0,0,1,1]]},f={positions:[[-1,-1,1],[1,-1,1],[1,1,1],[-1,-1,1],[1,1,1],[-1,1,1]],uvs:[[0,0],[1,0],[1,1],[0,0],[1,1],[0,1]]},h={indices:[[2,1,0],[2,0,3],[6,5,4],[6,4,7],[10,9,8],[10,8,11],[14,13,12],[14,12,15],[18,17,16],[18,16,19],[20,21,22],[23,20,22]],positions:[[-1,1,1],[1,1,1],[1,-1,1],[-1,-1,1],[1,1,-1],[-1,1,-1],[-1,-1,-1],[1,-1,-1],[1,1,1],[1,1,-1],[1,-1,-1],[1,-1,1],[-1,1,-1],[-1,1,1],[-1,-1,1],[-1,-1,-1],[-1,1,-1],[1,1,-1],[1,1,1],[-1,1,1],[-1,-1,-1],[1,-1,-1],[1,-1,1],[-1,-1,1]],uvs:[[0,0],[1,0],[1,1],[0,1],[0,0],[1,0],[1,1],[0,1],[0,0],[1,0],[1,1],[0,1],[0,0],[1,0],[1,1],[0,1],[0,0],[1,0],[1,1],[0,1],[0,0],[1,0],[1,1],[0,1]],normals:[[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,-1],[0,0,-1],[0,0,-1],[0,0,-1],[1,0,0],[1,0,0],[1,0,0],[1,0,0],[-1,0,0],[-1,0,0],[-1,0,0],[-1,0,0],[0,1,0],[0,1,0],[0,1,0],[0,1,0],[0,-1,0],[0,-1,0],[0,-1,0],[0,-1,0]],colors:[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[0,1,0,1],[0,1,0,1],[0,1,0,1],[0,1,0,1],[0,0,1,1],[0,0,1,1],[0,0,1,1],[0,0,1,1],[1,1,0,1],[1,1,0,1],[1,1,0,1],[1,1,0,1],[0,1,1,1],[0,1,1,1],[0,1,1,1],[0,1,1,1],[1,0,1,1],[1,0,1,1],[1,0,1,1],[1,0,1,1]]};var p=i(720);function g(e,t,i=p.FB.Vertex){const n=r.createBuffer(e,{usage:i,size:t.byteLength});return r.writeBuffer(e,n,t),n}function b(e){const t=new Float32Array(e.length);for(let i=0;i<e.length;++i)t[i]=e[i];return t}function v(e){const t=new Uint16Array(e.length);for(let i=0;i<e.length;++i)t[i]=e[i];return t}},721:(e,t,i)=>{i.d(t,{lL:()=>s});var r=i(479);function n(e){const t=new Image;return e.canvas.toBlob((e=>t.src=URL.createObjectURL(e))),t}function s(e=r.c4){const t=document.createElement("div");return t.style.display="none",document.body.appendChild(t),new Promise(((i,r)=>{let s=1;const a=()=>{--s<=0&&i()},o=function(e){const t=new Image;return t.crossOrigin="anonymous",t.src="./airplane.png",t}();o.id="airplane",o.onload=a,o.onerror=r,t.appendChild(o);const l=function(e){const t=document.createElement("canvas");t.width=t.height=e;const i=t.getContext("2d"),r="#28ccdf",s="#39314b",a=i.createLinearGradient(0,0,0,e);a.addColorStop(0,r),a.addColorStop(.4,"#8aebf1"),a.addColorStop(.99,"#dff6f5"),a.addColorStop(1,s),i.fillStyle=r,i.fillRect(0,0,e,e);const o=n(i);i.fillStyle=s,i.fillRect(0,0,e,e);const l=n(i);return i.fillStyle=a,i.fillRect(0,0,e,e),[n(i),o,l]}(e);s+=l.length;for(let e=0;e<l.length;++e)l[e].id=`sky${e}`,l[e].onload=a,l[e].onerror=r,t.appendChild(l[e])}))}},440:(e,t,i)=>{i.a(e,(async(e,t)=>{try{var r=i(838),n=i(354),s=i(479),a=i(299),o=i(721),l=i(869),c=e([l]);l=(c.then?(await c)():c)[0];class f extends s.Go{constructor(e){super(),this.uri=e}render(){return window.location.replace(this.uri),!1}}let h=!1;const p=await(0,l.Y)();class g extends s.Go{wasmModule=null;constructor(e){super(),this.id=e}init(){p.init(this.id)}render(e){return p.render(e)}resize(e,t){p.resize(e,t)}destroy(){p.destroy()}}function u(e,t,i){return t=>h?new g(e):i(t)}const b={};for(let F=0;F<a.B.length;++F)b[a.B[F].id]=new a.p(a.B[F].id,a.B[F].title,u(F,a.B[F].id,a.B[F].factory));b.gltf=new a.p("gltf","glTF Model Viewer ðŸ”—",(()=>new f("../gltf-viewer"))),b.docs=new a.p("docs","API Documentation ðŸ”—",(()=>new f("../docs")));const v=document.getElementById("menu");for(const D in b){const P=document.createElement("li"),k=document.createElement("a");k.id=b[D].id,k.href=`#${b[D].id}`,k.innerText=b[D].title,P.appendChild(k),v.appendChild(P)}const m=document.querySelector("canvas"),x=window.devicePixelRatio||1;if(x>1){const{width:M,height:R}=m;m.width=M*x,m.height=R*x,m.style.width=`${M}px`,m.style.height=`${R}px`}const B=r.requestWebGL2Device(m,{stencil:!0,powerPreference:"low-power"},n.N.TextureAnisotropic|n.N.TextureHalfFloatLinear|n.N.TextureFloatLinear|n.N.ColorBufferFloat);let y,S=0;function d(e=0){S=requestAnimationFrame(d),y.render(e/1e3)||cancelAnimationFrame(S)}window.loadExample=function(e=location.hash){const t=b[e.replace("#","")];t&&(document.getElementById("title").innerText=t.title,document.getElementById("code").href=`https://github.com/andykswong/mugl/tree/main/examples/src/apps/${t.id}.ts`,cancelAnimationFrame(S),y&&(y.destroy(),r.resetDevice(B)),y=t.factory(B),y.init(),y.resize(m.width,m.height),d())};const w=(0,o.lL)();location.hash=location.hash||"#basic",document.getElementById("mode")?.addEventListener("click",(e=>{h=e.target.checked,window.loadExample()})),w.then((()=>{window.loadExample()})),t()}catch(C){t(C)}}),1)},497:(e,t,i)=>{i.a(e,(async(e,r)=>{try{i.d(t,{D:()=>o,J:()=>a});var n=i(132),s=e([n]);function a(){}n=(s.then?(await s)():s)[0];const o=Date.now;r()}catch(l){r(l)}}))},869:(e,t,i)=>{i.a(e,(async(e,r)=>{try{i.d(t,{Y:()=>l});var n=i(958),s=i(132),a=i(479),o=e([s]);async function l(){return(0,n.GH)(a.db,s.memory),{init:s.init,render:s.render,resize:s.resize,destroy:s.destroy}}s=(o.then?(await o)():o)[0],r()}catch(c){r(c)}}))},544:(e,t,i)=>{i.d(t,{$Hb:()=>Ze,$X9:()=>Re,$mf:()=>jt,$oc:()=>Jt,$sD:()=>Ee,AAP:()=>st,ABS:()=>Ut,Ae4:()=>J,BIZ:()=>Xt,BjA:()=>S,Brs:()=>pe,Bxn:()=>Te,BzQ:()=>he,C4F:()=>oe,C6Q:()=>ye,CW:()=>X,Cip:()=>bi,DXJ:()=>ue,DuX:()=>A,EP2:()=>fi,EPl:()=>yt,EZf:()=>At,Ec0:()=>ze,Elr:()=>L,Ep7:()=>Ie,Erx:()=>a,F_0:()=>R,FoO:()=>I,GNc:()=>He,GPd:()=>le,HI8:()=>ae,HiH:()=>ut,Hnw:()=>Ne,If2:()=>Zt,J51:()=>ot,J57:()=>be,Jhs:()=>w,JpA:()=>wt,KTj:()=>F,KXm:()=>dt,Khk:()=>St,LGL:()=>ei,LOg:()=>pt,LRx:()=>De,LrX:()=>Kt,M$f:()=>ge,MBW:()=>C,MJi:()=>Wt,MfQ:()=>di,Mgl:()=>li,Mh0:()=>ie,Msg:()=>Mt,NRq:()=>N,Nug:()=>xt,OAz:()=>b,Oxh:()=>Pe,PB6:()=>x,Q0U:()=>D,QPP:()=>c,Qjo:()=>Rt,QoO:()=>Q,R8:()=>Vt,RFu:()=>te,RG:()=>$t,Rb8:()=>y,RcM:()=>ve,Rkd:()=>Ft,SE0:()=>Gt,Sr6:()=>Ke,TMl:()=>v,TU:()=>We,T_I:()=>j,Tr1:()=>at,U02:()=>Qe,U0z:()=>je,Ukp:()=>o,VGh:()=>Be,VKS:()=>_e,VS8:()=>ne,Vwh:()=>It,WsI:()=>qt,Xeo:()=>Me,XjA:()=>pi,YMo:()=>se,Z$E:()=>qe,ZLz:()=>ri,_Hr:()=>s,_fi:()=>Ae,_hT:()=>Bt,_j0:()=>Ve,aRZ:()=>Ue,b0H:()=>u,bBe:()=>Z,bW:()=>$e,blh:()=>rt,brc:()=>h,cJA:()=>bt,cMJ:()=>gi,cXR:()=>M,cgb:()=>l,coM:()=>ti,d8P:()=>q,d93:()=>K,d_Y:()=>ht,dj5:()=>Tt,eXq:()=>re,ecp:()=>n,fRZ:()=>$,fa2:()=>lt,fjQ:()=>Oe,fqf:()=>mt,gUF:()=>ce,gYZ:()=>O,gq9:()=>W,gtH:()=>kt,h2H:()=>zt,hMC:()=>tt,hw6:()=>it,hy5:()=>g,i$_:()=>p,iFn:()=>de,iHR:()=>V,iRB:()=>hi,iVF:()=>Qt,iXE:()=>Et,i_:()=>ui,jX6:()=>Se,jgr:()=>me,jnw:()=>vt,jpO:()=>H,k2X:()=>ft,k5F:()=>Je,kdr:()=>G,kpY:()=>T,kv5:()=>Xe,ldG:()=>P,m89:()=>si,mLJ:()=>_t,mYe:()=>Le,miX:()=>B,mku:()=>nt,n4e:()=>Ce,nR4:()=>ni,nT3:()=>U,nbD:()=>Ge,njp:()=>m,nl2:()=>xe,pge:()=>ct,q0S:()=>ke,q6i:()=>Ht,qB9:()=>ii,qOY:()=>k,qed:()=>Nt,r$7:()=>et,r1O:()=>ee,r5A:()=>Pt,rxK:()=>Dt,ryP:()=>f,sVf:()=>ai,s_k:()=>Ot,t$R:()=>we,u$q:()=>Ye,u99:()=>ci,uvM:()=>_,vPF:()=>Ct,vkJ:()=>fe,w0M:()=>gt,wAm:()=>oi,wFH:()=>Fe,wdg:()=>z,wgU:()=>Y,xEJ:()=>d,xWx:()=>Lt,xiM:()=>Yt,yN1:()=>E,yXb:()=>r});const r=256,n=1024,s=16384,a=0,o=1,l=3,c=4,u=5,d=0,f=1,h=768,p=769,g=770,b=771,v=772,m=773,x=774,B=775,y=776,S=32774,w=32778,F=32779,D=32769,P=32770,k=34962,M=34963,R=35040,C=35044,G=35048,T=1028,I=1029,A=2884,_=3042,U=2960,L=2929,E=3089,O=32823,$=32926,X=2304,V=2305,j=3317,q=3333,z=4352,W=4353,N=4354,H=33170,K=5120,Y=5121,Q=5122,J=5123,Z=5124,ee=5125,te=5126,ie=6402,re=6407,ne=6408,se=35632,ae=35633,oe=512,le=513,ce=514,ue=515,de=516,fe=517,he=518,pe=519,ge=7680,be=7681,ve=7682,me=7683,xe=5386,Be=34055,ye=34056,Se=9728,we=9729,Fe=9984,De=9985,Pe=9986,ke=9987,Me=10240,Re=10241,Ce=10242,Ge=10243,Te=3553,Ie=34067,Ae=34069,_e=33984,Ue=10497,Le=33071,Ee=33648,Oe=36160,$e=36161,Xe=33189,Ve=36168,je=34041,qe=36064,ze=36096,We=33306,Ne=0,He=3314,Ke=3315,Ye=3316,Qe=3330,Je=3331,Ze=3332,et=6144,tt=6403,it=32856,rt=32857,nt=32877,st=32878,at=32879,ot=32882,lt=33640,ct=33082,ut=33083,dt=32775,ft=32776,ht=33190,pt=34892,gt=34893,bt=35051,vt=35907,mt=34894,xt=34836,Bt=34842,yt=35866,St=35898,wt=35899,Ft=36208,Dt=36214,Pt=36220,kt=36226,Mt=36232,Rt=36238,Ct=36244,Gt=36249,Tt=36012,It=36013,At=36269,_t=34042,Ut=35056,Lt=36008,Et=36009,Ot=5131,$t=33319,Xt=33320,Vt=33321,jt=33323,qt=33325,zt=33326,Wt=33327,Nt=33328,Ht=33329,Kt=33330,Yt=33331,Qt=33332,Jt=33333,Zt=33334,ei=33335,ti=33336,ii=33337,ri=33338,ni=33339,si=33340,ai=36756,oi=36757,li=36759,ci=36662,ui=36663,di=35345,fi=4294967295,hi=37147,pi=37149,gi=34046,bi=34047},847:(e,t,i)=>{i.d(t,{EC:()=>f,IO:()=>h,Ij:()=>a,O5:()=>d,S5:()=>c,Vg:()=>g,Xm:()=>l,bA:()=>u,cX:()=>b,cj:()=>s,jk:()=>p,xN:()=>v});var r=i(544),n=i(720);function s(e){return e===r.Tr1||e===r.EPl}function a(e){return e===r.Ae4?2:4}function o(e){return(e>>4&15)*l(e)}function l(e){return 15&e}function c(e){switch(e>>4&511){case 36:return r.RFu;case 34:return r.s_k;case 274:return r.QoO;case 273:return r.d93;case 18:return r.Ae4;case 17:return r.wgU}return r.Hnw}function u(e){return!!(e>>13)}function d(e){let t=0;const i=[];for(let r=0;r<e.length;++r){const s=[];let a=0;for(let i=0;i<e[r].attributes.length;++i){const n=e[r].attributes[i];s.push({format:n,offset:a,shaderLocation:t}),a+=o(n),++t}i.push({attributes:s,stride:a,stepMode:e[r].instanced?n.Kz.Instance:n.Kz.Vertex})}return i}function f(e){switch(e){case r.kv5:case r.d_Y:case r.ABS:case r.dj5:case r.Vwh:return!0}return!1}function h(e){switch(e){case r._j0:case r.ABS:case r.Vwh:return!0}return!1}function p(e){switch(e){case r.R8:case r.sVf:case r.WsI:case r.h2H:return r.hMC;case r.LrX:case r.q6i:case r.iVF:case r.xiM:case r.If2:case r.$oc:return r.vPF;case r.$mf:case r.wAm:case r.MJi:case r.qed:return r.RG;case r.coM:case r.LGL:case r.ZLz:case r.qB9:case r.m89:case r.nR4:return r.BIZ;case r.hw6:case r.jnw:case r.Mgl:case r.blh:case r._hT:case r.Nug:return r.VS8;case r.r5A:case r.Qjo:case r.rxK:case r.Rkd:case r.Msg:case r.gtH:return r.SE0;case r.Khk:return r.eXq;case r.kv5:case r.d_Y:case r.dj5:return r.Mh0;case r.ABS:case r.Vwh:return r.U0z}return r.Hnw}function g(e){switch(e){case r.R8:case r.LrX:case r.sVf:case r.q6i:return 1;case r.iVF:case r.xiM:case r.$mf:case r.coM:case r.wAm:case r.LGL:case r.WsI:return 2;case r.If2:case r.$oc:case r.h2H:case r.ZLz:case r.qB9:case r.MJi:case r.hw6:case r.jnw:case r.r5A:case r.Mgl:case r.Qjo:case r.blh:case r.Khk:return 4;case r.m89:case r.nR4:case r.qed:case r.rxK:case r.Msg:case r._hT:return 8;case r.Rkd:case r.gtH:case r.Nug:return 16;case r.kv5:return 2;case r.d_Y:case r.ABS:case r.dj5:return 4;case r.Vwh:return 8}return 0}function b(e){switch(e){case r.R8:case r.LrX:case r.$mf:case r.coM:case r.hw6:case r.jnw:case r.r5A:return r.wgU;case r.sVf:case r.q6i:case r.wAm:case r.LGL:case r.Mgl:case r.Qjo:return r.d93;case r.iVF:case r.ZLz:case r.rxK:return r.Ae4;case r.xiM:case r.qB9:case r.Msg:return r.QoO;case r.If2:case r.m89:case r.Rkd:return r.r1O;case r.$oc:case r.nR4:case r.gtH:return r.bBe;case r.blh:return r.fa2;case r.WsI:case r.MJi:case r._hT:return r.s_k;case r.h2H:case r.qed:case r.Nug:return r.RFu;case r.Khk:return r.JpA;case r.kv5:return r.Ae4;case r.d_Y:return r.r1O;case r.ABS:return r.mLJ;case r.dj5:return r.RFu;case r.Vwh:return r.EZf}return r.Hnw}function v(e){switch(e){case r.q6i:case r.xiM:case r.$oc:case r.LGL:case r.qB9:case r.nR4:case r.Qjo:case r.Msg:case r.gtH:return r.bBe;case r.LrX:case r.iVF:case r.If2:case r.coM:case r.ZLz:case r.m89:case r.r5A:case r.rxK:case r.Rkd:return r.r1O}return r.RFu}},354:(e,t,i)=>{i.d(t,{N:()=>r,T:()=>n});const r={TextureAnisotropic:1,TextureHalfFloatLinear:2,TextureFloatLinear:4,ColorBufferFloat:8},n={1:"EXT_texture_filter_anisotropic",2:"OES_texture_half_float_linear",4:"OES_texture_float_linear",8:"EXT_color_buffer_float"}},838:(e,t,i)=>{i.r(t),i.d(t,{beginDefaultPass:()=>G,beginRenderPass:()=>C,copyBuffer:()=>F,copyExternalImageToTexture:()=>k,copyTexture:()=>M,copyTextureToBuffer:()=>R,createBindGroup:()=>B,createBindGroupLayout:()=>x,createBuffer:()=>p,createRenderPass:()=>m,createRenderPipeline:()=>y,createSampler:()=>b,createShader:()=>v,createTexture:()=>g,draw:()=>L,drawIndexed:()=>E,generateMipmap:()=>D,getDeviceFeatures:()=>h,isDeviceLost:()=>f,readBuffer:()=>S,requestWebGL2Device:()=>u,resetDevice:()=>d,setBindGroup:()=>U,setBlendConst:()=>X,setIndex:()=>A,setRenderPipeline:()=>I,setScissorRect:()=>$,setStencilRef:()=>V,setVertex:()=>_,setViewport:()=>O,submitRenderPass:()=>T,writeBuffer:()=>w,writeTexture:()=>P});var r=i(544),n=i(720),s=i(354),a=i(847);const o=255,l=4294967295;let c=null;function u(e,t={},i=0){const r=e.getContext("webgl2",t);if(r){let t=0;for(const e in s.T)i&+e&&r.getExtension(s.T[+e])&&(t|=+e);const n=j(r),a=e=>{e.deleteFramebuffer(n.copyFrameBuffer)},o={canvas:e,gl:r,state:n,features:t,pass:null,destroy(){a(this.gl)}};return c.register(o,{finalizer:a,gl:r}),o}return null}function d(e){e.destroy(),Object.assign(e.state,j(e.gl))}function f(e){return e.gl.isContextLost()}function h(e){return e.features}function p(e,t){const i=t.usage&n.FB.Uniform?r.MfQ:t.usage&n.FB.Index?r.cXR:r.qOY,s=t.usage&n.FB.Stream?r.F_0:t.usage&n.FB.Dynamic?r.kdr:r.MBW,a=e.gl.createBuffer();e.gl.bindBuffer(i,a),e.gl.bufferData(i,t.size,s);const o=e=>{e.deleteBuffer(a)},l={gl:e.gl,glb:a,type:i,size:t.size,destroy(){o(this.gl)}};return c.register(l,{finalizer:o,gl:e.gl}),l}function g(e,t){const i=t.sampleCount||1,s=t.dimension||r.Bxn,o=t.format||r.hw6,l=!(0,a.EC)(o)||(t.usage||0)&n.v2.TextureBinding,[u,d,f]=t.size||[1,1,1],h=s===r.Ep7?6:s===r.Bxn?1:f;let p=null,g=null;(i>1||!l)&&(g=e.gl.createRenderbuffer(),e.gl.bindRenderbuffer(r.bW,g),i>1?e.gl.renderbufferStorageMultisample(r.bW,i,o,u,d):e.gl.renderbufferStorage(r.bW,o,u,d)),l&&(p=e.gl.createTexture(),e.gl.activeTexture(r.VKS),e.gl.bindTexture(s,p),(0,a.cj)(s)?e.gl.texStorage3D(s,t.mipLevelCount||1,o,u,d,h):e.gl.texStorage2D(s,t.mipLevelCount||1,o,u,d));const b=e=>{e.deleteTexture(p),e.deleteRenderbuffer(g)},v={gl:e.gl,glt:p,glrb:g,type:s,format:o,width:u,height:d,depth:h,samples:i,destroy(){b(this.gl)}};return c.register(v,{finalizer:b,gl:e.gl}),v}function b(e,t={}){const i=e.gl.createSampler();let n=t.minFilter||r.jX6;t.mipmapFilter&&(n=t.mipmapFilter===r.jX6?n===r.jX6?r.wFH:r.LRx:n===r.jX6?r.Oxh:r.q0S),e.gl.samplerParameteri(i,r.$X9,n),e.gl.samplerParameteri(i,r.Xeo,t.magFilter||r.jX6),e.gl.samplerParameteri(i,r.n4e,t.addressModeU||r.mYe),e.gl.samplerParameteri(i,r.nbD,t.addressModeV||r.mYe),e.gl.samplerParameteri(i,r.J51,t.addressModeW||r.mYe),e.gl.samplerParameterf(i,r.HiH,t.lodMaxClamp||32),e.gl.samplerParameterf(i,r.pge,t.lodMinClamp||0),t.compare&&(e.gl.samplerParameterf(i,r.LOg,r.fqf),e.gl.samplerParameterf(i,r.w0M,t.compare)),(t.maxAnisotropy||1)>1&&e.gl.samplerParameterf(i,r.cMJ,Math.min(t.maxAnisotropy||1,e.gl.getParameter(r.Cip)));const s=e=>{e.deleteSampler(i)},a={gls:i,gl:e.gl,destroy(){s(this.gl)}};return c.register(a,{finalizer:s,gl:e.gl}),a}function v(e,t){const i=t.usage===n.$X.Vertex?r.HI8:r.YMo,s=e.gl.createShader(i);e.gl.shaderSource(s,t.code),e.gl.compileShader(s);const a=e=>{e.deleteShader(s)},o={gl:e.gl,gls:s,destroy(){a(this.gl)}};return c.register(o,{finalizer:a,gl:e.gl}),o}function m(e,t={}){let i=null;const n=[],s=t.depthStencil?t.depthStencil.texture:null,o=s&&(0,a.IO)(s.format)||!1;if(t.colors&&t.colors.length){i=e.gl.createFramebuffer(),e.gl.bindFramebuffer(r.fjQ,i);for(let i=0;i<t.colors.length;++i)t.colors[i].view.texture.samples>1?e.gl.framebufferRenderbuffer(r.fjQ,r.Z$E+i,r.bW,t.colors[i].view.texture.glrb):q(e.gl,r.Z$E+i,t.colors[i].view);t.colors.length>1&&e.gl.drawBuffers(t.colors.map(((e,t)=>r.Z$E+t))),s&&(s.glrb?e.gl.framebufferRenderbuffer(r.fjQ,o?r.TU:r.Ec0,r.bW,s.glrb):q(e.gl,o?r.TU:r.Ec0,t.depthStencil));for(let i=0;i<t.colors.length;++i)n.push(t.colors[i].view.texture.samples>1?z(e.gl,r.Z$E,t.colors[i].view):null);n.push(s&&s.samples>1&&s.glt?z(e.gl,o?r.TU:r.Ec0,t.depthStencil):null)}const l=e=>{e.deleteFramebuffer(i);for(const t of n)e.deleteFramebuffer(t)},u={gl:e.gl,glfb:i,glrfb:n,depth:s,color:t.colors?t.colors.map((e=>e.view.texture)):[],clearColors:t.colors?t.colors.map((e=>e.clear)):[],clearColor:t.clearColor,clearDepth:t.clearDepth,clearStencil:t.clearStencil,destroy(){l(this.gl)}};return c.register(u,{finalizer:l,gl:e.gl}),u}function x(e,t){return{entries:t.entries.map(((e,t)=>({binding:t,...e}))),destroy(){}}}function B(e,t){return{entries:t.entries.map(((e,t)=>({binding:t,...e}))),destroy(){}}}function y(e,t){const i=function(e,t,i){const r=e.gl.createProgram();return e.gl.attachShader(r,t),e.gl.attachShader(r,i),e.gl.linkProgram(r),r}(e,t.vertex.gls,t.fragment.gls),s=[],a={};let o=0,l=0;if(t.bindGroups){for(let c=0;c<t.bindGroups.length;++c){const u=t.bindGroups[c].entries;s.push([]);for(let t=0;t<u.length;++t){const d=u[t];let f=null,h=r.EP2;d.type===n.$l.Buffer?(h=e.gl.getUniformBlockIndex(i,d.label),e.gl.uniformBlockBinding(i,h,o++)):d.type===n.$l.Texture&&(f=e.gl.getUniformLocation(i,d.label),a[d.label]=l++),s[c][d.binding]={...d,loc:f,index:h,slot:d.type===n.$l.Buffer?o-1:d.type===n.$l.Texture?l-1:0}}}for(let e=0;e<t.bindGroups.length;++e){const i=t.bindGroups[e].entries;for(let t=0;t<i.length;++t)i[t].type===n.$l.Sampler&&a[i[t].label]&&(s[e][i[t].binding].slot=a[i[t].label])}}const u=e=>{e.deleteProgram(i)},d={gl:e.gl,glp:i,buffers:t.buffers,cache:s,state:N(t),destroy(){u(this.gl)}};return c.register(d,{finalizer:u,gl:e.gl}),d}function S(e,t,i,n=0){const s={status:0};return function(e,t,i,n,s){const a=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);return e.flush(),function(e,t,i,n){return new Promise(((i,n)=>{!function s(){const a=e.clientWaitSync(t,0,0);a==r.XjA?n():a==r.iRB?setTimeout(s,10):i()}()}))}(e,a).finally((()=>e.deleteSync(a))).then((()=>{const r=new Uint8Array(s);return e.bindBuffer(t,i),e.getBufferSubData(t,n,r,0,s),r}))}(e.gl,t.type,t.glb,n,i.byteLength).then((e=>{i.set(e),s.status=1}),(()=>s.status=2)),s}function w(e,t,i,r=0){e.gl.bindBuffer(t.type,t.glb),e.gl.bufferSubData(t.type,r,i)}function F(e,t,i,n=t.size,s=0,a=0){e.gl.bindBuffer(r.u99,t.glb),e.gl.bindBuffer(r.i_,i.glb),e.gl.copyBufferSubData(r.u99,r.i_,s,a,n)}function D(e,t,i=r.wdg){e.gl.activeTexture(r.VKS),e.gl.bindTexture(t.type,t.glt),e.gl.hint(r.jpO,i),e.gl.generateMipmap(t.type)}function P(e,{texture:t,mipLevel:i=0,origin:[n,s,o]=[0,0,0]},l,{offset:c=0,bytesPerRow:u,rowsPerImage:d=0},[f,h,p]=[t.width-n,t.height-s,t.depth-o]){const g=(0,a.jk)(t.format),b=(0,a.cX)(t.format),v=t.type===r.Ep7,m=v?r._fi+o:t.type;e.gl.activeTexture(r.VKS),e.gl.bindTexture(t.type,t.glt);const x=(0,a.Vg)(t.format),B=d||h,y=Math.floor(u/x),S=c-c%u;if(e.gl.pixelStorei(r.AAP,B),e.gl.pixelStorei(r.GNc,y),e.gl.pixelStorei(r.u$q,Math.floor(c%u/x)),e.gl.pixelStorei(r.Sr6,0),e.gl.pixelStorei(r.mku,0),(0,a.cj)(t.type))e.gl.texSubImage3D(m,i,n,s,o,f,h,p,t.format,b,l,S);else if(v)for(let t=o;t<o+p;++t)e.gl.pixelStorei(r.Sr6,t*y*B),e.gl.texSubImage2D(m+t,i,n,s,f,h,g,b,l,S);else e.gl.texSubImage2D(m,i,n,s,f,h,g,b,l,S)}function k(e,{src:t,origin:[i,n]=[0,0]},{texture:s,mipLevel:o=0,origin:[l,c,u]=[0,0,0]},[d,f]=[t.width-i,t.height-n]){const h=(0,a.cX)(s.format),p=s.type===r.Ep7?r._fi+u:s.type;e.gl.activeTexture(r.VKS),e.gl.bindTexture(s.type,s.glt),e.gl.pixelStorei(r.u$q,i),e.gl.pixelStorei(r.Sr6,n),e.gl.pixelStorei(r.mku,0),e.gl.pixelStorei(r.AAP,0),(0,a.cj)(s.type)?e.gl.texSubImage3D(p,o,l,c,u,d,f,1,s.format,h,t):e.gl.texSubImage2D(p,o,l,c,d,f,(0,a.jk)(s.format),h,t)}function M(e,{texture:t,mipLevel:i=0,origin:[n,s,o]=[0,0,0]},{texture:l,mipLevel:c=0,origin:[u,d,f]=[0,0,0]},[h,p,g]=[t.width-n,t.height-s,t.depth-o]){const b=l.type===r.Ep7,v=b?r._fi+f:l.type;if(e.gl.activeTexture(r.VKS),e.gl.bindTexture(l.type,l.glt),e.gl.readBuffer(r.Z$E),e.gl.bindFramebuffer(r.fjQ,e.state.copyFrameBuffer),(0,a.cj)(t.type)||t.type===r.Ep7)for(let m=o;m<o+g;++m)q(e.gl,r.Z$E,{texture:t,mipLevel:i,slice:m}),(0,a.cj)(l.type)?e.gl.copyTexSubImage3D(v+(b?m:0),c,u,d,f,n,s,h,p):e.gl.copyTexSubImage2D(v+(b?m:0),c,u,d,n,s,h,p);else{const o=0;q(e.gl,r.Z$E,{texture:t,mipLevel:i,slice:o}),(0,a.cj)(l.type)?e.gl.copyTexSubImage3D(v+(b?o:0),c,u,d,f,n,s,h,p):e.gl.copyTexSubImage2D(v+(b?o:0),c,u,d,n,s,h,p)}e.gl.bindFramebuffer(r.fjQ,e.pass?e.pass.glfb:null)}function R(e,{texture:t,mipLevel:i=0,origin:[n,s,o]=[0,0,0]},l,{offset:c=0,bytesPerRow:u,rowsPerImage:d=0},[f,h,p]=[t.width-n,t.height-s,t.depth-o]){e.gl.bindBuffer(r.cJA,l),e.gl.readBuffer(r.Z$E),e.gl.bindFramebuffer(r.fjQ,e.state.copyFrameBuffer);const g=(0,a.cX)(t.format),b=(0,a.jk)(t.format),v=(0,a.Vg)(t.format),m=d||h,x=Math.floor(u/v),B=c-c%u;if(e.gl.pixelStorei(r.U02,x),e.gl.pixelStorei(r.$Hb,Math.floor(c%u/v)),e.gl.pixelStorei(r.k5F,0),(0,a.cj)(t.type)||t.type===r.Ep7)for(let a=o;a<o+p;++a)q(e.gl,r.Z$E,{texture:t,mipLevel:i,slice:a}),e.gl.readPixels(n,s,f,h,b,g,B+(a-o)*u*m);else{const a=0;q(e.gl,r.Z$E,{texture:t,mipLevel:i,slice:a}),e.gl.readPixels(n,s,f,h,b,g,B)}e.gl.bindFramebuffer(r.fjQ,e.pass?e.pass.glfb:null)}function C(e,t){let i=e.gl.drawingBufferWidth,s=e.gl.drawingBufferHeight;t.color.length&&(i=t.color[0].width,s=t.color[0].height),e.gl.bindFramebuffer(r.fjQ,t.glfb),e.gl.viewport(0,0,i,s),e.gl.depthRange(0,1),e.state.scissor&&(e.state.scissor=!1,J(e.gl,r.yN1,!1));let l=0;if(isNaN(t.clearDepth)||(l|=r.yXb,e.gl.clearDepth(t.clearDepth),Y(e.gl,e.state.state.depthWrite,!0),e.state.state.depthWrite=!0),isNaN(t.clearStencil)||(l|=r.ecp,e.gl.clearStencil(t.clearStencil),Q(e.gl,e.state.state.stencilWriteMask,o),e.state.state.stencilWriteMask=o),K(e.gl,e.state.state.blendWriteMask,n.Yw.All),e.state.state.blendWriteMask=n.Yw.All,t.color.length){for(let i=0;i<t.color.length;++i)if(t.clearColors[i]){const n=(0,a.xN)(t.color[i].format);n===r.bBe?e.gl.clearBufferiv(r.r$7,i,t.clearColors[i]):n===r.r1O?e.gl.clearBufferuiv(r.r$7,i,t.clearColors[i]):e.gl.clearBufferfv(r.r$7,i,t.clearColors[i])}}else t.clearColor&&(l|=r._Hr,e.gl.clearColor(...t.clearColor));l&&e.gl.clear(l),e.pass=t}function G(e,t={}){e.gl.bindFramebuffer(r.fjQ,null),e.gl.viewport(0,0,e.gl.drawingBufferWidth,e.gl.drawingBufferHeight),e.gl.depthRange(0,1),e.state.scissor&&(e.state.scissor=!1,J(e.gl,r.yN1,!1));let i=0;isNaN(t.clearDepth)||(i|=r.yXb,e.gl.clearDepth(t.clearDepth),Y(e.gl,e.state.state.depthWrite,!0),e.state.state.depthWrite=!0),isNaN(t.clearStencil)||(i|=r.ecp,e.gl.clearStencil(t.clearStencil),Q(e.gl,e.state.state.stencilWriteMask,o),e.state.state.stencilWriteMask=o),t.clearColor&&(i|=r._Hr,e.gl.clearColor(...t.clearColor),K(e.gl,e.state.state.blendWriteMask,n.Yw.All),e.state.state.blendWriteMask=n.Yw.All),i&&e.gl.clear(i),e.pass=null}function T(e){if(e.pass){for(let t=0;t<e.pass.color.length;++t)e.pass.glrfb[t]&&W(e.gl,e.pass.glfb,e.pass.glrfb[t],e.pass.color[t],r._Hr,r.Z$E+t);const t=e.pass.glrfb[e.pass.glrfb.length-1];e.pass.depth&&t&&W(e.gl,e.pass.glfb,t,e.pass.depth,r.yXb|r.ecp)}e.pass=null}function I(e,t){if(e.state.pipeline===t)return;e.state.pipeline&&e.state.pipeline.glp===t.glp||e.gl.useProgram(t.glp),H(e.gl,e.state.state,t.state,e.state.stencilRef),Object.assign(e.state.state,t.state);const i=[];for(const{attributes:t}of e.state.buffers)for(const{ptr:e}of t)i[e[0]]=1;e.state.buffers=Array(t.buffers.length);for(let r=0;r<t.buffers.length;++r){const{attributes:n,stride:s,stepMode:o=0}=t.buffers[r],l=[];e.state.buffers[r]={glb:null,attributes:l,stride:s,step:o,offset:0,instanceOffset:0};for(const{format:e,offset:t,shaderLocation:c}of n)i[c]=(i[c]||0)+2,l.push({buffer:r,ptr:[c,(0,a.Xm)(e),(0,a.S5)(e),(0,a.bA)(e),s,t],step:o})}for(let t=0;t<i.length;++t)2===i[t]?e.gl.enableVertexAttribArray(t):1===i[t]&&e.gl.disableVertexAttribArray(t);e.state.pipeline=t}function A(e,t){t.glb!==e.state.index&&e.gl.bindBuffer(r.cXR,e.state.index=t.glb)}function _(e,t,i,r=0){const n=e.state.buffers[t];!n||n.glb===i.glb&&n.offset===r||(n.glb=i.glb,n.offset=r,n.instanceOffset=0,Z(e.gl,n,r))}function U(e,t,i,n=[]){if(e.state.pipeline)for(let s=0,a=0;s<i.entries.length;++s){const o=i.entries[s],l=e.state.pipeline.cache[t]&&e.state.pipeline.cache[t][o.binding];if(l)if(o.buffer){let t=o.bufferOffset||0;l.bufferDynamicOffset&&(t+=n[a]||0,++a),e.gl.bindBufferRange(r.MfQ,l.slot,o.buffer.glb,t,o.bufferSize||o.buffer.size-t)}else o.texture?(e.gl.activeTexture(r.VKS+l.slot),e.gl.bindTexture(o.texture.type,o.texture.glt),e.gl.uniform1i(l.loc,l.slot)):o.sampler&&e.gl.bindSampler(l.slot,o.sampler.gls)}}function L(e,t,i=1,r=0,n=0){for(const t of e.state.buffers)t.step&&t.instanceOffset!==n&&(t.instanceOffset=n,Z(e.gl,t,n*t.stride));e.gl.drawArraysInstanced(e.state.state.topology,r,t,i)}function E(e,t,i=1,r=0,n=0){for(const t of e.state.buffers)t.step&&t.instanceOffset!==n&&(t.instanceOffset=n,Z(e.gl,t,n*t.stride));e.gl.drawElementsInstanced(e.state.state.topology,t,e.state.state.indexFormat,r*(0,a.Ij)(e.state.state.indexFormat),i)}function O(e,t,i,r,n,s=0,a=1){e.gl.viewport(t,i,r,n),e.gl.depthRange(s,a)}function $(e,t,i,n,s){e.state.scissor||(J(e.gl,r.yN1,!0),e.state.scissor=!0),e.gl.scissor(t,i,n,s)}function X(e,t){e.gl.blendColor(...t)}function V(e,t){if(e.state.stencilRef!==t){const{stencilFrontCompare:i,stencilBackCompare:n,stencilReadMask:s}=e.state.state;e.gl.stencilFuncSeparate(r.kpY,i,t,s),e.gl.stencilFuncSeparate(r.FoO,n,t,s),e.state.stencilRef=t}}function j(e){const t=N();e.blendColor(1,1,1,1),H(e,t,t,0,!0);for(let t=0;t<16;++t)e.disableVertexAttribArray(t);return e.pixelStorei(r.d8P,1),e.pixelStorei(r.T_I,1),{copyFrameBuffer:e.createFramebuffer(),buffers:[],state:t,pipeline:null,index:null,stencilRef:0,scissor:!1}}function q(e,t,{texture:i,slice:n=0,mipLevel:s=0}){if((0,a.cj)(i.type))e.framebufferTextureLayer(r.fjQ,t,i.glt,s,n);else{const a=i.type===r.Ep7?r._fi+n:i.type;e.framebufferTexture2D(r.fjQ,t,a,i.glt,s)}}function z(e,t,i){const n=e.createFramebuffer();return e.bindFramebuffer(r.fjQ,n),q(e,t,i),n}function W(e,t,i,n,s,a=r.Z$E){e.bindFramebuffer(r.xWx,t),e.bindFramebuffer(r.iXE,i),e.readBuffer(a),e.blitFramebuffer(0,0,n.width,n.height,0,0,n.width,n.height,s,r.jX6)}function N(e={}){const t=e.primitive||{},i=e.depthStencil||{},{stencilFront:s={},stencilBack:a={}}=i,{sampleCount:o=1,alphaToCoverage:c=!1}=e.multisample||{},u=e.targets||{};let d=u.writeMask||n.Yw.All,f=u.blendColor||{},h=u.blendColor||{};return u.targets&&u.targets[0]&&(d=u.targets[0].writeMask||d,f=u.targets[0].blendColor||f,h=u.targets[0].blendAlpha||h),{sampleCount:o,alphaToCoverage:c,topology:t.topology||r.QPP,indexFormat:t.indexFormat||r.Ae4,frontFace:t.frontFace||r.iHR,cullMode:t.cullMode||r.Hnw,depth:!!e.depthStencil,depthWrite:i.depthWrite||!1,depthFormat:i.format||r.kv5,depthCompare:i.depthCompare||r.Brs,depthBias:i.depthBias||0,depthBiasSlopeScale:i.depthBiasSlopeScale||0,stencil:!(!i.stencilFront&&!i.stencilBack),stencilFrontCompare:s.compare||r.Brs,stencilFrontFailOp:s.failOp||r.M$f,stencilFrontDepthFailOp:s.depthFailOp||r.M$f,stencilFrontPassOp:s.passOp||r.M$f,stencilBackCompare:a.compare||r.Brs,stencilBackFailOp:a.failOp||r.M$f,stencilBackDepthFailOp:a.depthFailOp||r.M$f,stencilBackPassOp:a.passOp||r.M$f,stencilReadMask:i.stencilReadMask||l,stencilWriteMask:i.stencilWriteMask||l,blend:!!e.targets,blendWriteMask:d,blendColorOp:f.operation||r.BjA,blendColorSrcFactor:f.srcFactor||r.ryP,blendColorDstFactor:f.dstFactor||r.xEJ,blendAlphaOp:h.operation||r.BjA,blendAlphaSrcFactor:h.srcFactor||r.ryP,blendAlphaDstFactor:h.dstFactor||r.xEJ}}function H(e,t,i,n=0,s=!1){let a=!1,o=0,l=0,c=0,u=0;o=i.frontFace,(s||t.frontFace!==o)&&e.frontFace(o),o=i.cullMode,(s||t.cullMode!==o)&&((a=o!==r.Hnw)&&e.cullFace(o),J(e,r.DuX,a)),a=i.alphaToCoverage,(s||t.alphaToCoverage!==a)&&J(e,r.fRZ,a),a=!!i.depth,(s||t.depth!==a)&&J(e,r.Elr,a),(s||a)&&(Y(e,t.depthWrite,i.depthWrite,s),o=i.depthCompare,(s||t.depthCompare!==o)&&e.depthFunc(o)),o=i.depthBiasSlopeScale,l=i.depthBias,(s||t.depthBiasSlopeScale!==o||t.depthBias!==l)&&(J(e,r.gYZ,!(!o&&!l)),e.polygonOffset(o,l)),a=!!i.stencil,(s||t.stencil!==a)&&J(e,r.nT3,a),(s||a)&&(o=i.stencilReadMask,a=s||t.stencilReadMask!==o,l=i.stencilFrontCompare,(a||t.stencilFrontCompare!==l)&&e.stencilFuncSeparate(r.kpY,l,n,o),l=i.stencilBackCompare,(a||t.stencilBackCompare!==l)&&e.stencilFuncSeparate(r.FoO,l,n,o),o=i.stencilFrontFailOp,l=i.stencilFrontDepthFailOp,c=i.stencilFrontPassOp,(s||t.stencilFrontFailOp!==o||t.stencilFrontDepthFailOp!==l||t.stencilFrontPassOp!==c)&&e.stencilOpSeparate(r.kpY,o,l,c),o=i.stencilBackFailOp,l=i.stencilBackDepthFailOp,c=i.stencilBackPassOp,(s||t.stencilBackFailOp!==o||t.stencilBackDepthFailOp!==l||t.stencilBackPassOp!==c)&&e.stencilOpSeparate(r.FoO,o,l,c),Q(e,t.stencilWriteMask,i.stencilWriteMask,s)),a=i.blend,(s||t.blend!==a)&&J(e,r.uvM,a),(s||a)&&(o=i.blendColorSrcFactor,l=i.blendColorDstFactor,c=i.blendAlphaSrcFactor,u=i.blendAlphaDstFactor,(s||t.blendColorSrcFactor!==o||t.blendColorDstFactor!==l||t.blendAlphaSrcFactor!==c||t.blendAlphaDstFactor!==u)&&e.blendFuncSeparate(o,l,c,u),o=i.blendColorOp,l=i.blendAlphaOp,(s||t.blendColorOp!==o||t.blendAlphaOp!==l)&&e.blendEquationSeparate(o,l),K(e,t.blendWriteMask,i.blendWriteMask,s))}function K(e,t,i,r=!1){(r||t!==i)&&e.colorMask(!!(i&n.Yw.Red),!!(i&n.Yw.Green),!!(i&n.Yw.Blue),!!(i&n.Yw.Alpha))}function Y(e,t,i,r=!1){(r||t!==i)&&e.depthMask(i)}function Q(e,t,i,r=!1){(r||t!==i)&&e.stencilMask(i)}function J(e,t,i){i?e.enable(t):e.disable(t)}function Z(e,t,i){e.bindBuffer(r.qOY,t.glb);for(let r=0;r<t.attributes.length;++r){const{ptr:n,step:s}=t.attributes[r],a=[...n];a[5]+=i,e.vertexAttribPointer(...a),e.vertexAttribDivisor(n[0],s)}}c=new FinalizationRegistry((({finalizer:e,gl:t})=>{e(t)}))},720:(e,t,i)=>{i.d(t,{$X:()=>f,$l:()=>v,EV:()=>l,FB:()=>n,Kz:()=>g,OB:()=>c,Wf:()=>h,X9:()=>u,Yw:()=>a,dV:()=>m,gB:()=>b,kd:()=>o,oD:()=>x,v2:()=>s,wb:()=>d,xS:()=>p});var r=i(544);const n={Index:16,Vertex:32,Uniform:64,Dynamic:4096,Stream:8192},s={TextureBinding:4,RenderAttachment:16},a={Red:1,Green:2,Blue:4,Alpha:8,All:15},o={D2:r.Bxn,D2Array:r.EPl,CubeMap:r.Ep7,D3:r.Tr1},l={R8:r.R8,R8SNORM:r.sVf,R8UI:r.LrX,R8I:r.q6i,R16UI:r.iVF,R16I:r.xiM,RG8:r.$mf,RG8SNORM:r.wAm,RG8UI:r.coM,RG8I:r.LGL,R32UI:r.If2,R32I:r.$oc,RG16UI:r.ZLz,RG16I:r.qB9,RGBA8:r.hw6,SRGBA8:r.jnw,RGBA8SNORM:r.Mgl,RGBA8UI:r.r5A,RGBA8I:r.Qjo,RGB10A2:r.blh,RG32UI:r.m89,RG32I:r.nR4,RGBA16UI:r.rxK,RGBA16I:r.Msg,RGBA32UI:r.Rkd,RGBA32I:r.gtH,R16F:r.WsI,RG16F:r.MJi,RG11B10F:r.Khk,RGBA16F:r._hT,R32F:r.h2H,RG32F:r.qed,RGBA32F:r.Nug,Depth16:r.kv5,Depth24:r.d_Y,Depth24Stencil8:r.ABS,Depth32F:r.dj5,Depth32FStencil8:r.Vwh},c={ClampToEdge:r.mYe,Repeat:r.aRZ,MirrorRepeat:r.$sD},u={Nearest:r.jX6,Linear:r.t$R},d={Never:r.C4F,Less:r.GPd,Equal:r.gUF,LessEqual:r.DXJ,Greater:r.iFn,NotEqual:r.vkJ,GreaterEqual:r.BzQ,Always:r.Brs},f={Vertex:1,Fragment:2},h=(r.Erx,r.Ukp,r.cgb,r.QPP,r.b0H,r.Ae4,r.r1O,r.iHR,r.CW,{None:r.Hnw,Front:r.kpY,Back:r.FoO}),p={Keep:r.M$f,Zero:r.xEJ,Replace:r.J57,Invert:r.nl2,Increment:r.RcM,Decrement:r.jgr,IncrementWrap:r.VGh,DecrementWrap:r.C6Q},g=(r.xEJ,r.ryP,r.brc,r.i$_,r.hy5,r.OAz,r.PB6,r.miX,r.TMl,r.njp,r.Rb8,r.Q0U,r.ldG,r.BjA,r.Jhs,r.KTj,r.KXm,r.k2X,{Vertex:0,Instance:1}),b={UI8x2:274,UI8x4:276,I8x2:4370,I8x4:4372,UNORM8x2:8466,UNORM8x4:8468,SNORM8x2:12562,SNORM8x4:12564,UI16x2:290,UI16x4:292,I16x2:4386,I16x4:4388,UNORM16x2:8482,UNORM16x4:8484,SNORM16x2:12578,SNORM16x4:12580,F16x2:546,F16x4:548,F32:577,F32x2:578,F32x3:579,F32x4:580},v={Buffer:0,Sampler:1,Texture:2},m={Filtering:0,NonFiltering:1,Comparison:2},x={Float:0,Depth:1,Int:2,UInt:3};r.gq9,r.NRq},958:(e,t,i)=>{i.d(t,{hx:()=>N,PM:()=>W,gK:()=>z,ZM:()=>X,uH:()=>$,AF:()=>U,Ow:()=>j,Me:()=>V,QB:()=>E,wx:()=>O,U3:()=>L,Ko:()=>D,WS:()=>D,EY:()=>D,Fb:()=>_,Dx:()=>M,FL:()=>D,E5:()=>D,hw:()=>D,y9:()=>D,FE:()=>D,ii:()=>Z,ci:()=>ee,Cf:()=>G,uq:()=>k,kS:()=>C,Jj:()=>R,kb:()=>A,IL:()=>J,GH:()=>P,BK:()=>Y,EX:()=>K,eu:()=>te,RS:()=>Q,z0:()=>H,C7:()=>I,CS:()=>T,bo:()=>q});const r=2097151,n=2**32;function s(e,t){return(t&r)*n+(e>>>0)}function a(e){return e>>>0}class o{generations=[];freeList=[];get size(){return this.generations.length-this.freeList.length}clear(){this.generations.length=0,this.freeList.length=0}add(){let e,t;return this.freeList.length>0?(e=this.freeList.pop(),t=Math.abs(this.generations[e]),this.generations[e]=t):(e=this.generations.length,t=e?0:1,this.generations.push(t)),s(e,t)}delete(e){if(!this.has(e))return!1;const t=a(e);let i=this.generations[t]+1&r;return i||++i,this.generations[t]=-i,this.freeList.push(t),!0}forEach(e){for(const t of this.values())e(t,t)}has(e){return a(e)<this.generations.length&&function(e){return e/n&r}(e)===this.generations[a(e)]}keys(){return this.values()}*values(){for(let e=0;e<this.generations.length;++e){const t=this.generations[e];this.generations[e]>=0&&(yield s(e,t))}}*entries(){for(const e of this.values())yield[e,e]}[Symbol.iterator](){return this.values()}}class l{ids=new o;data=[];get size(){return this.ids.size}add(e){const t=this.ids.add();return this.data[a(t)]=e,t}clear(){this.ids.clear(),this.data.length=0}delete(e){return!!this.ids.delete(e)&&(delete this.data[a(e)],!0)}*entries(){for(const e of this.ids.values())yield[e,this.data[a(e)]]}forEach(e){this.ids.forEach((t=>{e(this.data[a(t)],t)}))}get(e){return this.ids.has(e)?this.data[a(e)]:void 0}has(e){return this.ids.has(e)}keys(){return this.ids.values()}set(e,t){return this.ids.has(e)&&(this.data[a(e)]=t),this}*values(){for(const e of this.ids.values())yield this.data[a(e)]}[Symbol.iterator](){return this.entries()}}var c=i(720),u=i(838);const d=new TextDecoder("utf-8");let f=new DataView(new ArrayBuffer(0));function h(e){return f.buffer!==e.buffer&&(f=new DataView(e.buffer)),f}function p(e,t,i){return d.decode(new Uint8Array(e.buffer,t,i))}const g={},b=(new l,new l),v={},m=new l,x={},B={},y=new l,S={};function w(e){return g[e].memory}function F(e){return w(S[e])}function D(e){const t=y.get(e);t&&(t.destroy(),y.delete(e))}function P(e,t){(g[e]=g[e]||{memory:null}).memory=t}function k(e,t,i){const r=p(w(e),t,i);if(v[r])return v[r];const n=document.getElementById(r);return n?v[r]=b.add(n):0}function M(e){b.delete(e)}function R(e){return b.get(e)?.width||0}function C(e){return b.get(e)?.height||0}function G(e,t,i){const r=p(w(e),t,i);if(x[r])return x[r];const n=document.getElementById(r);if(!n)return 0;const s=x[r]=m.add(n);return B[s]=e,s}function T(e,t,i){const r=m.get(e);if(r){const s=u.requestWebGL2Device(r,{alpha:!!(1&(n=t)),antialias:!!(2&n),depth:!!(4&n),desynchronized:!!(8&n),failIfMajorPerformanceCaveat:!!(16&n),powerPreference:32&n?"high-performance":"low-power",premultipliedAlpha:!!(64&n),preserveDrawingBuffer:!!(128&n),stencil:!!(256&n)},i);if(s){const t=y.add(s);return S[t]=B[e],t}}var n;return 0}function I(e,t,i){u.generateMipmap(y.get(e),y.get(t),i)}function A(e){u.resetDevice(y.get(e))}function _(e){D(e),delete S[e]}function U(e,t,i){const r=u.createBuffer(y.get(e),{size:t>>>0,usage:i>>>0});return y.add(r)}function L(e,t,i,r,n,s,a,o,l){const c=u.createTexture(y.get(e),{size:[t>>>0,i>>>0,r>>>0],mipLevelCount:n>>>0,sampleCount:s>>>0,dimension:a>>>0,format:o>>>0,usage:l>>>0});return y.add(c)}function E(e,t,i,r,n,s,a,o,l,c,d){const f=u.createSampler(y.get(e),{addressModeU:t>>>0,addressModeV:i>>>0,addressModeW:r>>>0,magFilter:n>>>0,minFilter:s>>>0,mipmapFilter:a>>>0,lodMinClamp:o,lodMaxClamp:l,compare:c>>>0,maxAnisotropy:d>>>0});return y.add(f)}function O(e,t,i,r){const n=u.createShader(y.get(e),{code:p(F(e),t,i),usage:r>>>0});return y.add(n)}function $(e,t,i){const r=F(e),n=[];for(let e=0;e<i;e++){const i=t+32*e,s=h(r).getUint32(i+0,!0),a=h(r).getUint32(i+4,!0),o=h(r).getUint8(i+16);let l=!1,u=c.dV.Filtering,d=c.oD.Float,f=c.kd.D2,g=!1;switch(o){case c.$l.Buffer:l=!!h(r).getUint8(i+20);break;case c.$l.Sampler:u=h(r).getUint32(i+20,!0)>>>0;break;case c.$l.Texture:d=h(r).getUint32(i+20,!0)>>>0,f=h(r).getUint32(i+24,!0)>>>0,g=!!h(r).getUint8(i+28);break;default:throw new RangeError("invalid variant discriminant for BindingType")}n.push({label:p(r,s,a),binding:h(r).getUint32(i+8,!0)>>>0,visibility:h(r).getUint32(i+12,!0)>>>0,type:o,bufferDynamicOffset:l,samplerType:u,textureSampleType:d,textureDimension:f,textureMultisampled:g})}const s=u.createBindGroupLayout(y.get(e),{entries:n});return y.add(s)}function X(e,t,i,r){const n=F(e),s=[];for(let e=0;e<r;e++){const t=i+24*e;let r=null,a=0,o=0,l=null,u=null;switch(h(n).getUint8(t+4)){case c.$l.Buffer:r=y.get(h(n).getFloat64(t+8,!0)),a=h(n).getUint32(t+16,!0),o=h(n).getUint32(t+20,!0);break;case c.$l.Sampler:l=y.get(h(n).getFloat64(t+8,!0));break;case c.$l.Texture:u=y.get(h(n).getFloat64(t+8,!0));break;default:throw new RangeError("invalid variant discriminant for BindingResource")}s.push({binding:h(n).getUint32(t+0,!0),buffer:r,bufferOffset:a,bufferSize:o,sampler:l,texture:u})}const a=u.createBindGroup(y.get(e),{layout:y.get(t),entries:s});return y.add(a)}function V(e,t,i,r,n,s,a,o,l,c,d,f,p,g,b,v,m,x,B,S,w,D,P,k,M,R,C,G,T,I,A,_,U,L,E,O,$,X,V,j,q){const z=F(e),W=[];for(let e=0;e<n;e++){const t=r+12*e;W.push({format:h(z).getUint32(t+0,!0),offset:h(z).getUint32(t+4,!0),shaderLocation:h(z).getUint32(t+8,!0)})}const N=[];for(let e=0;e<a;e++){const t=s+16*e,i=h(z).getUint32(t+0,!0),r=h(z).getUint32(t+4,!0);N.push({attributes:W.slice(i,i+r),stride:h(z).getUint32(t+8,!0),stepMode:h(z).getUint32(t+12,!0)})}const H=[];for(let e=0;e<l;e++){const t=o+8*e;H.push(y.get(h(z).getFloat64(t+0,!0)))}const K=[];for(let e=0;e<L;e++){const t=U+32*e;K.push({format:h(z).getUint32(t+0,!0)>>>0,writeMask:h(z).getUint32(t+4,!0)>>>0,blendColor:{operation:h(z).getUint32(t+8,!0)>>>0,srcFactor:h(z).getUint32(t+12,!0)>>>0,dstFactor:h(z).getUint32(t+16,!0)>>>0},blendAlpha:{operation:h(z).getUint32(t+20,!0)>>>0,srcFactor:h(z).getUint32(t+24,!0)>>>0,dstFactor:h(z).getUint32(t+28,!0)>>>0}})}const Y=u.createRenderPipeline(y.get(e),{vertex:y.get(t),fragment:y.get(i),buffers:N,bindGroups:H,primitive:{topology:c>>>0,indexFormat:d>>>0,frontFace:f>>>0,cullMode:p>>>0},multisample:{sampleCount:g>>>0,alphaToCoverage:!!b},depthStencil:v?{format:m>>>0,depthWrite:!!x,depthCompare:B>>>0,stencilFront:{compare:S>>>0,failOp:w>>>0,depthFailOp:D>>>0,passOp:P>>>0},stencilBack:{compare:k>>>0,failOp:M>>>0,depthFailOp:R>>>0,passOp:C>>>0},stencilReadMask:G>>>0,stencilWriteMask:T>>>0,depthBias:I,depthBiasSlopeScale:A,depthBiasClamp:_}:null,targets:{writeMask:E>>>0,blendColor:{operation:O>>>0,srcFactor:$>>>0,dstFactor:X>>>0},blendAlpha:{operation:V>>>0,srcFactor:j>>>0,dstFactor:q>>>0},targets:K}});return y.add(Y)}function j(e,t,i,r,n,s,a,o,l,c,d,f,p){const g=F(e);let b;switch(o){case 0:b={clearDepth:t,clearStencil:i,clearColor:isNaN(r)?null:[r,n,s,a]};break;case 1:{const e=[];for(let t=0;t<p;t++){const i=f+32*t,r=[h(g).getFloat32(i+16,!0),h(g).getFloat32(i+20,!0),h(g).getFloat32(i+24,!0),h(g).getFloat32(i+28,!0)];e.push({view:{texture:y.get(h(g).getFloat64(i+0,!0)),mipLevel:h(g).getUint32(i+8,!0),slice:h(g).getUint32(i+12,!0)},clear:isNaN(r[0])?null:r})}b={clearDepth:t,clearStencil:i,colors:e,depthStencil:{texture:y.get(l),mipLevel:c>>>0,slice:d>>>0}};break}default:throw new RangeError("invalid variant discriminant for RenderPassDescriptor")}const v=u.createRenderPass(y.get(e),b);return y.add(v)}function q(e,t,i,r,n){u.writeBuffer(y.get(e),y.get(t),new Uint8Array(F(e).buffer.slice(i,i+1*r)),n>>>0)}function z(e,t,i,r,n,s,a,o,l,c,d){u.copyExternalImageToTexture(y.get(e),{src:b.get(t),origin:[i>>>0,r>>>0]},{texture:y.get(n),mipLevel:s>>>0,origin:[a>>>0,o>>>0,l>>>0]},[c>>>0,d>>>0])}function W(e,t){u.beginRenderPass(y.get(e),y.get(t))}function N(e,t,i,r,n,s,a){u.beginDefaultPass(y.get(e),{clearColor:isNaN(r)?null:[r,n,s,a],clearDepth:t,clearStencil:i})}function H(e){u.submitRenderPass(y.get(e))}function K(e,t){u.setRenderPipeline(y.get(e),y.get(t))}function Y(e,t){u.setIndex(y.get(e),y.get(t))}function Q(e,t,i,r){u.setVertex(y.get(e),t>>>0,y.get(i),r>>>0)}function J(e,t,i,r,n){u.setBindGroup(y.get(e),t>>>0,y.get(i),new Uint32Array(F(e).buffer.slice(r,r+4*n)))}function Z(e,t,i,r,n){u.draw(y.get(e),t>>>0,i>>>0,r>>>0,n>>>0)}function ee(e,t,i,r,n){u.drawIndexed(y.get(e),t>>>0,i>>>0,r>>>0,n>>>0)}function te(e,t){u.setStencilRef(y.get(e),t>>>0)}},811:(e,t,i)=>{i.d(t,{hx:()=>r.hx,PM:()=>r.PM,gK:()=>r.gK,ZM:()=>r.ZM,uH:()=>r.uH,AF:()=>r.AF,Ow:()=>r.Ow,Me:()=>r.Me,QB:()=>r.QB,wx:()=>r.wx,U3:()=>r.U3,Ko:()=>r.Ko,WS:()=>r.WS,EY:()=>r.EY,Fb:()=>r.Fb,Dx:()=>r.Dx,FL:()=>r.FL,E5:()=>r.E5,hw:()=>r.hw,y9:()=>r.y9,FE:()=>r.FE,ii:()=>r.ii,ci:()=>r.ci,Cf:()=>r.Cf,uq:()=>r.uq,kS:()=>r.kS,Jj:()=>r.Jj,kb:()=>r.kb,IL:()=>r.IL,BK:()=>r.BK,EX:()=>r.EX,eu:()=>r.eu,RS:()=>r.RS,z0:()=>r.z0,C7:()=>r.C7,CS:()=>r.CS,bo:()=>r.bo});var r=i(958)},132:(e,t,i)=>{i.a(e,(async(r,n)=>{try{var s=i(497),a=i(811),o=r([s]),[s]=o.then?(await o)():o;await i.v(t,e.id,"0c74bd9ab3c9b14acfc9",{env:{abort:s.J,seed:s.D},"mugl/wasm":{get_canvas_by_id:a.Cf,webgl_request_device:a.CS,reset_device:a.kb,create_shader:a.wx,create_buffer:a.AF,write_buffer:a.bo,create_render_pipeline:a.Me,create_bind_group_layout:a.uH,create_bind_group:a.ZM,create_texture:a.U3,create_sampler:a.QB,create_render_pass:a.Ow,get_image_by_id:a.uq,copy_external_image_to_texture:a.gK,get_image_width:a.Jj,get_image_height:a.kS,webgl_generate_mipmap:a.C7,delete_bind_group_layout:a.WS,begin_default_pass:a.hx,set_render_pipeline:a.EX,set_vertex:a.RS,draw:a.ii,submit_render_pass:a.z0,set_index:a.BK,set_bind_group:a.IL,draw_indexed:a.ci,begin_render_pass:a.PM,set_stencil_ref:a.eu,delete_render_pipeline:a.E5,delete_bind_group:a.Ko,delete_texture:a.FE,delete_sampler:a.hw,delete_buffer:a.EY,delete_device:a.Fb,delete_shader:a.y9,delete_render_pass:a.FL,delete_image:a.Dx}}),n()}catch(e){n(e)}}),1)}},s={};function a(e){var t=s[e];if(void 0!==t)return t.exports;var i=s[e]={id:e,exports:{}};return n[e](i,i.exports,a),i.exports}e="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",t="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",i="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",r=e=>{e&&!e.d&&(e.d=1,e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},a.a=(n,s,a)=>{var o;a&&((o=[]).d=1);var l,c,u,d=new Set,f=n.exports,h=new Promise(((e,t)=>{u=t,c=e}));h[t]=f,h[e]=e=>(o&&e(o),d.forEach(e),h.catch((e=>{}))),n.exports=h,s((n=>{var s;l=(n=>n.map((n=>{if(null!==n&&"object"==typeof n){if(n[e])return n;if(n.then){var s=[];s.d=0,n.then((e=>{a[t]=e,r(s)}),(e=>{a[i]=e,r(s)}));var a={};return a[e]=e=>e(s),a}}var o={};return o[e]=e=>{},o[t]=n,o})))(n);var a=()=>l.map((e=>{if(e[i])throw e[i];return e[t]})),c=new Promise((t=>{(s=()=>t(a)).r=0;var i=e=>e!==o&&!d.has(e)&&(d.add(e),e&&!e.d&&(s.r++,e.push(s)));l.map((t=>t[e](i)))}));return s.r?c:a()}),(e=>(e?u(h[i]=e):c(f),r(o)))),o&&(o.d=0)},a.d=(e,t)=>{for(var i in t)a.o(t,i)&&!a.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.v=(e,t,i,r)=>{var n=fetch(a.p+""+i+".module.wasm");return"function"==typeof WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(n,r).then((t=>Object.assign(e,t.instance.exports))):n.then((e=>e.arrayBuffer())).then((e=>WebAssembly.instantiate(e,r))).then((t=>Object.assign(e,t.instance.exports)))},(()=>{var e;a.g.importScripts&&(e=a.g.location+"");var t=a.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var i=t.getElementsByTagName("script");i.length&&(e=i[i.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=e})(),a(440)})();