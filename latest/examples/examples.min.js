(()=>{var e,t,r,n,i={299:(e,t,r)=>{r.d(t,{p:()=>le,B:()=>ue});var n=r(665),i=r(618);const s=(0,i.LI)(i.CJ);class a extends i.r{buffer=null;pipeline=null;pass=null;constructor(e,t){super(t),this.device=e}init(){let e,t;this.useWebGPU?e=t=this.gpu.createShader(this.device,{code:"\nstruct VertexInput {\n  @location(0) position: vec3<f32>,\n  @location(1) color: vec4<f32>,\n};\n\nstruct VertexOutput {\n  @builtin(position) clip_position: vec4<f32>,\n  @location(0) color: vec4<f32>,\n};\n\n@vertex\nfn vs_main(\n  model: VertexInput,\n) -> VertexOutput {\n  var out: VertexOutput;\n  out.color = model.color;\n  out.clip_position = vec4<f32>(model.position, 1.0);\n  return out;\n}\n\n@fragment\nfn fs_main(in: VertexOutput) -> @location(0) vec4<f32> {\n  return in.color;\n}\n",usage:n.$X.Vertex|n.$X.Fragment}):(e=this.gpu.createShader(this.device,{code:"#version 300 es\nlayout (location=0) in vec3 position;\nlayout (location=1) in vec4 color;\nout vec4 vColor;\nvoid main () {\n  gl_Position = vec4(position, 1);\n  vColor = color;\n}\n",usage:n.$X.Vertex}),t=this.gpu.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nin vec4 vColor;\nout vec4 outColor;\nvoid main () {\n  outColor = vColor;\n}\n",usage:n.$X.Fragment})),this.buffer=(0,i.gS)(this.gpu,this.device,s),this.pipeline=this.gpu.createRenderPipeline(this.device,{vertex:e,fragment:t,buffers:(0,n.O5)([{attributes:[n.gB.F32x3,n.gB.F32x4]}]),depthStencil:{format:n.EV.Depth24Stencil8}}),this.pass=this.gpu.createRenderPass(this.device,{clearColor:[.1,.2,.3,1]}),this.register([this.buffer,this.pipeline,this.pass,e,t])}render(e){return this.gpu.beginRenderPass(this.device,this.pass),this.gpu.setRenderPipeline(this.device,this.pipeline),this.gpu.setVertex(this.device,0,this.buffer),this.gpu.draw(this.device,3),this.gpu.submitRenderPass(this.device),!1}}const o=(0,i.MA)([0,1,2,0]),c=(0,i.om)([0,-.05,-.05,0,.05,.05]),l=new Float32Array(4*Math.ceil(125)),u=new Float32Array(4*Math.ceil(25));for(let e=0;e<100;e++){u[e]=Math.random()*(2*Math.PI),l[5*e]=2*Math.floor(e/10)/10-1+.1,l[5*e+1]=e%10*2/10-1+.1;const t=Math.floor(e/10)/10,r=e%10/10,n=t*r+.2;l[5*e+2]=t,l[5*e+3]=r,l[5*e+4]=n}class d extends i.r{pass=null;pipeline=null;indexBuffer=null;position=null;offsetColor=null;angle=null;bindGroup=null;ambient=null;ambientData=new Float32Array(4);t=0;constructor(e,t){super(t),this.device=e}init(){let e,t;this.useWebGPU?e=t=this.gpu.createShader(this.device,{code:"\nstruct VertexInput {\n  @location(0) position: vec2<f32>,\n  @location(1) offset: vec2<f32>,\n  @location(2) color: vec3<f32>,\n  @location(3) angle: f32,\n};\n\nstruct VertexOutput {\n  @builtin(position) clip_position: vec4<f32>,\n  @location(0) color: vec3<f32>,\n};\n\n@vertex\nfn vs_main(\n  model: VertexInput,\n) -> VertexOutput {\n  var out: VertexOutput;\n  out.color = model.color;\n  out.clip_position = vec4<f32>(\n      cos(model.angle) * model.position[0] + sin(model.angle) * model.position[1] + model.offset[0],\n      -sin(model.angle) * model.position[0] + cos(model.angle) * model.position[1] + model.offset[1],\n      0.0,\n      1.0\n  );\n  return out;\n}\n\nstruct Data {\n  ambient: vec4<f32>,\n};\n@group(0) @binding(0) var<uniform> data: Data;\n\n@fragment\nfn fs_main(in: VertexOutput) -> @location(0) vec4<f32> {\n  return vec4<f32>(data.ambient.rgb + in.color, data.ambient[3]);\n}\n",usage:n.$X.Vertex|n.$X.Fragment}):(e=this.gpu.createShader(this.device,{code:"#version 300 es\nlayout (location=0) in vec2 position;\nlayout (location=1) in vec2 offset;\nlayout (location=2) in vec3 color;\nlayout (location=3) in float angle;\nout vec3 vColor;\nvoid main() {\n  gl_Position = vec4(\n    cos(angle) * position.x + sin(angle) * position.y + offset.x,\n    -sin(angle) * position.x + cos(angle) * position.y + offset.y,\n    0, 1);\n  vColor = color;\n}\n",usage:n.$X.Vertex}),t=this.gpu.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nlayout(std140) uniform Data {\n  vec3 ambient;\n};\nin vec3 vColor;\nout vec4 outColor;\nvoid main () {\n  outColor = vec4(ambient + vColor, 1.0);\n}\n",usage:n.$X.Fragment})),this.indexBuffer=(0,i.gS)(this.gpu,this.device,o,n.FB.Index),this.position=(0,i.gS)(this.gpu,this.device,c),this.offsetColor=(0,i.gS)(this.gpu,this.device,l),this.angle=(0,i.gS)(this.gpu,this.device,u,n.FB.Vertex|n.FB.Stream),this.ambient=(0,i.gS)(this.gpu,this.device,this.ambientData,n.FB.Uniform|n.FB.Stream);const r=this.gpu.createBindGroupLayout(this.device,{entries:[{label:"Data",type:n.$l.Buffer}]});this.bindGroup=this.gpu.createBindGroup(this.device,{layout:r,entries:[{buffer:this.ambient}]}),this.pipeline=this.gpu.createRenderPipeline(this.device,{vertex:e,fragment:t,buffers:(0,n.O5)([{attributes:[n.gB.F32x2]},{attributes:[n.gB.F32x2,n.gB.F32x3],instanced:!0},{attributes:[n.gB.F32],instanced:!0}]),bindGroups:[r],depthStencil:{format:n.EV.Depth24Stencil8}}),this.pass=this.gpu.createRenderPass(this.device,{clearColor:[0,0,0,1]}),this.register([this.bindGroup,this.indexBuffer,this.position,this.offsetColor,this.angle,this.pipeline,this.pass,e,t,r])}render(e){for(let t=0;t<100;t++)u[t]+=this.t-e-2*Math.PI*Math.floor(u[t]/Math.PI/2);this.t=e,this.gpu.writeBuffer(this.device,this.angle,u);const t=Math.sin(e)/2;return this.ambientData[0]=this.ambientData[1]=this.ambientData[2]=t,this.gpu.writeBuffer(this.device,this.ambient,this.ambientData),this.gpu.beginRenderPass(this.device,this.pass),this.gpu.setRenderPipeline(this.device,this.pipeline),this.gpu.setIndex(this.device,this.indexBuffer),this.gpu.setVertex(this.device,0,this.position),this.gpu.setVertex(this.device,1,this.offsetColor),this.gpu.setVertex(this.device,2,this.angle),this.gpu.setBindGroup(this.device,0,this.bindGroup),this.gpu.drawIndexed(this.device,3,100),this.gpu.submitRenderPass(this.device),!0}}const p=new Array(16);function f(e,t,r=0,n=0,i=e.length-r){for(let s=0;s<i;++s)t[n+s]=e[r+s];return t}function h(e=0,t=0,r=0,n=0){return[e,t,r,n]}function g(e=0,t=0,r=0){return[e,t,r]}function m(e,t){return function(e,t){let r=0;for(let n=0;n<e.length;++n)r+=e[n]*t[n];return r}(e,t)}function v(e,t=g()){return function(e,t,r){for(let n=0;n<e.length;++n)r[n]=e[n]*t;return r}(e,1/(function(e){return Math.sqrt(m(e,e))}(e)||1),t)}function x(e,t,r=g()){const n=e[2]*t[0]-t[2]*e[0],i=e[0]*t[1]-t[0]*e[1];return r[0]=e[1]*t[2]-t[1]*e[2],r[1]=n,r[2]=i,r}function b(e){for(let t=0;t<16;++t)e[t]=t%5?0:1;return e}function B(e,t,r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]){return function(e,t,r,n){const i=t.length/4,s=r.length/4;let a=0;p.length=i*s;for(let e=0;e<s;++e)for(let n=0;n<i;++n){a=0;for(let s=0;s<4;++s)a+=t[s*i+n]*r[4*e+s];p[e*i+n]=a}return f(p,n,0,0,p.length),n}(0,e,t,r)}g(),h(),h();const y=g(),S=g(),w=g();function F(e,t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]){return b(t),t[0]=e[0],t[5]=e[1],t[10]=e[2],t}function P(e,t,r,n=1/0,i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]){const s=1/Math.tan(t/2);if(b(i),i[0]=s/e,i[5]=s,i[11]=-1,i[15]=0,isFinite(n)){const e=1/(r-n);i[10]=(r+n)*e,i[14]=2*r*n*e}else i[10]=-1,i[14]=-2*r;return i}function D(e,t=g(),r=g(0,1,0),n=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]){const i=function(e,t,r=g()){return function(e,t,r){for(let n=0;n<e.length;++n)r[n]=e[n]-t[n];return r}(e,t,r)}(t,e,y);v(i,i);const s=x(i,r,S);v(s,s);const a=x(s,i,w);return v(a,a),n[0]=s[0],n[1]=a[0],n[2]=-i[0],n[4]=s[1],n[5]=a[1],n[6]=-i[1],n[8]=s[2],n[9]=a[2],n[10]=-i[2],n[12]=-m(s,e),n[13]=-m(a,e),n[14]=m(i,e),n[3]=n[7]=n[11]=0,n[15]=1,n}const R=512,M=(0,i.LI)({positions:i.Xv.positions,uvs:i.Xv.uvs}),T=(0,i.iy)(i.Xv),G=(0,i.LI)(i.lD);class C extends i.r{pass=null;offscreenPass=null;vertBuffer=null;indexBuffer=null;quadVertBuffer=null;cubeDataBuffer=null;cubePipeline=null;quadPipeline=null;colorTex=null;uvTex=null;positionTex=null;depthTex=null;offscreenTexSampler=null;offscreenTexBindGroup=null;cubeBindGroup=null;cubeData=new Float32Array(40);constructor(e){super(),this.device=e}init(){const e=n.XY.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nlayout(std140) uniform Data {\n  mat4 model, vp;\n  vec3 color;\n};\nlayout(location = 0) in vec3 position;\nlayout(location = 1) in vec2 uv;\nout vec3 vPosition;\nout vec2 vUv;\nvoid main(void) {\n  vec4 worldPos = model * vec4(position, 1.0);\n  vPosition = worldPos.xyz;\n  vUv = uv;\n  gl_Position = vp * worldPos;\n}",usage:n.$X.Vertex}),t=n.XY.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nlayout(std140) uniform Data {\n  mat4 model;\n  mat4 vp;\n  vec3 color;\n};\nin vec3 vPosition;\nin vec2 vUv;\nlayout(location = 0) out vec4 out0;\nlayout(location = 1) out vec4 out1;\nlayout(location = 2) out vec4 out2;\nvoid main(void) {\n  out0 = vec4(color, 1.0);\n  out1 = vec4(vUv, 0.0, 0.0);\n  out2 = vec4(vPosition, 0.0);\n}",usage:n.$X.Fragment}),r=n.XY.createShader(this.device,{code:"#version 300 es\nlayout (location=0) in vec3 position;\nlayout (location=1) in vec2 uv;\nout vec2 vUv;\nvoid main(void) {\n  gl_Position = vec4(position, 1.0);\n  vUv = uv;\n}\n",usage:n.$X.Vertex}),s=n.XY.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nuniform sampler2D tex0, tex1, tex2;\nin vec2 vUv;\nout vec4 outColor;\nvoid main(void) {\n  vec4 colorSum =\n    texture(tex0, vUv * 2.0 - vec2(0.0, 1.0)) * step(0.5, 1.0 - vUv.x) * step(0.5, vUv.y) +\n    texture(tex1, vUv * 2.0 - vec2(0.0, 0.0)) * step(0.5, 1.0 - vUv.x) * step(0.5, 1.0 - vUv.y) +\n    texture(tex2, vUv * 2.0 - vec2(1.0, 1.0)) * step(0.5, vUv.x) * step(0.5, vUv.y);\n    outColor = vec4(colorSum.rgb, 1.0);\n}\n",usage:n.$X.Fragment}),a=n.XY.createBindGroupLayout(this.device,{entries:[{label:"Data",type:n.$l.Buffer}]});this.vertBuffer=(0,i.gS)(this.gpu,this.device,M),this.indexBuffer=(0,i.gS)(this.gpu,this.device,T,n.FB.Index),this.cubeDataBuffer=(0,i.gS)(this.gpu,this.device,this.cubeData,n.FB.Uniform|n.FB.Stream),this.cubeBindGroup=n.XY.createBindGroup(this.device,{layout:a,entries:[{buffer:this.cubeDataBuffer}]}),this.cubePipeline=n.XY.createRenderPipeline(this.device,{vertex:e,fragment:t,buffers:(0,n.O5)([{attributes:[n.gB.F32x3,n.gB.F32x2]}]),bindGroups:[a],depthStencil:{depthCompare:n.wb.LessEqual,depthWrite:!0},primitive:{cullMode:n.Wf.Back}});const o=n.XY.createBindGroupLayout(this.device,{entries:[{binding:0,label:"tex0",type:n.$l.Texture},{binding:1,label:"tex0",type:n.$l.Sampler},{binding:2,label:"tex1",type:n.$l.Texture},{binding:3,label:"tex1",type:n.$l.Sampler},{binding:4,label:"tex2",type:n.$l.Texture},{binding:5,label:"tex2",type:n.$l.Sampler}]});this.quadVertBuffer=(0,i.gS)(this.gpu,this.device,G),this.colorTex=n.XY.createTexture(this.device,{size:[R,R,1],sampleCount:4}),this.uvTex=n.XY.createTexture(this.device,{size:[R,R,1],sampleCount:4}),this.positionTex=n.XY.createTexture(this.device,{size:[R,R,1],sampleCount:4}),this.offscreenTexSampler=n.XY.createSampler(this.device,{magFilter:n.X9.Linear,minFilter:n.X9.Linear}),this.offscreenTexBindGroup=n.XY.createBindGroup(this.device,{layout:o,entries:[{binding:0,texture:this.colorTex},{binding:1,sampler:this.offscreenTexSampler},{binding:2,texture:this.uvTex},{binding:3,sampler:this.offscreenTexSampler},{binding:4,texture:this.positionTex},{binding:5,sampler:this.offscreenTexSampler}]}),this.quadPipeline=n.XY.createRenderPipeline(this.device,{vertex:r,fragment:s,bindGroups:[o],buffers:(0,n.O5)([{attributes:[n.gB.F32x3,n.gB.F32x2]}])}),this.depthTex=n.XY.createTexture(this.device,{format:n.EV.Depth16,size:[R,R,1],usage:n.v2.RenderAttachment,sampleCount:4}),this.offscreenPass=n.XY.createRenderPass(this.device,{colors:[{view:{texture:this.colorTex},clear:[.1,.2,.3,1]},{view:{texture:this.uvTex},clear:[.3,.1,.2,1]},{view:{texture:this.positionTex},clear:[.1,.3,.2,1]}],depthStencil:{texture:this.depthTex},clearDepth:1}),this.pass=n.XY.createRenderPass(this.device,{clearColor:[0,0,0,1],clearDepth:1}),this.register([this.pass,this.offscreenPass,this.cubePipeline,this.vertBuffer,this.indexBuffer,this.cubeDataBuffer,this.cubeBindGroup,this.quadPipeline,this.quadVertBuffer,this.offscreenTexBindGroup,this.colorTex,this.uvTex,this.positionTex,this.depthTex,this.offscreenTexSampler,t,e,s,r,a,o])}render(e){{const t=g(.5,.5,.5),r=B(P(this.width/this.height,Math.PI/4,.01,100),D(function(e,t,r=g()){return function(e,t,r){for(let n=0;n<e.length;++n)r[n]=e[n]+t[n];return r}(e,t,r)}([5*Math.cos(e),2.5*Math.sin(e),5*Math.sin(e)],t),t));let i=function(e,t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]){return b(t),f(e,t,0,12,3),t}(t);i=B(i,F([.5,.5,.5]),i),f(i,this.cubeData,0,0,16),f(r,this.cubeData,0,16,16),f([1,1,1],this.cubeData,0,32,3),n.XY.writeBuffer(this.device,this.cubeDataBuffer,this.cubeData)}return n.XY.beginRenderPass(this.device,this.offscreenPass),n.XY.setRenderPipeline(this.device,this.cubePipeline),n.XY.setIndex(this.device,this.indexBuffer),n.XY.setVertex(this.device,0,this.vertBuffer),n.XY.setBindGroup(this.device,0,this.cubeBindGroup),n.XY.drawIndexed(this.device,T.length),n.XY.submitRenderPass(this.device),n.XY.beginRenderPass(this.device,this.pass),n.XY.setRenderPipeline(this.device,this.quadPipeline),n.XY.setVertex(this.device,0,this.quadVertBuffer),n.XY.setBindGroup(this.device,0,this.offscreenTexBindGroup),n.XY.draw(this.device,6),n.XY.submitRenderPass(this.device),!0}}const E=i.c4,O=(0,i.LI)({positions:i.Xv.positions,normals:i.Xv.normals,uvs:i.Xv.uvs}),U=(0,i.iy)(i.Xv);class X extends i.r{pass=null;vertBuffer=null;indexBuffer=null;matBuffer=null;envBuffer=null;cubeDataBuffer=null;skyDataBuffer=null;cubePipeline=null;cubeTex=null;skyPipeline=null;skyTex=null;sampler=null;envBindGroup=null;cubeTexBindGroup=null;cubeDataBindGroup=null;skyTexBindGroup=null;skyDataBindGroup=null;cubeData=new Float32Array(36);skyData=new Float32Array(36);constructor(e){super(),this.device=e}init(){const e=(0,n.gJ)("airplane"),t=(0,n.gJ)("sky0"),r=(0,n.gJ)("sky1"),s=(0,n.gJ)("sky2"),a=n.XY.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nlayout(std140) uniform Data {\n  mat4 model, viewProj;\n  vec4 camPos;\n};\nlayout (location=0) in vec3 position;\nlayout (location=1) in vec2 uv;\nlayout (location=2) in vec3 normal;\nout vec3 vPosition;\nout vec2 vUv;\nout vec3 vNormal;\n\nvoid main(void) {\n  vec4 worldPos = model * vec4(position, 1.0);\n  vPosition = worldPos.xyz / worldPos.w;\n  vNormal = mat3(model) * normalize(normal);\n  vUv = uv;\n  gl_Position = viewProj * worldPos;\n}\n",usage:n.$X.Vertex}),o=n.XY.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nuniform sampler2D tex;\nlayout(std140) uniform Data {\n  mat4 model, viewProj;\n  vec4 camPos;\n};\nlayout(std140) uniform Material {\n  vec4 albedo;\n  vec2 metallicRoughness;\n};\nlayout(std140) uniform Env {\n  vec4 ambient;\n  vec4 lightDir;\n  vec4 lightColor;\n};\n\nin vec3 vPosition;\nin vec2 vUv;\nin vec3 vNormal;\nout vec4 color;\n\nconst float PI = 3.14159265359;\n\nvec3 toSrgb(vec3 color) {\n  return pow(color, vec3(1.0/2.2));\n}\n\nvec4 toLinear(vec4 srgbIn) {\n  return vec4(pow(srgbIn.rgb, vec3(2.2)), srgbIn.a);\n}\n\nvec3 diffuse(vec3 color) {\n  return color / PI;\n}\n\nfloat specularD(float aSqr, float nDotH) {\n  float f = (nDotH * nDotH) * (aSqr - 1.0) + 1.0;\n  return aSqr / (PI * f * f);\n}\n\nvec3 specularF(vec3 r0, vec3 r90, float vDotH) {\n  return r0 + (r90 - r0) * pow(clamp(1.0 - vDotH, 0.0, 1.0), 5.0);\n}\n\nfloat specularG(float aSqr, float nDotL, float nDotV) {\n  float gl = 2.0 * nDotL / (nDotL + sqrt(aSqr + (1.0 - aSqr) * (nDotL * nDotL)));\n  float gv = 2.0 * nDotV / (nDotV + sqrt(aSqr + (1.0 - aSqr) * (nDotV * nDotV)));\n  return gl * gv;\n}\n\nvoid main () {\n  vec3 n = normalize(vNormal);\n  vec3 v = normalize(camPos.xyz - vPosition);\n  vec3 l = normalize(-lightDir.xyz);\n  vec3 h = normalize(l + v);\n\n  float nDotL = clamp(dot(n, l), 0.001, 1.0);\n  float nDotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n  float nDotH = clamp(dot(n, h), 0.0, 1.0);\n  float vDotH = clamp(dot(v, h), 0.0, 1.0);\n\n  vec4 baseColor = toLinear(texture(tex, vUv)) * albedo;\n\n  vec3 f0 = vec3(0.04);\n  vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0) * (1.0 - metallicRoughness.x);\n  vec3 specularColor = mix(f0, baseColor.rgb, metallicRoughness.x);\n\n  float r0 = max(max(specularColor.r, specularColor.g), specularColor.b);\n  float r90 = clamp(r0 * 25.0, 0.0, 1.0);\n  vec3 specularEnvR0 = specularColor.rgb;\n  vec3 specularEnvR90 = vec3(1.0, 1.0, 1.0) * r90;\n\n  float a = clamp(metallicRoughness.y, 0.04, 1.0);\n  a *= a;\n  float aSqr = a * a;\n\n  vec3 color0 = vec3(0.0);\n\n  vec3 F = specularF(specularEnvR0, specularEnvR90, vDotH);\n  float D = specularD(aSqr, nDotH);\n  float G = specularG(aSqr, nDotL, nDotV);\n\n  vec3 diffuse = (1.0 - F) * diffuse(diffuseColor);\n  vec3 specular = F * G * D / (4.0 * nDotL * nDotV);\n\n  color0 += nDotL * lightColor.rgb * lightColor.a * (diffuse + specular);\n  color0 += ambient.rgb * diffuseColor;\n\n  color = vec4(toSrgb(color0), baseColor.a);\n}",usage:n.$X.Fragment}),c=n.XY.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nuniform samplerCube tex;\nin vec3 vPosition;\nout vec4 color;\nvoid main () {\n  color = texture(tex, normalize(vPosition));\n}",usage:n.$X.Fragment});this.matBuffer=(0,i.gS)(this.gpu,this.device,(0,i.om)([1,1,1,1,.5,.5,0,0]),n.FB.Uniform),this.envBuffer=(0,i.gS)(this.gpu,this.device,(0,i.om)([223/255*.75,246/255*.75,245/255*.75,1,1,-2,1,0,252/255,203/255,203/255,5]),n.FB.Uniform),this.vertBuffer=(0,i.gS)(this.gpu,this.device,O),this.indexBuffer=(0,i.gS)(this.gpu,this.device,U,n.FB.Index),this.cubeDataBuffer=(0,i.gS)(this.gpu,this.device,this.cubeData,n.FB.Uniform|n.FB.Stream),this.skyDataBuffer=(0,i.gS)(this.gpu,this.device,this.skyData,n.FB.Uniform|n.FB.Stream);const l=n.XY.createBindGroupLayout(this.device,{entries:[{binding:0,label:"tex",type:n.$l.Texture},{binding:1,label:"tex",type:n.$l.Sampler}]}),u=n.XY.createBindGroupLayout(this.device,{entries:[{binding:0,label:"Material",type:n.$l.Buffer},{binding:1,label:"Env",type:n.$l.Buffer}]}),d=n.XY.createBindGroupLayout(this.device,{entries:[{label:"Data",type:n.$l.Buffer}]});this.cubeTex=n.XY.createTexture(this.device,{size:[E,E,1]}),e&&n.XY.copyExternalImageToTexture(this.device,{src:e},{texture:this.cubeTex}),this.sampler=n.XY.createSampler(this.device,{magFilter:n.X9.Linear,minFilter:n.X9.Linear,mipmapFilter:n.X9.Linear,maxAnisotropy:16}),this.cubeTexBindGroup=n.XY.createBindGroup(this.device,{layout:l,entries:[{binding:0,texture:this.cubeTex},{binding:1,sampler:this.sampler}]}),this.envBindGroup=n.XY.createBindGroup(this.device,{layout:u,entries:[{binding:0,buffer:this.matBuffer},{binding:1,buffer:this.envBuffer}]}),this.cubeDataBindGroup=n.XY.createBindGroup(this.device,{layout:d,entries:[{buffer:this.cubeDataBuffer}]});const p={vertex:a,fragment:o,buffers:(0,n.O5)([{attributes:[n.gB.F32x3,n.gB.F32x2,n.gB.F32x3]}]),bindGroups:[l,u,d],depthStencil:{depthWrite:!0,depthCompare:n.wb.LessEqual},primitive:{cullMode:n.Wf.Back}};if(this.cubePipeline=n.XY.createRenderPipeline(this.device,p),this.skyTex=n.XY.createTexture(this.device,{dimension:n.kd.CubeMap,size:[E,E,1]}),t&&r&&s){const e=[t,t,r,s,t,t];for(let t=0;t<6;++t)n.XY.copyExternalImageToTexture(this.device,{src:e[t]},{texture:this.skyTex,origin:[0,0,t]})}this.skyTexBindGroup=n.XY.createBindGroup(this.device,{layout:l,entries:[{binding:0,texture:this.skyTex},{binding:1,sampler:this.sampler}]}),this.skyDataBindGroup=n.XY.createBindGroup(this.device,{layout:d,entries:[{buffer:this.skyDataBuffer}]}),this.skyPipeline=n.XY.createRenderPipeline(this.device,{vertex:a,fragment:c,buffers:p.buffers,bindGroups:[l,d],depthStencil:p.depthStencil,primitive:{cullMode:n.Wf.Front}}),this.pass=n.XY.createRenderPass(this.device,{clearColor:[0,0,0,1],clearDepth:1}),this.register([this.vertBuffer,this.indexBuffer,this.matBuffer,this.envBuffer,this.cubeDataBuffer,this.skyDataBuffer,this.cubePipeline,this.cubeTex,this.skyPipeline,this.skyTex,this.sampler,this.envBindGroup,this.cubeDataBindGroup,this.cubeTexBindGroup,this.skyDataBindGroup,this.skyTexBindGroup,this.pass,a,o,c,l,u,d])}render(e){{const t=g(10*Math.cos(e),5*Math.sin(e),10*Math.sin(e)),r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],i=B(P(this.width/this.height,Math.PI/4,.01,100),D(t,[0,0,0]));f(r,this.cubeData,0,0,16),f(i,this.cubeData,0,16,16),f(t,this.cubeData,0,32,3),n.XY.writeBuffer(this.device,this.cubeDataBuffer,this.cubeData),f(F([10,10,10]),this.skyData,0,0,16),f(i,this.skyData,0,16,16),f(t,this.skyData,0,32,3),n.XY.writeBuffer(this.device,this.skyDataBuffer,this.skyData)}return n.XY.beginRenderPass(this.device,this.pass),n.XY.setRenderPipeline(this.device,this.cubePipeline),n.XY.setIndex(this.device,this.indexBuffer),n.XY.setVertex(this.device,0,this.vertBuffer),n.XY.setBindGroup(this.device,0,this.cubeTexBindGroup),n.XY.setBindGroup(this.device,1,this.envBindGroup),n.XY.setBindGroup(this.device,2,this.cubeDataBindGroup),n.XY.drawIndexed(this.device,U.length),n.XY.setRenderPipeline(this.device,this.skyPipeline),n.XY.setIndex(this.device,this.indexBuffer),n.XY.setVertex(this.device,0,this.vertBuffer),n.XY.setBindGroup(this.device,0,this.skyTexBindGroup),n.XY.setBindGroup(this.device,1,this.skyDataBindGroup),n.XY.drawIndexed(this.device,U.length),n.XY.submitRenderPass(this.device),!0}}const k=512,I=[[-1,-1,-1,0,-1,8,-1,0,-1,-1,-1,0,0,0,0,0],[-2,-1,0,0,-1,1,1,0,0,1,2,0,0,0,0,0],[0,-1,0,0,-1,4,-1,0,0,-1,0,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0]],A=(0,i.LI)({positions:i.Xv.positions,colors:i.Xv.colors}),_=(0,i.iy)(i.Xv),V=(0,i.LI)(i.lD);class L extends i.r{pass=null;offscreenPass=null;vertBuffer=null;indexBuffer=null;quadVertBuffer=null;cubeDataBuffer=null;kernelDataBuffer=null;cubePipeline=null;quadPipeline=null;offscreenTex=null;offscreenTexSampler=null;depthTex=null;offscreenTexBindGroup=null;cubeBindGroup=null;kernelBindGroup=null;cubeData=new Float32Array(16);kernelData=new Float32Array(20);constructor(e){super(),this.device=e}init(){const e=n.XY.createShader(this.device,{code:"#version 300 es\nlayout(std140) uniform Data {\n  mat4 mvp;\n};\nlayout (location=0) in vec4 position;\nlayout (location=1) in vec4 color;\nout vec4 vColor;\nvoid main(void) {\n  gl_Position = mvp * position;\n  vColor = color;\n}",usage:n.$X.Vertex}),t=n.XY.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nin vec4 vColor;\nout vec4 outColor;\nvoid main(void) {\n  outColor = vColor;\n}",usage:n.$X.Fragment}),r=n.XY.createShader(this.device,{code:"#version 300 es\nlayout (location=0) in vec4 position;\nlayout (location=1) in vec2 uv;\nout vec2 vUv;\nvoid main(void) {\n  gl_Position = position;\n  vUv = uv;\n}",usage:n.$X.Vertex}),s=n.XY.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nuniform sampler2D tex;\nlayout(std140) uniform Data {\n  mat4 kernel;\n  vec2 texSize;\n  float kernelWeight;\n};\nin vec2 vUv;\nout vec4 outColor;\nvoid main(void) {\n  vec2 onePixel = vec2(1.0, 1.0) / texSize;\n  vec4 colorSum =\n    texture(tex, vUv + onePixel * vec2(-1, -1)) * kernel[0][0] +\n    texture(tex, vUv + onePixel * vec2( 0, -1)) * kernel[0][1] +\n    texture(tex, vUv + onePixel * vec2( 1, -1)) * kernel[0][2] +\n    texture(tex, vUv + onePixel * vec2(-1,  0)) * kernel[1][0] +\n    texture(tex, vUv + onePixel * vec2( 0,  0)) * kernel[1][1] +\n    texture(tex, vUv + onePixel * vec2( 1,  0)) * kernel[1][2] +\n    texture(tex, vUv + onePixel * vec2(-1,  1)) * kernel[2][0] +\n    texture(tex, vUv + onePixel * vec2( 0,  1)) * kernel[2][1] +\n    texture(tex, vUv + onePixel * vec2( 1,  1)) * kernel[2][2] ;\n    outColor = vec4((colorSum / kernelWeight).rgb, 1);\n}",usage:n.$X.Fragment}),a=n.XY.createBindGroupLayout(this.device,{entries:[{label:"Data",type:n.$l.Buffer}]});this.vertBuffer=(0,i.gS)(this.gpu,this.device,A),this.indexBuffer=(0,i.gS)(this.gpu,this.device,_,n.FB.Index),this.cubeDataBuffer=(0,i.gS)(this.gpu,this.device,this.cubeData,n.FB.Uniform|n.FB.Stream),this.cubeBindGroup=n.XY.createBindGroup(this.device,{layout:a,entries:[{buffer:this.cubeDataBuffer}]}),this.cubePipeline=n.XY.createRenderPipeline(this.device,{vertex:e,fragment:t,buffers:(0,n.O5)([{attributes:[n.gB.F32x3,n.gB.F32x4]}]),bindGroups:[a],depthStencil:{depthCompare:n.wb.LessEqual,depthWrite:!0},primitive:{cullMode:n.Wf.Back}});const o=n.XY.createBindGroupLayout(this.device,{entries:[{binding:0,label:"tex",type:n.$l.Texture},{binding:1,label:"tex",type:n.$l.Sampler}]});this.quadVertBuffer=(0,i.gS)(this.gpu,this.device,V),this.kernelDataBuffer=(0,i.gS)(this.gpu,this.device,this.kernelData,n.FB.Uniform|n.FB.Stream),this.offscreenTex=n.XY.createTexture(this.device,{size:[k,k,1],sampleCount:1}),this.offscreenTexSampler=n.XY.createSampler(this.device,{magFilter:n.X9.Linear,minFilter:n.X9.Linear}),this.offscreenTexBindGroup=n.XY.createBindGroup(this.device,{layout:o,entries:[{binding:0,texture:this.offscreenTex},{binding:1,sampler:this.offscreenTexSampler}]}),this.kernelBindGroup=n.XY.createBindGroup(this.device,{layout:a,entries:[{buffer:this.kernelDataBuffer}]}),this.quadPipeline=n.XY.createRenderPipeline(this.device,{vertex:r,fragment:s,bindGroups:[o,a],buffers:(0,n.O5)([{attributes:[n.gB.F32x3,n.gB.F32x2]}])}),this.depthTex=n.XY.createTexture(this.device,{format:n.EV.Depth16,size:[k,k,1],usage:n.v2.RenderAttachment,sampleCount:1}),this.offscreenPass=n.XY.createRenderPass(this.device,{colors:[{view:{texture:this.offscreenTex},clear:[.25,.25,.25,1]}],depthStencil:{texture:this.depthTex},clearDepth:1}),this.pass=n.XY.createRenderPass(this.device,{clearColor:[0,0,0,1],clearDepth:1}),this.register([this.cubePipeline,this.vertBuffer,this.indexBuffer,this.cubeDataBuffer,this.kernelDataBuffer,this.quadPipeline,this.quadVertBuffer,this.offscreenTex,this.offscreenTexSampler,this.depthTex,this.pass,this.offscreenPass,this.cubeBindGroup,this.offscreenTexBindGroup,this.kernelBindGroup,t,e,s,r,o,a])}render(e){f(B(P(this.width/this.height,Math.PI/4,.01,100),D([10*Math.cos(e),5*Math.sin(e),10*Math.sin(e)],[0,0,0])),this.cubeData,0,0,16),n.XY.writeBuffer(this.device,this.cubeDataBuffer,this.cubeData);{const t=I[Math.floor(e/2)%I.length];let r=0;for(let e=0;e<t.length;++e)r+=t[e];r=r<=0?1:r,f(t,this.kernelData,0,0,16),this.kernelData[16]=k,this.kernelData[17]=k,this.kernelData[18]=r,n.XY.writeBuffer(this.device,this.kernelDataBuffer,this.kernelData)}return n.XY.beginRenderPass(this.device,this.offscreenPass),n.XY.setRenderPipeline(this.device,this.cubePipeline),n.XY.setIndex(this.device,this.indexBuffer),n.XY.setVertex(this.device,0,this.vertBuffer),n.XY.setBindGroup(this.device,0,this.cubeBindGroup),n.XY.drawIndexed(this.device,_.length),n.XY.submitRenderPass(this.device),n.XY.beginRenderPass(this.device,this.pass),n.XY.setRenderPipeline(this.device,this.quadPipeline),n.XY.setVertex(this.device,0,this.quadVertBuffer),n.XY.setBindGroup(this.device,0,this.offscreenTexBindGroup),n.XY.setBindGroup(this.device,1,this.kernelBindGroup),n.XY.draw(this.device,6),n.XY.submitRenderPass(this.device),!0}}const Y=(0,i.LI)({positions:i.Xv.positions,uvs:i.Xv.uvs}),$=(0,i.iy)(i.Xv),q=$.length,z=new Uint16Array(2*q);for(let e=0;e<q;++e)z[e]=$[e];for(let e=0;e<q;e+=3)z[q+e]=$[e+2],z[q+e+1]=$[e+1],z[q+e+2]=$[e];const W=i.c4,N="\nstruct Data {\n  mvp: mat4x4<f32>,\n  outline: vec4<f32>,\n};\n@group(0) @binding(0) var<uniform> data: Data;\n",j="\nstruct VertexOutput {\n  @builtin(position) clip_position: vec4<f32>,\n  @location(0) uv: vec2<f32>,\n  @location(1) normal: vec3<f32>,\n};\n",H=`\n${N}\n${j}\n\nstruct VertexInput {\n  @location(0) position: vec3<f32>,\n  @location(1) uv: vec2<f32>,\n};\n\n@vertex\nfn vs_main(model: VertexInput) -> VertexOutput {\n  var out: VertexOutput;\n  out.clip_position = data.mvp * vec4<f32>(model.position, 1.0);\n  out.uv = model.uv;\n  out.normal = normalize(model.position);\n  return out;\n}\n`,J=`\n${j}\n\n@group(1) @binding(0) var tex: texture_2d<f32>;\n@group(1) @binding(1) var tex_sampler: sampler;\n\n@fragment\nfn fs_main(in: VertexOutput) -> @location(0) vec4<f32> {\n    return textureSample(tex, tex_sampler, in.uv);\n}\n`,Q=`\n${N}\n${j}\n\n@fragment\nfn fs_main(in: VertexOutput) -> @location(0) vec4<f32> {\n  return data.outline;\n}\n`;class K extends i.r{pass=null;vertBuffer=null;indexBuffer=null;data=new Float32Array(192);dataBuffer=null;texture=null;sampler=null;cubePipeline=null;cubeOutlinePipeline=null;textureBindGroup=null;dataBindGroup=null;constructor(e,t){super(t),this.device=e}init(){const e=this.gpu.createShader(this.device,{code:this.useWebGPU?H:"#version 300 es\nprecision mediump float;\nlayout(std140) uniform Data {\n  mat4 mvp;\n  vec4 outline;\n};\nlayout (location=0) in vec3 position;\nlayout (location=1) in vec2 uv;\nout vec2 vUv;\nvoid main(void) {\n  vUv = uv;\n  gl_Position = mvp * vec4(position, 1.0);\n}\n",usage:n.$X.Vertex}),t=this.gpu.createShader(this.device,{code:this.useWebGPU?J:"#version 300 es\nprecision mediump float;\nin vec2 vUv;\nout vec4 outColor;\nuniform sampler2D tex;\nvoid main () {\n  outColor = texture(tex, vUv);\n}\n",usage:n.$X.Fragment}),r=this.gpu.createShader(this.device,{code:this.useWebGPU?Q:"#version 300 es\nprecision mediump float;\nlayout(std140) uniform Data {\n  mat4 mvp;\n  vec4 outline;\n};\nout vec4 outColor;\nvoid main () {\n  outColor = outline;\n}\n",usage:n.$X.Fragment});this.vertBuffer=(0,i.gS)(this.gpu,this.device,Y),this.indexBuffer=(0,i.gS)(this.gpu,this.device,z,n.FB.Index),this.dataBuffer=(0,i.gS)(this.gpu,this.device,this.data,n.FB.Uniform|n.FB.Stream),this.texture=this.gpu.createTexture(this.device,{size:[W,W,1],usage:n.v2.TextureBinding|n.v2.RenderAttachment});const s=(0,n.gJ)("airplane");s&&this.gpu.copyExternalImageToTexture(this.device,{src:s},{texture:this.texture}),this.sampler=this.gpu.createSampler(this.device,{});const a=this.gpu.createBindGroupLayout(this.device,{entries:[{binding:0,label:"tex",type:n.$l.Texture},{binding:1,label:"tex",type:n.$l.Sampler}]}),o=this.gpu.createBindGroupLayout(this.device,{entries:[{label:"Data",type:n.$l.Buffer,bufferDynamicOffset:!0}]});this.textureBindGroup=this.gpu.createBindGroup(this.device,{layout:a,entries:[{binding:0,texture:this.texture},{binding:1,sampler:this.sampler}]}),this.dataBindGroup=this.gpu.createBindGroup(this.device,{layout:o,entries:[{buffer:this.dataBuffer,bufferSize:256}]});const c={vertex:e,fragment:t,buffers:(0,n.O5)([{attributes:[n.gB.F32x3,n.gB.F32x2]}]),bindGroups:[o,a],depthStencil:{format:n.EV.Depth24Stencil8,depthWrite:!0,depthCompare:n.wb.LessEqual,stencilBack:{compare:n.wb.Always,passOp:n.xS.Replace},stencilFront:{compare:n.wb.Always,passOp:n.xS.Replace}},primitive:{cullMode:n.Wf.Back}};this.cubePipeline=this.gpu.createRenderPipeline(this.device,c),this.cubeOutlinePipeline=this.gpu.createRenderPipeline(this.device,{vertex:e,fragment:r,buffers:c.buffers,bindGroups:[o],depthStencil:{format:n.EV.Depth24Stencil8,depthWrite:!0,stencilBack:{compare:n.wb.NotEqual},stencilFront:{compare:n.wb.NotEqual},stencilWriteMask:0},primitive:c.primitive}),this.pass=this.gpu.createRenderPass(this.device,{clearDepth:1,clearStencil:0}),this.register([this.vertBuffer,this.indexBuffer,this.dataBuffer,this.texture,this.sampler,this.textureBindGroup,this.dataBindGroup,this.cubePipeline,this.cubeOutlinePipeline,this.pass,e,t,r,a,o])}render(e){{const t=B(P(this.width/this.height,Math.PI/4,.01,100),D([10*Math.cos(e),5*Math.sin(e),10*Math.sin(e)],[0,0,0]));let r=t;f(r,this.data,0,0,16),r=B(t,F([1.1,1.1,1.1])),f(r,this.data,0,64,16),f([.1,.3,.2,1],this.data,0,80,4),r=B(t,F([10,10,10])),f(r,this.data,0,128,16)}return this.gpu.writeBuffer(this.device,this.dataBuffer,this.data),this.gpu.beginRenderPass(this.device,this.pass),this.gpu.setRenderPipeline(this.device,this.cubePipeline),this.gpu.setIndex(this.device,this.indexBuffer),this.gpu.setVertex(this.device,0,this.vertBuffer),this.gpu.setBindGroup(this.device,0,this.dataBindGroup,[0]),this.gpu.setBindGroup(this.device,1,this.textureBindGroup),this.gpu.setStencilRef(this.device,1),this.gpu.drawIndexed(this.device,q),this.gpu.setBindGroup(this.device,0,this.dataBindGroup,[512]),this.gpu.setStencilRef(this.device,0),this.gpu.drawIndexed(this.device,q,1,q),this.gpu.setRenderPipeline(this.device,this.cubeOutlinePipeline),this.gpu.setIndex(this.device,this.indexBuffer),this.gpu.setVertex(this.device,0,this.vertBuffer),this.gpu.setBindGroup(this.device,0,this.dataBindGroup,[256]),this.gpu.setStencilRef(this.device,1),this.gpu.drawIndexed(this.device,q),this.gpu.submitRenderPass(this.device),!0}}const Z=i.c4,ee=[];for(let e=0;e<i.Xv.uvs.length;++e){const t=i.Xv.uvs[e];ee.push([2*t[0],2*t[1]])}const te=(0,i.LI)({positions:i.Xv.positions,uvs:ee}),re=(0,i.iy)(i.Xv),ne="\nstruct VertexOutput {\n  @builtin(position) clip_position: vec4<f32>,\n  @location(0) uv: vec2<f32>,\n  @location(1) normal: vec3<f32>,\n};\n",ie=`\n\nstruct Data {\n  mvp: mat4x4<f32>,\n};\n@group(1) @binding(0) var<uniform> data: Data;\n\n${ne}\n\nstruct VertexInput {\n  @location(0) position: vec3<f32>,\n  @location(1) uv: vec2<f32>,\n};\n\n@vertex\nfn vs_main(model: VertexInput) -> VertexOutput {\n  var out: VertexOutput;\n  out.clip_position = data.mvp * vec4<f32>(model.position, 1.0);\n  out.uv = model.uv;\n  out.normal = normalize(model.position);\n  return out;\n}\n`,se=`\n${ne}\n\n@group(0) @binding(0) var tex: texture_2d<f32>;\n@group(0) @binding(1) var tex_sampler: sampler;\n\n@fragment\nfn fs_main(in: VertexOutput) -> @location(0) vec4<f32> {\n    return textureSample(tex, tex_sampler, in.uv);\n}\n`,ae=`\n${ne}\n\n@group(0) @binding(0) var tex: texture_cube<f32>;\n@group(0) @binding(1) var tex_sampler: sampler;\n\n@fragment\nfn fs_main(in: VertexOutput) -> @location(0) vec4<f32> {\n  return textureSample(tex, tex_sampler, normalize(in.normal));\n}\n`;class oe{cameraData=new Float32Array(16);constructor(e,t,r,s,a,o,c){this.gpu=e,this.device=t,this.vertexBuffer=a,this.indexBuffer=o,this.indexCount=c;const l=e.createBindGroupLayout(t,{entries:[{label:"tex",type:n.$l.Texture,textureDimension:s,binding:0},{label:"tex",type:n.$l.Sampler,binding:1}]}),u=e.createBindGroupLayout(t,{entries:[{label:"Camera",type:n.$l.Buffer}]});r.bindGroups=[l,u],this.pipeline=e.createRenderPipeline(t,r),this.texture=e.createTexture(t,{dimension:s,size:[Z,Z,1],usage:n.v2.TextureBinding|n.v2.RenderAttachment}),this.sampler=e.createSampler(t,{magFilter:n.X9.Linear,minFilter:n.X9.Linear,mipmapFilter:n.X9.Linear,addressModeU:n.OB.Repeat,addressModeV:n.OB.Repeat,maxAnisotropy:16}),this.cameraBuffer=(0,i.gS)(e,t,this.cameraData,n.FB.Uniform|n.FB.Stream),this.textureBindGroup=e.createBindGroup(t,{layout:l,entries:[{binding:0,texture:this.texture},{binding:1,sampler:this.sampler}]}),this.cameraBindGroup=e.createBindGroup(t,{layout:u,entries:[{buffer:this.cameraBuffer}]}),l.destroy(),u.destroy()}updateCamera(e){f(e,this.cameraData,0,0,16),this.gpu.writeBuffer(this.device,this.cameraBuffer,this.cameraData)}render(e){this.gpu.setRenderPipeline(e,this.pipeline),this.gpu.setIndex(e,this.indexBuffer),this.gpu.setVertex(e,0,this.vertexBuffer),this.gpu.setBindGroup(e,0,this.textureBindGroup),this.gpu.setBindGroup(e,1,this.cameraBindGroup),this.gpu.drawIndexed(e,this.indexCount)}destroy(){this.pipeline.destroy(),this.textureBindGroup.destroy(),this.cameraBindGroup.destroy(),this.texture.destroy(),this.sampler.destroy(),this.cameraBuffer.destroy()}}class ce extends i.r{pass=null;vertBuffer=null;indexBuffer=null;cube=null;skybox=null;constructor(e,t){super(t),this.device=e}init(){const e=(0,n.gJ)("airplane"),t=(0,n.gJ)("sky0"),r=(0,n.gJ)("sky1"),s=(0,n.gJ)("sky2"),a=this.gpu.createShader(this.device,{code:this.useWebGPU?ie:"#version 300 es\nlayout(std140) uniform Camera {\n  mat4 mvp;\n};\nlayout (location=0) in vec3 position;\nlayout (location=1) in vec2 uv;\nout vec2 vUv;\nout vec3 vNormal;\nvoid main(void) {\n  vUv = uv;\n  vNormal = normalize(position);\n  gl_Position = mvp * vec4(position, 1.0);\n}\n",usage:n.$X.Vertex}),o=this.gpu.createShader(this.device,{code:this.useWebGPU?se:"#version 300 es\nprecision mediump float;\nuniform sampler2D tex;\nin vec2 vUv;\nout vec4 outColor;\nvoid main () {\n  outColor = texture(tex, vUv);\n}\n",usage:n.$X.Fragment}),c=this.gpu.createShader(this.device,{code:this.useWebGPU?ae:"#version 300 es\nprecision mediump float;\nuniform samplerCube tex;\nin vec3 vNormal;\nout vec4 outColor;\nvoid main () {\n  outColor = texture(tex, normalize(vNormal));\n}\n",usage:n.$X.Fragment});this.vertBuffer=(0,i.gS)(this.gpu,this.device,te),this.indexBuffer=(0,i.gS)(this.gpu,this.device,re,n.FB.Index);const l={vertex:a,fragment:o,buffers:(0,n.O5)([{attributes:[n.gB.F32x3,n.gB.F32x2]}]),depthStencil:{format:n.EV.Depth24Stencil8,depthWrite:!0,depthCompare:n.wb.LessEqual},primitive:{cullMode:n.Wf.Back}};this.cube=new oe(this.gpu,this.device,l,n.kd.D2,this.vertBuffer,this.indexBuffer,re.length),e&&this.gpu.copyExternalImageToTexture(this.device,{src:e},{texture:this.cube.texture});const u={vertex:a,fragment:c,buffers:l.buffers,depthStencil:l.depthStencil,primitive:{cullMode:n.Wf.Front}};if(this.skybox=new oe(this.gpu,this.device,u,n.kd.CubeMap,this.vertBuffer,this.indexBuffer,re.length),t&&r&&s){const e=[t,t,r,s,t,t];for(let t=0;t<6;++t)this.gpu.copyExternalImageToTexture(this.device,{src:e[t]},{texture:this.skybox.texture,origin:[0,0,t]})}this.pass=this.gpu.createRenderPass(this.device,{clearColor:[.1,.2,.3,1],clearDepth:1}),this.register([this.vertBuffer,this.indexBuffer,this.pass,a,o,c])}render(e){const t=B(P(this.width/this.height,Math.PI/4,.01,100),D([10*Math.cos(e),5*Math.sin(e),10*Math.sin(e)],[0,0,0]));let r=t;return this.cube.updateCamera(r),r=B(t,F([10,10,10]),t),this.skybox.updateCamera(r),this.gpu.beginRenderPass(this.device,this.pass),this.cube.render(this.device),this.skybox.render(this.device),this.gpu.submitRenderPass(this.device),!0}destroy(){super.destroy(),this.cube.destroy(),this.skybox.destroy()}}class le{constructor(e,t,r){this.id=e,this.title=t,this.factory=r}}const ue=[new le("basic","Hello World",((e,t)=>new a(e,t))),new le("instancing","Buffers & Instancing",((e,t)=>new d(e,t))),new le("texture","Texture & Sampler",((e,t)=>new ce(e,t))),new le("stencil","Depth Stencil",((e,t)=>new K(e,t))),new le("postprocess","Post-processing",((e,t)=>new L(e))),new le("mrt","Multi Render Targets",((e,t)=>new C(e))),new le("pbr","Physically Based Rendering",((e,t)=>new X(e)))]},618:(e,t,r)=>{r.d(t,{db:()=>a,r:()=>s,Xv:()=>p,Go:()=>i,lD:()=>d,c4:()=>o,CJ:()=>u,gS:()=>f,om:()=>h,MA:()=>g,iy:()=>l,LI:()=>c});var n=r(665);class i{init(){}render(e){return!1}resize(e,t){}destroy(){}}class s extends i{resources=[];width=1;height=1;constructor(e=!1){super(),this.useWebGPU=e}get gpu(){return this.useWebGPU?n.SD:n.XY}resize(e,t){this.width=e,this.height=t}destroy(){for(let e=0;e<this.resources.length;++e)this.resources[e].destroy();this.resources.length=0}register(e){for(let t=0;t<e.length;++t)this.resources.push(e[t])}}const a=1337,o=512;function c(e){const t=e.positions,r=e.uvs,n=e.normals,i=e.colors;let s=0,a=0;t&&(a=t.length,s+=3),r&&(s+=2),n&&(s+=3),i&&(s+=4);const o=new Float32Array(s*a);for(let e=0;e<a;++e){let a=0;t&&(o[e*s+a++]=t[e][0],o[e*s+a++]=t[e][1],o[e*s+a++]=t[e][2]),r&&(o[e*s+a++]=r[e][0],o[e*s+a++]=r[e][1]),n&&(o[e*s+a++]=n[e][0],o[e*s+a++]=n[e][1],o[e*s+a++]=n[e][2]),i&&(o[e*s+a++]=i[e][0],o[e*s+a++]=i[e][1],o[e*s+a++]=i[e][2],o[e*s+a++]=i[e][3])}return o}function l(e){const t=e.indices;if(!t)return new Uint16Array(0);const r=new Uint16Array(3*t.length);for(let e=0;e<t.length;++e)r[3*e]=t[e][0],r[3*e+1]=t[e][1],r[3*e+2]=t[e][2];return r}const u={positions:[[0,.5,0],[.5,-.5,0],[-.5,-.5,0]],colors:[[1,0,0,1],[0,1,0,1],[0,0,1,1]]},d={positions:[[-1,-1,1],[1,-1,1],[1,1,1],[-1,-1,1],[1,1,1],[-1,1,1]],uvs:[[0,0],[1,0],[1,1],[0,0],[1,1],[0,1]]},p={indices:[[2,1,0],[2,0,3],[6,5,4],[6,4,7],[10,9,8],[10,8,11],[14,13,12],[14,12,15],[18,17,16],[18,16,19],[20,21,22],[23,20,22]],positions:[[-1,1,1],[1,1,1],[1,-1,1],[-1,-1,1],[1,1,-1],[-1,1,-1],[-1,-1,-1],[1,-1,-1],[1,1,1],[1,1,-1],[1,-1,-1],[1,-1,1],[-1,1,-1],[-1,1,1],[-1,-1,1],[-1,-1,-1],[-1,1,-1],[1,1,-1],[1,1,1],[-1,1,1],[-1,-1,-1],[1,-1,-1],[1,-1,1],[-1,-1,1]],uvs:[[0,0],[1,0],[1,1],[0,1],[0,0],[1,0],[1,1],[0,1],[0,0],[1,0],[1,1],[0,1],[0,0],[1,0],[1,1],[0,1],[0,0],[1,0],[1,1],[0,1],[0,0],[1,0],[1,1],[0,1]],normals:[[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,-1],[0,0,-1],[0,0,-1],[0,0,-1],[1,0,0],[1,0,0],[1,0,0],[1,0,0],[-1,0,0],[-1,0,0],[-1,0,0],[-1,0,0],[0,1,0],[0,1,0],[0,1,0],[0,1,0],[0,-1,0],[0,-1,0],[0,-1,0],[0,-1,0]],colors:[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[0,1,0,1],[0,1,0,1],[0,1,0,1],[0,1,0,1],[0,0,1,1],[0,0,1,1],[0,0,1,1],[0,0,1,1],[1,1,0,1],[1,1,0,1],[1,1,0,1],[1,1,0,1],[0,1,1,1],[0,1,1,1],[0,1,1,1],[0,1,1,1],[1,0,1,1],[1,0,1,1],[1,0,1,1],[1,0,1,1]]};function f(e,t,r,i=n.FB.Vertex){const s=e.createBuffer(t,{usage:i,size:r.byteLength});return e.writeBuffer(t,s,r),s}function h(e){const t=new Float32Array(e.length);for(let r=0;r<e.length;++r)t[r]=e[r];return t}function g(e){const t=new Uint16Array(e.length);for(let r=0;r<e.length;++r)t[r]=e[r];return t}},721:(e,t,r)=>{r.d(t,{g:()=>o,l:()=>c});var n=r(837),i=r(618);function s(e){const t=new Image;return e.canvas.toBlob((e=>t.src=URL.createObjectURL(e))),t}const a={};function o(e){return a[e]}function c(e=i.c4){const t=document.createElement("div");return t.style.display="none",document.body.appendChild(t),new Promise(((r,n)=>{let i=1;const a=()=>{--i<=0&&r()},o=function(e){const t=new Image;return t.crossOrigin="anonymous",t.src="./airplane.png",t}();o.id="airplane",o.onload=async()=>{await l(o),a()},o.onerror=n,t.appendChild(o);const c=function(e){const t=document.createElement("canvas");t.width=t.height=e;const r=t.getContext("2d"),n="#28ccdf",i="#39314b",a=r.createLinearGradient(0,0,0,e);a.addColorStop(0,n),a.addColorStop(.4,"#8aebf1"),a.addColorStop(.99,"#dff6f5"),a.addColorStop(1,i),r.fillStyle=n,r.fillRect(0,0,e,e);const o=s(r);r.fillStyle=i,r.fillRect(0,0,e,e);const c=s(r);return r.fillStyle=a,r.fillRect(0,0,e,e),[s(r),o,c]}(e);i+=c.length;for(let e=0;e<c.length;++e)c[e].id=`sky${e}`,c[e].onload=async()=>{await l(c[e]),a()},c[e].onerror=n,t.appendChild(c[e])}))}async function l(e){const t=await createImageBitmap(e);a[e.id]=t,(0,n.gf)(e.id,t)}},440:(e,t,r)=>{r.a(e,(async(e,t)=>{try{var n=r(940),i=r(513),s=r(100),a=r(720),o=r(837),c=r(618),l=r(299),u=r(721),d=r(869),p=e([d]);d=(p.then?(await p)():p)[0];let m,v=!1,x=!1,b=0,B=0,y=0;const S=await(0,d.Y)();function f(e,t,r){return(t,n)=>x?new G(e,n?B:y):r(t,n)}const w={};for(let C=0;C<l.B.length;++C)w[l.B[C].id]=new l.p(l.B[C].id,l.B[C].title,f(C,l.B[C].id,l.B[C].factory));w.gltf=new l.p("gltf","glTF Model Viewer 🔗",(()=>new T("../gltf-viewer"))),w.docs=new l.p("docs","API Documentation 🔗",(()=>new T("../docs")));const F=document.getElementById("menu");for(const E in w){const O=document.createElement("li"),U=document.createElement("a");U.id=w[E].id,U.href=`#${w[E].id}`,U.innerText=w[E].title,O.appendChild(U),F.appendChild(O)}const P=document.getElementById("canvas"),D=document.getElementById("canvas2");function h(e){const t=window.devicePixelRatio||1;if(t>1){const{width:r,height:n}=e;e.width=r*t,e.height=n*t,e.style.width=`${r}px`,e.style.height=`${n}px`}}h(P),h(D);const R=n.requestWebGL2Device(P,{stencil:!0,powerPreference:"low-power"},i.N.TextureAnisotropic|i.N.TextureHalfFloatLinear|i.N.TextureFloatLinear|i.N.ColorBufferFloat);y=(0,o.JE)(c.db,R,"canvas",n);const M=s.requestWebGPUDevice(D,{powerPreference:"low-power",depthStencilFormat:a.EV.Depth24Stencil8});function g(e=0){b=requestAnimationFrame(g),m.render(e/1e3)||cancelAnimationFrame(b)}M.then((e=>{e&&(B=(0,o.JE)(c.db,e,"canvas2",s))})),window.loadExample=async function(e=location.hash){const t=w[e.replace("#","")];if(t){document.getElementById("title").innerText=t.title,document.getElementById("code").href=`https://github.com/andykswong/mugl/tree/main/examples/src/apps/${t.id}.ts`,cancelAnimationFrame(b),m&&(m.destroy(),v?s.resetDevice(await M):n.resetDevice(R)),m=t.factory(v?await M:R,v),m.init();const e=v?D:P;m.resize(e.width,e.height),g()}},(0,u.l)().then((()=>{window.loadExample()})),location.hash=location.hash||"#basic",document.getElementById("envMode")?.addEventListener("click",(e=>{x=e.target.checked,window.loadExample()})),document.getElementById("gpuMode")?.addEventListener("click",(e=>{v=e.target.checked,P.style.display=v?"none":"block",D.style.display=v?"block":"none",window.loadExample()}));class T extends c.Go{constructor(e){super(),this.uri=e}render(){return window.location.replace(this.uri),!1}}class G extends c.Go{constructor(e,t){super(),this.id=e,this.deviceId=t}init(){S.init(this.id,this.deviceId,v)}render(e){return S.render(e)}resize(e,t){S.resize(e,t)}destroy(){S.destroy()}}t()}catch(X){t(X)}}),1)},665:(e,t,r)=>{r.d(t,{OB:()=>i.OB,$l:()=>i.$l,FB:()=>i.FB,wb:()=>i.wb,Wf:()=>i.Wf,X9:()=>i.X9,$X:()=>i.$X,xS:()=>i.xS,kd:()=>i.kd,EV:()=>i.EV,v2:()=>i.v2,gB:()=>i.gB,XY:()=>a,SD:()=>o,gJ:()=>c,O5:()=>s.O5});var n=r(721),i=r(720),s=r(232),a=r(940),o=r(100);function c(e){return(0,n.g)(e)}},497:(e,t,r)=>{r.a(e,(async(e,n)=>{try{r.d(t,{D:()=>o,J:()=>a});var i=r(132),s=e([i]);function a(){}i=(s.then?(await s)():s)[0];const o=Date.now;n()}catch(c){n(c)}}))},869:(e,t,r)=>{r.a(e,(async(e,n)=>{try{r.d(t,{Y:()=>c});var i=r(837),s=r(132),a=r(618),o=e([s]);async function c(){return(0,i.GH)(a.db,s.memory),{init:s.init,render:s.render,resize:s.resize,destroy:s.destroy}}s=(o.then?(await o)():o)[0],n()}catch(l){n(l)}}))},940:(e,t,r)=>{r.r(t),r.d(t,{beginRenderPass:()=>j,copyBuffer:()=>Y,copyExternalImageToTexture:()=>z,copyTexture:()=>W,copyTextureToBuffer:()=>N,createBindGroup:()=>A,createBindGroupLayout:()=>I,createBuffer:()=>E,createRenderPass:()=>k,createRenderPipeline:()=>_,createSampler:()=>U,createShader:()=>X,createTexture:()=>O,draw:()=>ee,drawIndexed:()=>te,flush:()=>C,generateMipmap:()=>$,getDeviceFeatures:()=>G,isDeviceLost:()=>f,readBuffer:()=>V,requestWebGL2Device:()=>M,resetDevice:()=>T,setBindGroup:()=>Z,setBlendConst:()=>ie,setIndex:()=>Q,setRenderPipeline:()=>J,setScissorRect:()=>ne,setStencilRef:()=>se,setVertex:()=>K,setViewport:()=>re,submitRenderPass:()=>H,writeBuffer:()=>L,writeTexture:()=>q});var n=r(544),i=r(720),s=r(232),a=r(222);function o(e){switch(e){case n.R8:case n.sVf:case n.WsI:case n.h2H:return n.hMC;case n.LrX:case n.q6i:case n.iVF:case n.xiM:case n.If2:case n.$oc:return n.vPF;case n.$mf:case n.wAm:case n.MJi:case n.qed:return n.RG;case n.coM:case n.LGL:case n.ZLz:case n.qB9:case n.m89:case n.nR4:return n.BIZ;case n.hw6:case n.jnw:case n.Mgl:case n.blh:case n._hT:case n.Nug:return n.VS8;case n.r5A:case n.Qjo:case n.rxK:case n.Rkd:case n.Msg:case n.gtH:return n.SE0;case n.Khk:return n.eXq;case n.kv5:case n.d_Y:case n.dj5:return n.Mh0;case n.ABS:case n.Vwh:return n.U0z}return n.Hnw}function c(e){switch(e){case n.R8:case n.LrX:case n.sVf:case n.q6i:return 1;case n.iVF:case n.xiM:case n.$mf:case n.coM:case n.wAm:case n.LGL:case n.WsI:return 2;case n.If2:case n.$oc:case n.h2H:case n.ZLz:case n.qB9:case n.MJi:case n.hw6:case n.jnw:case n.r5A:case n.Mgl:case n.Qjo:case n.blh:case n.Khk:return 4;case n.m89:case n.nR4:case n.qed:case n.rxK:case n.Msg:case n._hT:return 8;case n.Rkd:case n.gtH:case n.Nug:return 16;case n.kv5:return 2;case n.d_Y:case n.ABS:case n.dj5:return 4;case n.Vwh:return 8}return 0}function l(e){switch(e){case n.R8:case n.LrX:case n.$mf:case n.coM:case n.hw6:case n.jnw:case n.r5A:return n.wgU;case n.sVf:case n.q6i:case n.wAm:case n.LGL:case n.Mgl:case n.Qjo:return n.d93;case n.iVF:case n.ZLz:case n.rxK:return n.Ae4;case n.xiM:case n.qB9:case n.Msg:return n.QoO;case n.If2:case n.m89:case n.Rkd:return n.r1O;case n.$oc:case n.nR4:case n.gtH:return n.bBe;case n.blh:return n.fa2;case n.WsI:case n.MJi:case n._hT:return n.s_k;case n.h2H:case n.qed:case n.Nug:return n.RFu;case n.Khk:return n.JpA;case n.kv5:return n.Ae4;case n.d_Y:return n.r1O;case n.ABS:return n.mLJ;case n.dj5:return n.RFu;case n.Vwh:return n.EZf}return n.Hnw}function u(e){switch(e){case n.q6i:case n.xiM:case n.$oc:case n.LGL:case n.qB9:case n.nR4:case n.Qjo:case n.Msg:case n.gtH:return n.bBe;case n.LrX:case n.iVF:case n.If2:case n.coM:case n.ZLz:case n.m89:case n.r5A:case n.rxK:case n.Rkd:return n.r1O}return n.RFu}var d=r(513);const p=4294967295;function f(e){return e.gl.isContextLost()}function h(e){const t=g();e.blendColor(1,1,1,1),v(e,null,t,t,0,!0);const r=e.getParameter(n.Fcx);for(let t=0;t<r;++t)e.disableVertexAttribArray(t);return e.pixelStorei(n.d8P,1),e.pixelStorei(n.T_I,1),{copyFrameBuffer:e.createFramebuffer(),buffers:[],state:t,pipeline:null,index:null,stencilRef:0,scissor:!1}}function g(e={}){const t=e.primitive||{},r=e.depthStencil||{},{stencilFront:i={},stencilBack:s={}}=r,{sampleCount:a=1,alphaToCoverage:o=!1}=e.multisample||{},c=e.targets||{},l=c.targets&&c.targets.map((e=>m(e.blendColor,e.blendAlpha,e.writeMask)))||[];return{sampleCount:a,alphaToCoverage:o,topology:t.topology||n.QPP,indexFormat:t.indexFormat||n.Ae4,frontFace:t.frontFace||n.iHR,cullMode:t.cullMode||n.Hnw,depth:!!e.depthStencil,depthWrite:r.depthWrite||!1,depthFormat:r.format||n.kv5,depthCompare:r.depthCompare||n.Brs,depthBias:r.depthBias||0,depthBiasSlopeScale:r.depthBiasSlopeScale||0,stencil:!(!r.stencilFront&&!r.stencilBack),stencilFrontCompare:i.compare||n.Brs,stencilFrontFailOp:i.failOp||n.M$f,stencilFrontDepthFailOp:i.depthFailOp||n.M$f,stencilFrontPassOp:i.passOp||n.M$f,stencilBackCompare:s.compare||n.Brs,stencilBackFailOp:s.failOp||n.M$f,stencilBackDepthFailOp:s.depthFailOp||n.M$f,stencilBackPassOp:s.passOp||n.M$f,stencilReadMask:r.stencilReadMask||p,stencilWriteMask:r.stencilWriteMask||p,blend:!!e.targets,drawBuffers:l,...m(c.blendColor,c.blendAlpha,c.writeMask)}}function m(e={},t={},r=i.Yw.All){return{blendWriteMask:r,blendColorOp:e.operation||n.BjA,blendColorSrcFactor:void 0!==e.srcFactor?e.srcFactor:n.ryP,blendColorDstFactor:e.dstFactor||n.xEJ,blendAlphaOp:t.operation||n.BjA,blendAlphaSrcFactor:void 0!==t.srcFactor?t.srcFactor:n.ryP,blendAlphaDstFactor:t.dstFactor||n.xEJ}}function v(e,t,r,i,s=0,a=!1){let o=!1,c=0,l=0,u=0,d=0;if(c=i.frontFace,(a||r.frontFace!==c)&&e.frontFace(c),c=i.cullMode,(a||r.cullMode!==c)&&((o=c!==n.Hnw)&&e.cullFace(c),S(e,n.DuX,o)),o=i.alphaToCoverage,(a||r.alphaToCoverage!==o)&&S(e,n.fRZ,o),o=!!i.depth,(a||r.depth!==o)&&S(e,n.Elr,o),(a||o)&&(B(e,r.depthWrite,i.depthWrite,a),c=i.depthCompare,(a||r.depthCompare!==c)&&e.depthFunc(c)),c=i.depthBiasSlopeScale,l=i.depthBias,(a||r.depthBiasSlopeScale!==c||r.depthBias!==l)&&(S(e,n.gYZ,!(!c&&!l)),e.polygonOffset(c,l)),o=!!i.stencil,(a||r.stencil!==o)&&S(e,n.nT3,o),(a||o)&&(c=i.stencilReadMask,o=a||r.stencilReadMask!==c,l=i.stencilFrontCompare,(o||r.stencilFrontCompare!==l)&&e.stencilFuncSeparate(n.kpY,l,s,c),l=i.stencilBackCompare,(o||r.stencilBackCompare!==l)&&e.stencilFuncSeparate(n.FoO,l,s,c),c=i.stencilFrontFailOp,l=i.stencilFrontDepthFailOp,u=i.stencilFrontPassOp,(a||r.stencilFrontFailOp!==c||r.stencilFrontDepthFailOp!==l||r.stencilFrontPassOp!==u)&&e.stencilOpSeparate(n.kpY,c,l,u),c=i.stencilBackFailOp,l=i.stencilBackDepthFailOp,u=i.stencilBackPassOp,(a||r.stencilBackFailOp!==c||r.stencilBackDepthFailOp!==l||r.stencilBackPassOp!==u)&&e.stencilOpSeparate(n.FoO,c,l,u),y(e,r.stencilWriteMask,i.stencilWriteMask,a)),o=i.blend,(a||r.blend!==o)&&S(e,n.uvM,o),(a||o)&&(c=i.blendColorSrcFactor,l=i.blendColorDstFactor,u=i.blendAlphaSrcFactor,d=i.blendAlphaDstFactor,(a||r.blendColorSrcFactor!==c||r.blendColorDstFactor!==l||r.blendAlphaSrcFactor!==u||r.blendAlphaDstFactor!==d)&&e.blendFuncSeparate(c,l,u,d),c=i.blendColorOp,l=i.blendAlphaOp,(a||r.blendColorOp!==c||r.blendAlphaOp!==l)&&e.blendEquationSeparate(c,l),b(e,r.blendWriteMask,i.blendWriteMask,a),t))for(let e=0;e<i.drawBuffers.length;++e)x(t,e,i,i.drawBuffers[e])}function x(e,t,r,n,s=!1){let a=0,o=0,c=0,l=0;a=n.blendColorSrcFactor,o=n.blendColorDstFactor,c=n.blendAlphaSrcFactor,l=n.blendAlphaDstFactor,(s||r.blendColorSrcFactor!==a||r.blendColorDstFactor!==o||r.blendAlphaSrcFactor!==c||r.blendAlphaDstFactor!==l)&&e.blendFuncSeparateiOES(t,a,o,c,l),a=n.blendColorOp,o=n.blendAlphaOp,(s||r.blendColorOp!==a||r.blendAlphaOp!==o)&&e.blendEquationSeparateiOES(t,a,o),function(e,t,r,n,s=!1){(s||r!==n)&&e.colorMaskiOES(t,!!(n&i.Yw.Red),!!(n&i.Yw.Green),!!(n&i.Yw.Blue),!!(n&i.Yw.Alpha))}(e,t,r.blendWriteMask,n.blendWriteMask,s)}function b(e,t,r,n=!1){(n||t!==r)&&e.colorMask(!!(r&i.Yw.Red),!!(r&i.Yw.Green),!!(r&i.Yw.Blue),!!(r&i.Yw.Alpha))}function B(e,t,r,n=!1){(n||t!==r)&&e.depthMask(r)}function y(e,t,r,n=!1){(n||t!==r)&&e.stencilMask(r)}function S(e,t,r){r?e.enable(t):e.disable(t)}function w(e,t,{texture:r,slice:i=0,mipLevel:a=0}){if((0,s.cj)(r.type))e.framebufferTextureLayer(n.fjQ,t,r.glt,a,i);else{const s=r.type===n.Ep7?n._fi+i:r.type;e.framebufferTexture2D(n.fjQ,t,s,r.glt,a)}}function F(e,t,r){const i=e.createFramebuffer();return e.bindFramebuffer(n.fjQ,i),w(e,t,r),i}function P(e,t,r,i,s,a=n.Z$E){e.bindFramebuffer(n.xWx,t),e.bindFramebuffer(n.iXE,r),e.readBuffer(a),e.blitFramebuffer(0,0,i.width,i.height,0,0,i.width,i.height,s,n.jX6)}function D(e,t,r){e.bindBuffer(n.qOY,t.glb);for(let n=0;n<t.attributes.length;++n){const{ptr:i,step:s}=t.attributes[n],a=[...i];a[5]+=r,e.vertexAttribPointer(...a),e.vertexAttribDivisor(i[0],s)}}const R=255;function M(e,t={},r=0){const n=e.getContext("webgl2",t);if(n){let t=0;for(const e in d.T)r&+e&&n.getExtension(d.T[+e])&&(t|=+e);const i=t&d.N.DrawBuffersIndexed?n.getExtension(d.T[d.N.DrawBuffersIndexed]):null,s=h(n),a=e=>{e.deleteFramebuffer(s.copyFrameBuffer)};return{canvas:e,gl:n,features:t,extDrawBuffersi:i,pass:null,state:s,destroy(){a(this.gl)}}}return null}function T(e){e.destroy(),Object.assign(e.state,h(e.gl))}function G(e){return e.features}function C(e){e.gl.flush()}function E(e,t){const r=t.usage&i.FB.Uniform?n.MfQ:t.usage&i.FB.Index?n.cXR:n.qOY,s=t.usage&i.FB.Stream?n.F_0:t.usage&i.FB.Dynamic?n.kdr:n.MBW,a=e.gl.createBuffer();return e.gl.bindBuffer(r,a),e.gl.bufferData(r,t.size,s),{gl:e.gl,glb:a,type:r,size:t.size,destroy(){this.gl.deleteBuffer(a)}}}function O(e,t){const r=t.sampleCount||1,a=t.dimension||n.Bxn,o=t.format||n.hw6,c=!(0,s.EC)(o)||(t.usage||0)&i.v2.TextureBinding,[l,u,d]=t.size||[1,1,1],p=a===n.Ep7?6:a===n.Bxn?1:d;let f=null,h=null;return(r>1||!c)&&(h=e.gl.createRenderbuffer(),e.gl.bindRenderbuffer(n.bW,h),r>1?e.gl.renderbufferStorageMultisample(n.bW,r,o,l,u):e.gl.renderbufferStorage(n.bW,o,l,u)),c&&(f=e.gl.createTexture(),e.gl.activeTexture(n.VKS),e.gl.bindTexture(a,f),(0,s.cj)(a)?e.gl.texStorage3D(a,t.mipLevelCount||1,o,l,u,p):e.gl.texStorage2D(a,t.mipLevelCount||1,o,l,u)),{gl:e.gl,glt:f,glrb:h,type:a,format:o,width:l,height:u,depth:p,samples:r,destroy(){var e;(e=this.gl).deleteTexture(f),e.deleteRenderbuffer(h)}}}function U(e,t={}){const r=e.gl.createSampler();let i=t.minFilter||n.jX6;return t.mipmapFilter&&(i=t.mipmapFilter===n.jX6?i===n.jX6?n.wFH:n.LRx:i===n.jX6?n.Oxh:n.q0S),e.gl.samplerParameteri(r,n.$X9,i),e.gl.samplerParameteri(r,n.Xeo,t.magFilter||n.jX6),e.gl.samplerParameteri(r,n.n4e,t.addressModeU||n.mYe),e.gl.samplerParameteri(r,n.nbD,t.addressModeV||n.mYe),e.gl.samplerParameteri(r,n.J51,t.addressModeW||n.mYe),e.gl.samplerParameterf(r,n.HiH,void 0!==t.lodMaxClamp?t.lodMaxClamp:32),e.gl.samplerParameterf(r,n.pge,t.lodMinClamp||0),t.compare&&(e.gl.samplerParameterf(r,n.LOg,n.fqf),e.gl.samplerParameterf(r,n.w0M,t.compare)),(t.maxAnisotropy||1)>1&&e.gl.samplerParameterf(r,n.cMJ,Math.min(t.maxAnisotropy||1,e.gl.getParameter(n.Cip))),{gls:r,gl:e.gl,destroy(){this.gl.deleteSampler(r)}}}function X(e,t){const r=t.usage===i.$X.Vertex?n.HI8:n.YMo,s=e.gl.createShader(r);return e.gl.shaderSource(s,t.code),e.gl.compileShader(s),{gl:e.gl,gls:s,destroy(){this.gl.deleteShader(s)}}}function k(e,t={}){let r=null;const i=[],a=t.depthStencil?t.depthStencil.texture:null,o=a&&(0,s.IO)(a.format)||!1;if(t.colors&&t.colors.length){r=e.gl.createFramebuffer(),e.gl.bindFramebuffer(n.fjQ,r);for(let r=0;r<t.colors.length;++r)t.colors[r].view.texture.samples>1?e.gl.framebufferRenderbuffer(n.fjQ,n.Z$E+r,n.bW,t.colors[r].view.texture.glrb):w(e.gl,n.Z$E+r,t.colors[r].view);t.colors.length>1&&e.gl.drawBuffers(t.colors.map(((e,t)=>n.Z$E+t))),a&&(a.glrb?e.gl.framebufferRenderbuffer(n.fjQ,o?n.TU:n.Ec0,n.bW,a.glrb):w(e.gl,o?n.TU:n.Ec0,t.depthStencil));for(let r=0;r<t.colors.length;++r)i.push(t.colors[r].view.texture.samples>1?F(e.gl,n.Z$E,t.colors[r].view):null);i.push(a&&a.samples>1&&a.glt?F(e.gl,o?n.TU:n.Ec0,t.depthStencil):null)}return{gl:e.gl,glfb:r,glrfb:i,depth:a,color:t.colors?t.colors.map((e=>e.view.texture)):[],clearColors:t.colors?t.colors.map((e=>e.clear)):[],clearColor:t.clearColor,clearDepth:t.clearDepth,clearStencil:t.clearStencil,destroy(){(e=>{e.deleteFramebuffer(r);for(const t of i)e.deleteFramebuffer(t)})(this.gl)}}}function I(e,t){return{entries:t.entries.map(((e,t)=>({binding:t,...e}))),destroy(){}}}function A(e,t){return{entries:t.entries.map(((e,t)=>({binding:t,...e}))),destroy(){}}}function _(e,t){const r=function(e,t,r){const n=e.gl.createProgram();return e.gl.attachShader(n,t),e.gl.attachShader(n,r),e.gl.linkProgram(n),n}(e,t.vertex.gls,t.fragment.gls),s=[],a={};let o=0,c=0;if(t.bindGroups){for(let l=0;l<t.bindGroups.length;++l){const u=t.bindGroups[l].entries;s.push([]);for(let t=0;t<u.length;++t){const d=u[t];let p=null,f=n.EP2;d.type===i.$l.Buffer?(f=e.gl.getUniformBlockIndex(r,d.label),e.gl.uniformBlockBinding(r,f,o++)):d.type===i.$l.Texture&&(p=e.gl.getUniformLocation(r,d.label),a[d.label]=c++),s[l][d.binding]={...d,loc:p,index:f,slot:d.type===i.$l.Buffer?o-1:d.type===i.$l.Texture?c-1:0}}}for(let e=0;e<t.bindGroups.length;++e){const r=t.bindGroups[e].entries;for(let t=0;t<r.length;++t)r[t].type===i.$l.Sampler&&a[r[t].label]&&(s[e][r[t].binding].slot=a[r[t].label])}}return{gl:e.gl,glp:r,buffers:t.buffers,cache:s,state:g(t),destroy(){this.gl.deleteProgram(r)}}}function V(e,t,r,i=0){const s=Math.max(r?.byteLength||0,t.size-i,0);if(s<=0)return{status:a.Q.Error,value:r||new Uint8Array,then:(e,t)=>Promise.reject().then(e,t)};let o=r;const c={status:a.Q.Pending,get value(){return o},then:(e,t)=>l.then(e,t)},l=function(e,t,r,i,s){const a=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);return e.flush(),function(e,t,r,i){return new Promise(((r,i)=>{!function s(){const a=e.clientWaitSync(t,0,0);a==n.XjA?i():a==n.iRB?setTimeout(s,10):r()}()}))}(e,a).finally((()=>e.deleteSync(a))).then((()=>{const n=new Uint8Array(s);return e.bindBuffer(t,r),e.getBufferSubData(t,i,n,0,s),n}))}(e.gl,t.type,t.glb,i,s).then((e=>(r?.set(e),c.status=a.Q.Done,o=r||e)),(e=>{throw c.status=a.Q.Error,e}));return c}function L(e,t,r,n=0){e.gl.bindBuffer(t.type,t.glb),e.gl.bufferSubData(t.type,n,r)}function Y(e,t,r,i=t.size,s=0,a=0){e.gl.bindBuffer(n.u99,t.glb),e.gl.bindBuffer(n.i_,r.glb),e.gl.copyBufferSubData(n.u99,n.i_,s,a,i)}function $(e,t,r=n.wdg){e.gl.activeTexture(n.VKS),e.gl.bindTexture(t.type,t.glt),e.gl.hint(n.jpO,r),e.gl.generateMipmap(t.type)}function q(e,{texture:t,mipLevel:r=0,origin:[i,a,u]=[0,0,0]},d,{offset:p=0,bytesPerRow:f,rowsPerImage:h=0},[g,m,v]=[t.width-i,t.height-a,t.depth-u]){const x=o(t.format),b=l(t.format),B=t.type===n.Ep7,y=B?n._fi+u:t.type;e.gl.activeTexture(n.VKS),e.gl.bindTexture(t.type,t.glt);const S=c(t.format),w=h||m,F=Math.floor(f/S),P=p-p%f;if(e.gl.pixelStorei(n.AAP,w),e.gl.pixelStorei(n.GNc,F),e.gl.pixelStorei(n.u$q,Math.floor(p%f/S)),e.gl.pixelStorei(n.Sr6,0),e.gl.pixelStorei(n.mku,0),(0,s.cj)(t.type))e.gl.texSubImage3D(y,r,i,a,u,g,m,v,t.format,b,d,P);else if(B)for(let t=u;t<u+v;++t)e.gl.pixelStorei(n.Sr6,t*F*w),e.gl.texSubImage2D(y+t,r,i,a,g,m,x,b,d,P);else e.gl.texSubImage2D(y,r,i,a,g,m,x,b,d,P)}function z(e,{src:t,origin:[r,i]=[0,0]},{texture:a,mipLevel:c=0,origin:[u,d,p]=[0,0,0]},[f,h]=[t.width-r,t.height-i]){const g=l(a.format),m=a.type===n.Ep7?n._fi+p:a.type;e.gl.activeTexture(n.VKS),e.gl.bindTexture(a.type,a.glt),e.gl.pixelStorei(n.u$q,r),e.gl.pixelStorei(n.Sr6,i),e.gl.pixelStorei(n.mku,0),e.gl.pixelStorei(n.AAP,0),(0,s.cj)(a.type)?e.gl.texSubImage3D(m,c,u,d,p,f,h,1,a.format,g,t):e.gl.texSubImage2D(m,c,u,d,f,h,o(a.format),g,t)}function W(e,{texture:t,mipLevel:r=0,origin:[i,a,o]=[0,0,0]},{texture:c,mipLevel:l=0,origin:[u,d,p]=[0,0,0]},[f,h,g]=[t.width-i,t.height-a,t.depth-o]){const m=c.type===n.Ep7,v=m?n._fi+p:c.type;if(e.gl.activeTexture(n.VKS),e.gl.bindTexture(c.type,c.glt),e.gl.readBuffer(n.Z$E),e.gl.bindFramebuffer(n.fjQ,e.state.copyFrameBuffer),(0,s.cj)(t.type)||t.type===n.Ep7)for(let x=o;x<o+g;++x)w(e.gl,n.Z$E,{texture:t,mipLevel:r,slice:x}),(0,s.cj)(c.type)?e.gl.copyTexSubImage3D(v+(m?x:0),l,u,d,p,i,a,f,h):e.gl.copyTexSubImage2D(v+(m?x:0),l,u,d,i,a,f,h);else{const o=0;w(e.gl,n.Z$E,{texture:t,mipLevel:r,slice:o}),(0,s.cj)(c.type)?e.gl.copyTexSubImage3D(v+(m?o:0),l,u,d,p,i,a,f,h):e.gl.copyTexSubImage2D(v+(m?o:0),l,u,d,i,a,f,h)}e.gl.bindFramebuffer(n.fjQ,e.pass?e.pass.glfb:null)}function N(e,{texture:t,mipLevel:r=0,origin:[i,a,u]=[0,0,0]},d,{offset:p=0,bytesPerRow:f,rowsPerImage:h=0},[g,m,v]=[t.width-i,t.height-a,t.depth-u]){e.gl.bindBuffer(n.cJA,d.glb),e.gl.readBuffer(n.Z$E),e.gl.bindFramebuffer(n.fjQ,e.state.copyFrameBuffer);const x=l(t.format),b=o(t.format),B=c(t.format),y=h||m,S=Math.floor(f/B),F=p-p%f;if(e.gl.pixelStorei(n.U02,S),e.gl.pixelStorei(n.$Hb,Math.floor(p%f/B)),e.gl.pixelStorei(n.k5F,0),(0,s.cj)(t.type)||t.type===n.Ep7)for(let s=u;s<u+v;++s)w(e.gl,n.Z$E,{texture:t,mipLevel:r,slice:s}),e.gl.readPixels(i,a,g,m,b,x,F+(s-u)*f*y);else{const s=0;w(e.gl,n.Z$E,{texture:t,mipLevel:r,slice:s}),e.gl.readPixels(i,a,g,m,b,x,F)}e.gl.bindFramebuffer(n.fjQ,e.pass?e.pass.glfb:null)}function j(e,t=k(e)){let r=e.gl.drawingBufferWidth,s=e.gl.drawingBufferHeight;t.color.length&&(r=t.color[0].width,s=t.color[0].height),e.gl.bindFramebuffer(n.fjQ,t.glfb),e.gl.viewport(0,0,r,s),e.gl.depthRange(0,1),e.state.scissor&&(e.state.scissor=!1,S(e.gl,n.yN1,!1));let a=0;if(isNaN(t.clearDepth)||(a|=n.yXb,e.gl.clearDepth(t.clearDepth),B(e.gl,e.state.state.depthWrite,!0),e.state.state.depthWrite=!0),isNaN(t.clearStencil)||(a|=n.ecp,e.gl.clearStencil(t.clearStencil),y(e.gl,e.state.state.stencilWriteMask,R),e.state.state.stencilWriteMask=R),b(e.gl,e.state.state.blendWriteMask,i.Yw.All),e.state.state.blendWriteMask=i.Yw.All,t.color.length){for(let r=0;r<t.color.length;++r)if(t.clearColors[r]){const i=u(t.color[r].format);i===n.bBe?e.gl.clearBufferiv(n.r$7,r,t.clearColors[r]):i===n.r1O?e.gl.clearBufferuiv(n.r$7,r,t.clearColors[r]):e.gl.clearBufferfv(n.r$7,r,t.clearColors[r])}}else t.clearColor&&(a|=n._Hr,e.gl.clearColor(...t.clearColor));a&&e.gl.clear(a),e.pass=t}function H(e){if(e.pass){for(let t=0;t<e.pass.color.length;++t)e.pass.glrfb[t]&&P(e.gl,e.pass.glfb,e.pass.glrfb[t],e.pass.color[t],n._Hr,n.Z$E+t);const t=e.pass.glrfb[e.pass.glrfb.length-1];e.pass.depth&&t&&P(e.gl,e.pass.glfb,t,e.pass.depth,n.yXb|n.ecp)}e.pass=null}function J(e,t){if(e.state.pipeline===t)return;e.state.pipeline&&e.state.pipeline.glp===t.glp||e.gl.useProgram(t.glp),v(e.gl,e.extDrawBuffersi,e.state.state,t.state,e.state.stencilRef),Object.assign(e.state.state,t.state);const r=[];for(const{attributes:t}of e.state.buffers)for(const{ptr:e}of t)r[e[0]]=1;e.state.buffers=Array(t.buffers.length);for(let n=0;n<t.buffers.length;++n){const{attributes:i,stride:a,stepMode:o=0}=t.buffers[n],c=[];e.state.buffers[n]={glb:null,attributes:c,stride:a,step:o,offset:0,instanceOffset:0};for(const{format:e,offset:t,shaderLocation:l}of i)r[l]=(r[l]||0)+2,c.push({buffer:n,ptr:[l,(0,s.Xm)(e),(0,s.S5)(e),(0,s.bA)(e),a,t],step:o})}for(let t=0;t<r.length;++t)2===r[t]?e.gl.enableVertexAttribArray(t):1===r[t]&&e.gl.disableVertexAttribArray(t);e.state.pipeline=t}function Q(e,t){t.glb!==e.state.index&&e.gl.bindBuffer(n.cXR,e.state.index=t.glb)}function K(e,t,r,n=0){const i=e.state.buffers[t];!i||i.glb===r.glb&&i.offset===n||(i.glb=r.glb,i.offset=n,i.instanceOffset=0,D(e.gl,i,n))}function Z(e,t,r,i=[]){if(e.state.pipeline)for(let s=0,a=0;s<r.entries.length;++s){const o=r.entries[s],c=e.state.pipeline.cache[t]&&e.state.pipeline.cache[t][o.binding];if(c)if(o.buffer){let t=o.bufferOffset||0;c.bufferDynamicOffset&&(t+=i[a]||0,++a),e.gl.bindBufferRange(n.MfQ,c.slot,o.buffer.glb,t,o.bufferSize||o.buffer.size-t)}else o.texture?(e.gl.activeTexture(n.VKS+c.slot),e.gl.bindTexture(o.texture.type,o.texture.glt),e.gl.uniform1i(c.loc,c.slot)):o.sampler&&e.gl.bindSampler(c.slot,o.sampler.gls)}}function ee(e,t,r=1,n=0,i=0){for(const t of e.state.buffers)t.step&&t.instanceOffset!==i&&(t.instanceOffset=i,D(e.gl,t,i*t.stride));e.gl.drawArraysInstanced(e.state.state.topology,n,t,r)}function te(e,t,r=1,n=0,i=0){for(const t of e.state.buffers)t.step&&t.instanceOffset!==i&&(t.instanceOffset=i,D(e.gl,t,i*t.stride));e.gl.drawElementsInstanced(e.state.state.topology,t,e.state.state.indexFormat,n*(0,s.Ij)(e.state.state.indexFormat),r)}function re(e,t,r,n,i,s=0,a=1){e.gl.viewport(t,r,n,i),e.gl.depthRange(s,a)}function ne(e,t,r,i,s){e.state.scissor||(S(e.gl,n.yN1,!0),e.state.scissor=!0),e.gl.scissor(t,r,i,s)}function ie(e,t){e.gl.blendColor(...t)}function se(e,t){if(e.state.stencilRef!==t){const{stencilFrontCompare:r,stencilBackCompare:i,stencilReadMask:s}=e.state.state;e.gl.stencilFuncSeparate(n.kpY,r,t,s),e.gl.stencilFuncSeparate(n.FoO,i,t,s),e.state.stencilRef=t}}},513:(e,t,r)=>{r.d(t,{N:()=>n,T:()=>i});const n={TextureAnisotropic:1,TextureHalfFloatLinear:2,TextureFloatLinear:4,ColorBufferFloat:8,DrawBuffersIndexed:16},i={1:"EXT_texture_filter_anisotropic",2:"OES_texture_half_float_linear",4:"OES_texture_float_linear",8:"EXT_color_buffer_float",16:"OES_draw_buffers_indexed"}},544:(e,t,r)=>{r.d(t,{$Hb:()=>Ze,$X9:()=>Ge,$mf:()=>$t,$oc:()=>Kt,$sD:()=>_e,AAP:()=>st,ABS:()=>kt,Ae4:()=>K,BIZ:()=>Lt,BjA:()=>S,Brs:()=>ge,Bxn:()=>Oe,BzQ:()=>he,C4F:()=>ce,C6Q:()=>Se,CW:()=>L,Cip:()=>mr,DXJ:()=>de,DuX:()=>U,EP2:()=>pr,EPl:()=>yt,EZf:()=>Ut,Ec0:()=>ze,Elr:()=>I,Ep7:()=>Ue,Erx:()=>a,F_0:()=>T,Fcx:()=>oe,FoO:()=>O,GNc:()=>je,GPd:()=>le,HI8:()=>ae,HiH:()=>ut,Hnw:()=>Ne,If2:()=>Zt,J51:()=>ot,J57:()=>ve,Jhs:()=>w,JpA:()=>wt,KTj:()=>F,KXm:()=>dt,Khk:()=>St,LGL:()=>er,LOg:()=>ht,LRx:()=>De,LrX:()=>Ht,M$f:()=>me,MBW:()=>G,MJi:()=>Wt,MfQ:()=>dr,Mgl:()=>cr,Mh0:()=>re,Msg:()=>Mt,NRq:()=>N,Nug:()=>bt,OAz:()=>m,Oxh:()=>Re,PB6:()=>b,Q0U:()=>P,QPP:()=>l,Qjo:()=>Tt,QoO:()=>Q,R8:()=>Yt,RFu:()=>te,RG:()=>Vt,Rb8:()=>y,RcM:()=>xe,Rkd:()=>Ft,SE0:()=>Ct,Sr6:()=>He,TMl:()=>v,TU:()=>We,T_I:()=>$,Tr1:()=>at,U02:()=>Qe,U0z:()=>$e,Ukp:()=>o,VGh:()=>ye,VKS:()=>ke,VS8:()=>ie,Vwh:()=>Ot,WsI:()=>qt,Xeo:()=>Te,XjA:()=>hr,YMo:()=>se,Z$E:()=>qe,ZLz:()=>nr,_Hr:()=>s,_fi:()=>Xe,_hT:()=>Bt,aRZ:()=>Ie,b0H:()=>u,bBe:()=>Z,bW:()=>Le,blh:()=>nt,brc:()=>f,cJA:()=>mt,cMJ:()=>gr,cXR:()=>M,cgb:()=>c,coM:()=>tr,d8P:()=>q,d93:()=>H,d_Y:()=>ft,dj5:()=>Et,eXq:()=>ne,ecp:()=>i,fRZ:()=>V,fa2:()=>ct,fjQ:()=>Ve,fqf:()=>xt,gUF:()=>ue,gYZ:()=>_,gq9:()=>W,gtH:()=>Rt,h2H:()=>zt,hMC:()=>tt,hw6:()=>rt,hy5:()=>g,i$_:()=>h,iFn:()=>pe,iHR:()=>Y,iRB:()=>fr,iVF:()=>Qt,iXE:()=>At,i_:()=>ur,jX6:()=>we,jgr:()=>be,jnw:()=>vt,jpO:()=>j,k2X:()=>pt,k5F:()=>Ke,kdr:()=>C,kpY:()=>E,kv5:()=>Ye,ldG:()=>D,m89:()=>sr,mLJ:()=>Xt,mYe:()=>Ae,miX:()=>B,mku:()=>it,n4e:()=>Ce,nR4:()=>ir,nT3:()=>k,nbD:()=>Ee,njp:()=>x,nl2:()=>Be,pge:()=>lt,q0S:()=>Me,q6i:()=>jt,qB9:()=>rr,qOY:()=>R,qed:()=>Nt,r$7:()=>et,r1O:()=>ee,r5A:()=>Dt,rxK:()=>Pt,ryP:()=>p,sVf:()=>ar,s_k:()=>_t,t$R:()=>Fe,u$q:()=>Je,u99:()=>lr,uvM:()=>X,vPF:()=>Gt,vkJ:()=>fe,w0M:()=>gt,wAm:()=>or,wFH:()=>Pe,wdg:()=>z,wgU:()=>J,xEJ:()=>d,xWx:()=>It,xiM:()=>Jt,yN1:()=>A,yXb:()=>n});const n=256,i=1024,s=16384,a=0,o=1,c=3,l=4,u=5,d=0,p=1,f=768,h=769,g=770,m=771,v=772,x=773,b=774,B=775,y=776,S=32774,w=32778,F=32779,P=32769,D=32770,R=34962,M=34963,T=35040,G=35044,C=35048,E=1028,O=1029,U=2884,X=3042,k=2960,I=2929,A=3089,_=32823,V=32926,L=2304,Y=2305,$=3317,q=3333,z=4352,W=4353,N=4354,j=33170,H=5120,J=5121,Q=5122,K=5123,Z=5124,ee=5125,te=5126,re=6402,ne=6407,ie=6408,se=35632,ae=35633,oe=34921,ce=512,le=513,ue=514,de=515,pe=516,fe=517,he=518,ge=519,me=7680,ve=7681,xe=7682,be=7683,Be=5386,ye=34055,Se=34056,we=9728,Fe=9729,Pe=9984,De=9985,Re=9986,Me=9987,Te=10240,Ge=10241,Ce=10242,Ee=10243,Oe=3553,Ue=34067,Xe=34069,ke=33984,Ie=10497,Ae=33071,_e=33648,Ve=36160,Le=36161,Ye=33189,$e=34041,qe=36064,ze=36096,We=33306,Ne=0,je=3314,He=3315,Je=3316,Qe=3330,Ke=3331,Ze=3332,et=6144,tt=6403,rt=32856,nt=32857,it=32877,st=32878,at=32879,ot=32882,ct=33640,lt=33082,ut=33083,dt=32775,pt=32776,ft=33190,ht=34892,gt=34893,mt=35051,vt=35907,xt=34894,bt=34836,Bt=34842,yt=35866,St=35898,wt=35899,Ft=36208,Pt=36214,Dt=36220,Rt=36226,Mt=36232,Tt=36238,Gt=36244,Ct=36249,Et=36012,Ot=36013,Ut=36269,Xt=34042,kt=35056,It=36008,At=36009,_t=5131,Vt=33319,Lt=33320,Yt=33321,$t=33323,qt=33325,zt=33326,Wt=33327,Nt=33328,jt=33329,Ht=33330,Jt=33331,Qt=33332,Kt=33333,Zt=33334,er=33335,tr=33336,rr=33337,nr=33338,ir=33339,sr=33340,ar=36756,or=36757,cr=36759,lr=36662,ur=36663,dr=35345,pr=4294967295,fr=37147,hr=37149,gr=34046,mr=34047},222:(e,t,r)=>{r.d(t,{Q:()=>n});const n={Pending:0,Done:1,Error:2}},720:(e,t,r)=>{r.d(t,{$X:()=>p,$l:()=>S,EV:()=>c,FB:()=>i,Kz:()=>B,OB:()=>l,Wf:()=>m,X9:()=>u,YV:()=>f,Yw:()=>a,dV:()=>w,db:()=>b,gB:()=>y,iD:()=>h,kd:()=>o,oD:()=>F,v2:()=>s,wb:()=>d,xS:()=>v,zX:()=>g,zi:()=>x});var n=r(544);const i={Index:16,Vertex:32,Uniform:64,Dynamic:4096,Stream:8192},s={TextureBinding:4,RenderAttachment:16},a={Red:1,Green:2,Blue:4,Alpha:8,All:15},o={D2:n.Bxn,D2Array:n.EPl,CubeMap:n.Ep7,D3:n.Tr1},c={R8:n.R8,R8SNORM:n.sVf,R8UI:n.LrX,R8I:n.q6i,R16UI:n.iVF,R16I:n.xiM,RG8:n.$mf,RG8SNORM:n.wAm,RG8UI:n.coM,RG8I:n.LGL,R32UI:n.If2,R32I:n.$oc,RG16UI:n.ZLz,RG16I:n.qB9,RGBA8:n.hw6,SRGBA8:n.jnw,RGBA8SNORM:n.Mgl,RGBA8UI:n.r5A,RGBA8I:n.Qjo,RGB10A2:n.blh,RG32UI:n.m89,RG32I:n.nR4,RGBA16UI:n.rxK,RGBA16I:n.Msg,RGBA32UI:n.Rkd,RGBA32I:n.gtH,R16F:n.WsI,RG16F:n.MJi,RG11B10F:n.Khk,RGBA16F:n._hT,R32F:n.h2H,RG32F:n.qed,RGBA32F:n.Nug,Depth16:n.kv5,Depth24:n.d_Y,Depth24Stencil8:n.ABS,Depth32F:n.dj5,Depth32FStencil8:n.Vwh},l={ClampToEdge:n.mYe,Repeat:n.aRZ,MirrorRepeat:n.$sD},u={Nearest:n.jX6,Linear:n.t$R},d={Never:n.C4F,Less:n.GPd,Equal:n.gUF,LessEqual:n.DXJ,Greater:n.iFn,NotEqual:n.vkJ,GreaterEqual:n.BzQ,Always:n.Brs},p={Vertex:1,Fragment:2},f={Points:n.Erx,Lines:n.Ukp,LineStrip:n.cgb,Triangles:n.QPP,TriangleStrip:n.b0H},h={UInt16:n.Ae4,UInt32:n.r1O},g={CCW:n.iHR,CW:n.CW},m={None:n.Hnw,Front:n.kpY,Back:n.FoO},v={Keep:n.M$f,Zero:n.xEJ,Replace:n.J57,Invert:n.nl2,Increment:n.RcM,Decrement:n.jgr,IncrementWrap:n.VGh,DecrementWrap:n.C6Q},x={Zero:n.xEJ,One:n.ryP,Src:n.brc,OneMinusSrc:n.i$_,SrcAlpha:n.hy5,OneMinusSrcAlpha:n.OAz,Dst:n.PB6,OneMinusDst:n.miX,DstAlpha:n.TMl,OneMinusDstAlpha:n.njp,SrcAlphaSaturated:n.Rb8,Constant:n.Q0U,OneMinusConstant:n.ldG},b={Add:n.BjA,Subtract:n.Jhs,ReverseSubtract:n.KTj,Min:n.KXm,Max:n.k2X},B={Vertex:0,Instance:1},y={UI8x2:274,UI8x4:276,I8x2:4370,I8x4:4372,UNORM8x2:8466,UNORM8x4:8468,SNORM8x2:12562,SNORM8x4:12564,UI16x2:290,UI16x4:292,I16x2:4386,I16x4:4388,UNORM16x2:8482,UNORM16x4:8484,SNORM16x2:12578,SNORM16x4:12580,F16x2:546,F16x4:548,F32:577,F32x2:578,F32x3:579,F32x4:580},S={Buffer:0,Sampler:1,Texture:2},w={Filtering:0,NonFiltering:1,Comparison:2},F={Float:0,Depth:1,Int:2,UInt:3,UnfilterableFloat:4};n.gq9,n.NRq},232:(e,t,r)=>{r.d(t,{EC:()=>p,IO:()=>f,Ij:()=>a,O5:()=>d,S5:()=>l,Xm:()=>c,bA:()=>u,cj:()=>s});var n=r(544),i=r(720);function s(e){return e===n.Tr1||e===n.EPl}function a(e){return e===n.Ae4?2:4}function o(e){return(e>>4&15)*c(e)}function c(e){return 15&e}function l(e){switch(e>>4&511){case 36:return n.RFu;case 34:return n.s_k;case 274:return n.QoO;case 273:return n.d93;case 18:return n.Ae4;case 17:return n.wgU}return n.Hnw}function u(e){return!!(e>>13)}function d(e){let t=0;const r=[];for(let n=0;n<e.length;++n){const s=[];let a=0;for(let r=0;r<e[n].attributes.length;++r){const i=e[n].attributes[r];s.push({format:i,offset:a,shaderLocation:t}),a+=o(i),++t}r.push({attributes:s,stride:a,stepMode:e[n].instanced?i.Kz.Instance:i.Kz.Vertex})}return r}function p(e){switch(e){case n.kv5:case n.d_Y:case n.ABS:case n.dj5:case n.Vwh:return!0}return!1}function f(e){switch(e){case n.ABS:case n.Vwh:return!0}return!1}},837:(e,t,r)=>{r.d(t,{PM:()=>W,gK:()=>z,ZM:()=>L,uH:()=>V,AF:()=>k,Ow:()=>$,Me:()=>Y,QB:()=>A,wx:()=>_,U3:()=>I,Ko:()=>D,WS:()=>D,EY:()=>D,Fb:()=>X,Dx:()=>E,FL:()=>D,E5:()=>D,hw:()=>D,y9:()=>D,FE:()=>D,ii:()=>K,ci:()=>Z,uq:()=>C,kS:()=>U,Jj:()=>O,IL:()=>Q,GH:()=>M,JE:()=>G,gf:()=>T,BK:()=>H,EX:()=>j,eu:()=>ee,RS:()=>J,z0:()=>N,bo:()=>q});var n=r(720),i=r(940);const s=2097151,a=2**32;function o(e,t){return(t&s)*a+(e>>>0)}function c(e){return e>>>0}class l{generations=[];freeList=[];get size(){return this.generations.length-this.freeList.length}clear(){this.generations.length=0,this.freeList.length=0}create(){let e,t;return this.freeList.length>0?(e=this.freeList.pop(),t=Math.abs(this.generations[e]),this.generations[e]=t):(e=this.generations.length,t=e?0:1,this.generations.push(t)),o(e,t)}delete(e){if(!this.has(e))return!1;const t=c(e);let r=this.generations[t]+1&s;return r||++r,this.generations[t]=-r,this.freeList.push(t),!0}has(e){return c(e)<this.generations.length&&function(e){return e/a&s}(e)===this.generations[c(e)]}forEach(e,t){for(const r of this.values())e.call(t,r,r,this)}*entries(){for(const e of this.values())yield[e,e]}keys(){return this.values()}*values(){for(let e=0;e<this.generations.length;++e){const t=this.generations[e];this.generations[e]>=0&&(yield o(e,t))}}[Symbol.iterator](){return this.values()}get[Symbol.toStringTag](){return l.name}}class u{ids=new l;data=[];get size(){return this.ids.size}add(e){const t=this.ids.create();return this.data[c(t)]=e,t}clear(){this.ids.clear(),this.data.length=0}delete(e){return!!this.ids.delete(e)&&(delete this.data[c(e)],!0)}get(e){return this.ids.has(e)?this.data[c(e)]:void 0}has(e){return this.ids.has(e)}set(e,t){return this.ids.has(e)&&(this.data[c(e)]=t),this}forEach(e,t){this.ids.forEach((r=>{e.call(t,this.data[c(r)],r,this)}))}*entries(){for(const e of this.ids.values())yield[e,this.data[c(e)]]}keys(){return this.ids.values()}*values(){for(const e of this.ids.values())yield this.data[c(e)]}[Symbol.iterator](){return this.entries()}get[Symbol.toStringTag](){return u.name}}const d=new TextDecoder("utf-8");let p=new DataView(new ArrayBuffer(0));function f(e){return p.buffer!==e.buffer&&(p=new DataView(e.buffer)),p}function h(e,t,r){return d.decode(new Uint8Array(e.buffer,t,r))}const g={},m=(new u,new u),v={},x=new u,b={},B={},y=new u,S={},w={};function F(e){return g[e].memory}function P(e){return F(S[e])}function D(e){const t=y.get(e);t&&(t.destroy(),y.delete(e))}function R(e){return w[e]||i}function M(e,t){(g[e]=g[e]||{memory:null}).memory=t}function T(e,t){return v[e]?(m.set(v[e],t),v[e]):v[e]=m.add(t)}function G(e,t,r="canvas",n=i){const s=y.add(t),a=function(e,t){if(x.get(b[t]||0))return b[t];const r=document.getElementById(t);if(!r)return 0;let n=b[t];return n?x.set(n,r):n=x.add(r),B[n]=e,n}(e,r);return S[s]=B[a],w[s]=n,s}function C(e,t,r){const n=h(F(e),t,r);if(v[n])return v[n];const i=document.getElementById(n);return i?v[n]=m.add(i):0}function E(e){m.delete(e)}function O(e){return m.get(e)?.width||0}function U(e){return m.get(e)?.height||0}function X(e){D(e),delete S[e],delete w[e]}function k(e,t,r){const n=R(e).createBuffer(y.get(e),{size:t>>>0,usage:r>>>0});return y.add(n)}function I(e,t,r,n,i,s,a,o,c){const l=R(e).createTexture(y.get(e),{size:[t>>>0,r>>>0,n>>>0],mipLevelCount:i>>>0,sampleCount:s>>>0,dimension:a>>>0,format:o>>>0,usage:c>>>0});return y.add(l)}function A(e,t,r,n,i,s,a,o,c,l,u){const d=R(e).createSampler(y.get(e),{addressModeU:t>>>0,addressModeV:r>>>0,addressModeW:n>>>0,magFilter:i>>>0,minFilter:s>>>0,mipmapFilter:a>>>0,lodMinClamp:o,lodMaxClamp:c,compare:l>>>0,maxAnisotropy:u>>>0});return y.add(d)}function _(e,t,r,n){const i=R(e).createShader(y.get(e),{code:h(P(e),t,r),usage:n>>>0});return y.add(i)}function V(e,t,r){const i=P(e),s=[];for(let e=0;e<r;e++){const r=t+32*e,a=f(i).getUint32(r+0,!0),o=f(i).getUint32(r+4,!0),c=f(i).getUint8(r+16);let l=!1,u=n.dV.Filtering,d=n.oD.Float,p=n.kd.D2,g=!1;switch(c){case n.$l.Buffer:l=!!f(i).getUint8(r+20);break;case n.$l.Sampler:u=f(i).getUint32(r+20,!0)>>>0;break;case n.$l.Texture:d=f(i).getUint32(r+20,!0)>>>0,p=f(i).getUint32(r+24,!0)>>>0,g=!!f(i).getUint8(r+28);break;default:throw new RangeError("invalid variant discriminant for BindingType")}s.push({label:h(i,a,o),binding:f(i).getUint32(r+8,!0)>>>0,visibility:f(i).getUint32(r+12,!0)>>>0,type:c,bufferDynamicOffset:l,samplerType:u,textureSampleType:d,textureDimension:p,textureMultisampled:g})}const a=R(e).createBindGroupLayout(y.get(e),{entries:s});return y.add(a)}function L(e,t,r,i){const s=P(e),a=[];for(let e=0;e<i;e++){const t=r+24*e;let i=null,o=0,c=0,l=null,u=null;switch(f(s).getUint8(t+4)){case n.$l.Buffer:i=y.get(f(s).getFloat64(t+8,!0)),o=f(s).getUint32(t+16,!0),c=f(s).getUint32(t+20,!0);break;case n.$l.Sampler:l=y.get(f(s).getFloat64(t+8,!0));break;case n.$l.Texture:u=y.get(f(s).getFloat64(t+8,!0));break;default:throw new RangeError("invalid variant discriminant for BindingResource")}a.push({binding:f(s).getUint32(t+0,!0),buffer:i,bufferOffset:o,bufferSize:c,sampler:l,texture:u})}const o=R(e).createBindGroup(y.get(e),{layout:y.get(t),entries:a});return y.add(o)}function Y(e,t,r,n,i,s,a,o,c,l,u,d,p,g,m,v,x,b,B,S,w,F,D,M,T,G,C,E,O,U,X,k,I,A,_,V,L,Y,$,q,z,W,N,j,H){const J=P(e),Q=[];for(let e=0;e<i;e++){const t=n+12*e;Q.push({format:f(J).getUint32(t+0,!0),offset:f(J).getUint32(t+4,!0),shaderLocation:f(J).getUint32(t+8,!0)})}const K=[];for(let e=0;e<a;e++){const t=s+16*e,r=f(J).getUint32(t+0,!0),n=f(J).getUint32(t+4,!0);K.push({attributes:Q.slice(r,r+n),stride:f(J).getUint32(t+8,!0),stepMode:f(J).getUint32(t+12,!0)})}const Z=[];for(let e=0;e<c;e++){const t=o+8*e;Z.push(y.get(f(J).getFloat64(t+0,!0)))}const ee=[];for(let e=0;e<A;e++){const t=I+32*e;ee.push({format:f(J).getUint32(t+0,!0)>>>0,writeMask:f(J).getUint32(t+4,!0)>>>0,blendColor:{operation:f(J).getUint32(t+8,!0)>>>0,srcFactor:f(J).getUint32(t+12,!0)>>>0,dstFactor:f(J).getUint32(t+16,!0)>>>0},blendAlpha:{operation:f(J).getUint32(t+20,!0)>>>0,srcFactor:f(J).getUint32(t+24,!0)>>>0,dstFactor:f(J).getUint32(t+28,!0)>>>0}})}const te=h(P(e),W,N),re=h(P(e),j,H),ne=R(e).createRenderPipeline(y.get(e),{vertex:y.get(t),fragment:y.get(r),vertexEntryPoint:te,fragmentEntryPoint:re,buffers:K,bindGroups:Z,primitive:{topology:l>>>0,indexFormat:u>>>0,frontFace:d>>>0,cullMode:p>>>0},multisample:{sampleCount:g>>>0,alphaToCoverage:!!m},depthStencil:v?{format:x>>>0,depthWrite:!!b,depthCompare:B>>>0,stencilFront:{compare:S>>>0,failOp:w>>>0,depthFailOp:F>>>0,passOp:D>>>0},stencilBack:{compare:M>>>0,failOp:T>>>0,depthFailOp:G>>>0,passOp:C>>>0},stencilReadMask:E>>>0,stencilWriteMask:O>>>0,depthBias:U,depthBiasSlopeScale:X,depthBiasClamp:k}:null,targets:{writeMask:_>>>0,blendColor:{operation:V>>>0,srcFactor:L>>>0,dstFactor:Y>>>0},blendAlpha:{operation:$>>>0,srcFactor:q>>>0,dstFactor:z>>>0},targets:ee}});return y.add(ne)}function $(e,t,r,n,i,s,a,o,c,l,u,d,p){const h=P(e);let g;switch(o){case 0:g={clearDepth:t,clearStencil:r,clearColor:isNaN(n)?null:[n,i,s,a]};break;case 1:{const e=[];for(let t=0;t<p;t++){const r=d+32*t,n=[f(h).getFloat32(r+16,!0),f(h).getFloat32(r+20,!0),f(h).getFloat32(r+24,!0),f(h).getFloat32(r+28,!0)];e.push({view:{texture:y.get(f(h).getFloat64(r+0,!0)),mipLevel:f(h).getUint32(r+8,!0),slice:f(h).getUint32(r+12,!0)},clear:isNaN(n[0])?null:n})}g={clearDepth:t,clearStencil:r,colors:e,depthStencil:{texture:y.get(c),mipLevel:l>>>0,slice:u>>>0}};break}default:throw new RangeError("invalid variant discriminant for RenderPassDescriptor")}const m=R(e).createRenderPass(y.get(e),g);return y.add(m)}function q(e,t,r,n,i){R(e).writeBuffer(y.get(e),y.get(t),new Uint8Array(P(e).buffer.slice(r,r+1*n)),i>>>0)}function z(e,t,r,n,i,s,a,o,c,l,u){R(e).copyExternalImageToTexture(y.get(e),{src:m.get(t),origin:[r>>>0,n>>>0]},{texture:y.get(i),mipLevel:s>>>0,origin:[a>>>0,o>>>0,c>>>0]},[l>>>0,u>>>0])}function W(e,t){R(e).beginRenderPass(y.get(e),t&&y.get(t))}function N(e){R(e).submitRenderPass(y.get(e))}function j(e,t){R(e).setRenderPipeline(y.get(e),y.get(t))}function H(e,t){R(e).setIndex(y.get(e),y.get(t))}function J(e,t,r,n){R(e).setVertex(y.get(e),t>>>0,y.get(r),n>>>0)}function Q(e,t,r,n,i){R(e).setBindGroup(y.get(e),t>>>0,y.get(r),new Uint32Array(P(e).buffer.slice(n,n+4*i)))}function K(e,t,r,n,i){R(e).draw(y.get(e),t>>>0,r>>>0,n>>>0,i>>>0)}function Z(e,t,r,n,i){R(e).drawIndexed(y.get(e),t>>>0,r>>>0,n>>>0,i>>>0)}function ee(e,t){R(e).setStencilRef(y.get(e),t>>>0)}},100:(e,t,r)=>{r.r(t),r.d(t,{beginRenderPass:()=>z,copyBuffer:()=>Y,copyExternalImageToTexture:()=>L,copyTexture:()=>$,copyTextureToBuffer:()=>q,createBindGroup:()=>X,createBindGroupLayout:()=>U,createBuffer:()=>M,createRenderPass:()=>k,createRenderPipeline:()=>I,createSampler:()=>E,createShader:()=>O,createSurfaceDepthTexture:()=>C,createSurfaceTexture:()=>G,createTexture:()=>T,draw:()=>Q,drawIndexed:()=>K,flush:()=>R,getDeviceFeatures:()=>P,isDeviceLost:()=>D,readBuffer:()=>A,requestWebGPUDevice:()=>w,resetDevice:()=>F,setBindGroup:()=>J,setBlendConst:()=>te,setIndex:()=>j,setRenderPipeline:()=>N,setScissorRect:()=>ee,setStencilRef:()=>re,setVertex:()=>H,setViewport:()=>Z,submitRenderPass:()=>W,writeBuffer:()=>_,writeTexture:()=>V});var n=r(222),i=r(720),s=r(232);const a={1:"depth32float-stencil8",2:"shader-f16",4:"rg11b10ufloat-renderable",8:"float32-filterable"};function o(e){switch(e){case i.OB.Repeat:return"repeat";case i.OB.MirrorRepeat:return"mirror-repeat";default:return"clamp-to-edge"}}function c(e){return e===i.X9.Linear?"linear":"nearest"}function l(e){switch(e){case i.wb.Equal:return"equal";case i.wb.Greater:return"greater";case i.wb.GreaterEqual:return"greater-equal";case i.wb.Less:return"less";case i.wb.LessEqual:return"less-equal";case i.wb.Never:return"never";case i.wb.NotEqual:return"not-equal";default:return"always"}}function u(e){switch(e){case i.kd.D3:return"3d";case i.kd.CubeMap:return"cube";case i.kd.D2Array:return"2d-array";default:return"2d"}}function d(e){switch(e){case i.EV.R8:return"r8unorm";case i.EV.R8SNORM:return"r8snorm";case i.EV.R8UI:return"r8uint";case i.EV.R8I:return"r8sint";case i.EV.R16UI:return"r16uint";case i.EV.R16I:return"r16sint";case i.EV.RG8:return"rg8unorm";case i.EV.RG8SNORM:return"rg8snorm";case i.EV.RG8UI:return"rg8uint";case i.EV.RG8I:return"rg8sint";case i.EV.R32UI:return"r32uint";case i.EV.R32I:return"r32sint";case i.EV.RG16UI:return"rg16uint";case i.EV.RG16I:return"rg16sint";case i.EV.RGBA8:return"rgba8unorm";case i.EV.SRGBA8:return"rgba8unorm-srgb";case i.EV.RGBA8SNORM:return"rgba8snorm";case i.EV.RGBA8UI:return"rgba8uint";case i.EV.RGBA8I:return"rgba8sint";case i.EV.RGB10A2:return"rgb10a2unorm";case i.EV.RG32UI:return"rg32uint";case i.EV.RG32I:return"rg32sint";case i.EV.RGBA16UI:return"rgba16uint";case i.EV.RGBA16I:return"rgba16sint";case i.EV.R16F:return"r16float";case i.EV.RG16F:return"rg16float";case i.EV.RG11B10F:return"rg11b10ufloat";case i.EV.RGBA16F:return"rgba16float";case i.EV.R32F:return"r32float";case i.EV.RG32F:return"rg32float";case i.EV.RGBA32F:return"rgba32float";case i.EV.Depth16:return"depth16unorm";case i.EV.Depth24:return"depth24plus";case i.EV.Depth24Stencil8:return"depth24plus-stencil8";case i.EV.Depth32F:return"depth32float";case i.EV.Depth32FStencil8:return"depth32float-stencil8";default:return"rgba8unorm"}}function p(e){switch(e){case i.oD.UnfilterableFloat:return"unfilterable-float";case i.oD.Depth:return"depth";case i.oD.UInt:return"uint";case i.oD.Int:return"sint";default:return"float"}}function f(e=0){return(e&i.$X.Fragment?GPUShaderStage.FRAGMENT:0)|(e&i.$X.Vertex?GPUShaderStage.VERTEX:0)}function h(e){switch(e){case i.YV.Points:return"point-list";case i.YV.Lines:return"line-list";case i.YV.LineStrip:return"line-strip";case i.YV.TriangleStrip:return"triangle-strip";default:return"triangle-list"}}function g(e){switch(e){case i.xS.Zero:return"zero";case i.xS.Replace:return"replace";case i.xS.Invert:return"invert";case i.xS.Increment:return"increment-clamp";case i.xS.Decrement:return"decrement-clamp";case i.xS.IncrementWrap:return"increment-wrap";case i.xS.DecrementWrap:return"decrement-wrap";default:return"keep"}}function m(e){return{compare:l(e?.compare),failOp:g(e?.failOp),depthFailOp:g(e?.depthFailOp),passOp:g(e?.passOp)}}function v(e){return{srcFactor:x(e?.srcFactor),dstFactor:x(e?.dstFactor),operation:b(e?.operation)}}function x(e){switch(e){case i.zi.Zero:return"zero";case i.zi.One:return"one";case i.zi.Src:return"src";case i.zi.OneMinusSrc:return"one-minus-src";case i.zi.Dst:return"dst";case i.zi.OneMinusDst:return"one-minus-dst";case i.zi.SrcAlpha:return"src-alpha";case i.zi.OneMinusSrcAlpha:return"one-minus-src-alpha";case i.zi.DstAlpha:return"dst-alpha";case i.zi.OneMinusDstAlpha:return"one-minus-dst-alpha";case i.zi.Constant:return"constant";case i.zi.OneMinusConstant:return"one-minus-constant";case i.zi.SrcAlphaSaturated:return"src-alpha-saturated"}}function b(e){switch(e){case i.db.Subtract:return"subtract";case i.db.ReverseSubtract:return"reverse-subtract";case i.db.Min:return"min";case i.db.Max:return"max";default:return"add"}}function B(e){switch(e){case i.gB.UI8x2:return"uint8x2";case i.gB.UI8x4:return"uint8x4";case i.gB.I8x2:return"sint8x2";case i.gB.I8x4:return"sint8x4";case i.gB.UNORM8x2:return"unorm8x2";case i.gB.UNORM8x4:return"unorm8x4";case i.gB.SNORM8x2:return"snorm8x2";case i.gB.SNORM8x4:return"snorm8x4";case i.gB.UI16x2:return"uint16x2";case i.gB.UI16x4:return"uint16x4";case i.gB.I16x2:return"sint16x2";case i.gB.I16x4:return"sint16x4";case i.gB.UNORM16x2:return"unorm16x2";case i.gB.UNORM16x4:return"unorm16x4";case i.gB.SNORM16x2:return"snorm16x2";case i.gB.SNORM16x4:return"snorm16x4";case i.gB.F16x2:return"float16x2";case i.gB.F16x4:return"float16x4";case i.gB.F32:return"float32";case i.gB.F32x2:return"float32x2";case i.gB.F32x3:return"float32x3";case i.gB.F32x4:return"float32x4"}}function y(e){return{clearValue:e,loadOp:void 0===e?"load":"clear",storeOp:"store"}}function S(e,t=!1){const r=e?.texture;return(t&&r?.msaa||r?.tex)?.createView({dimension:"2d",baseMipLevel:e?.mipLevel,baseArrayLayer:e?.slice,mipLevelCount:1,arrayLayerCount:1})}function w(e,t={},r=0){const i={status:n.Q.Pending,value:null,then:(e,t)=>s.then(e,t)},s=async function(e,t,r){let n=0;const i=[];for(const e in a)r&+e&&(n|=+e,i.push(a[+e]));const s=await((await(navigator.gpu?.requestAdapter(t)))?.requestDevice({requiredFeatures:i})),o=[];if(!s)return null;const c={...t,features:n,canvas:e,device:s,readBuffers:o,get encoder(){return this._encoder||(this._encoder=this.device?.createCommandEncoder())},get surface(){return this._surface||(this._surface=G(this))},get depth(){return this._depth||(this._depth=C(this))},get lost(){return!this.device},reset(){this._encoder=void 0,this.renderPass=void 0},submit(){this._encoder&&this.device?.queue.submit([this._encoder.finish()]),this.reset()},destroy(){(()=>{s.destroy();for(const e of o)e.destroy();o.length=0})(),this.reset()}};return s.lost.then((()=>{c.device=void 0})),c}(e,t,r).then((e=>(i.status=n.Q.Done,e)),(e=>{throw i.status=n.Q.Error,e}));return i}function F(e){e.reset()}function P(e){return e.features}function D(e){return e.lost}function R(e){e.submit()}function M(e,t){const r=GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST|(t.usage&i.FB.Uniform?GPUBufferUsage.UNIFORM:t.usage&i.FB.Index?GPUBufferUsage.INDEX:t.usage&i.FB.Vertex?GPUBufferUsage.VERTEX:0),n=e.device?.createBuffer({usage:r,size:t.size});return{buffer:n,destroy:()=>n?.destroy()}}function T(e,t){const r=t.sampleCount||1,n=t.dimension||i.kd.D2,a=t.format||i.EV.RGBA8,o=t.mipLevelCount,[c,l,p]=t.size||[1,1,1],f=n===i.kd.CubeMap?6:n===i.kd.D2?1:p,h=n===i.kd.CubeMap?6:n===i.kd.D2Array?p:1,g=!(0,s.EC)(a)&&r>1&&!!((t.usage||0)&i.v2.RenderAttachment),m=u(t.dimension),v=d(t.format),x=function(e=0){return GPUTextureUsage.COPY_SRC|GPUTextureUsage.COPY_DST|(e&i.v2.TextureBinding?GPUTextureUsage.TEXTURE_BINDING:0)|(e&i.v2.RenderAttachment?GPUTextureUsage.RENDER_ATTACHMENT:0)}(t.usage),b=e.device?.createTexture({size:[c,l,f],mipLevelCount:o,sampleCount:g?1:r,dimension:(B=t.dimension,B===i.kd.D3?"3d":"2d"),format:v,usage:x});var B;const y=g?e.device?.createTexture({size:[c,l,1],mipLevelCount:1,sampleCount:r,dimension:"2d",format:v,usage:GPUTextureUsage.RENDER_ATTACHMENT}):null;return{tex:b,msaa:y,get view(){return!this._view&&x&GPUTextureUsage.TEXTURE_BINDING&&(this._view=this.tex?.createView({format:v,dimension:m,mipLevelCount:o,arrayLayerCount:h})),this._view},destroy:()=>{b?.destroy(),y?.destroy()}}}function G(e,t,r){const n=e.device,i=t||e.canvas,s=r?.sampleCount||e.sampleCount||1,a=r?.premultipliedAlpha||e.premultipliedAlpha?"premultiplied":"opaque",o=navigator.gpu.getPreferredCanvasFormat(),c=i?.getContext("webgpu");return n&&c?.configure({device:n,format:o,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC|GPUTextureUsage.TEXTURE_BINDING,alphaMode:a}),{get tex(){return c?.getCurrentTexture()},get msaa(){return s>1&&(this._msaa?.width!==i.width||this._msaa.height!==i.height)&&(this._msaa?.destroy(),this._msaa=n?.createTexture({dimension:"2d",size:[i.width,i.height],sampleCount:s,format:o,usage:GPUTextureUsage.RENDER_ATTACHMENT})),this._msaa},get view(){return this.tex?.createView()},destroy(){this._msaa?.destroy()}}}function C(e,t,r){const n=e.device,i=t||e.canvas,a=r?.sampleCount||e.sampleCount||1,o=r?.depthStencilFormat||e.depthStencilFormat,c=o&&(0,s.EC)(o)?d(o):void 0;return{get tex(){return!c||this._tex?.width===i.width&&this._tex.height===i.height||(this._tex?.destroy(),this._tex=n?.createTexture({dimension:"2d",size:[i.width,i.height],sampleCount:a,format:c,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC})),this._tex},get view(){return this.tex?.createView()},destroy(){this._tex?.destroy()}}}function E(e,t={}){return{sampler:e.device?.createSampler({addressModeU:o(t.addressModeU),addressModeV:o(t.addressModeV),addressModeW:o(t.addressModeW),magFilter:c(t.magFilter),minFilter:c(t.minFilter),mipmapFilter:c(t.mipmapFilter),lodMinClamp:t.lodMinClamp,lodMaxClamp:t.lodMaxClamp,compare:t.compare?l(t.compare):void 0,maxAnisotropy:t.maxAnisotropy}),destroy(){}}}function O(e,t){return{shader:e.device?.createShaderModule({code:t.code}),destroy(){}}}function U(e,t){return{layout:e.device?.createBindGroupLayout({entries:t.entries.map(((e,t)=>({binding:e.binding??t,visibility:f(e.visibility||i.$X.Vertex|i.$X.Fragment),buffer:e.type===i.$l.Buffer?{type:"uniform",hasDynamicOffset:e.bufferDynamicOffset,minBindingSize:0}:void 0,sampler:e.type===i.$l.Sampler?{type:e.samplerType===i.dV.Comparison?"comparison":e.samplerType===i.dV.NonFiltering?"non-filtering":"filtering"}:void 0,texture:e.type===i.$l.Texture?{sampleType:p(e.textureSampleType),viewDimension:u(e.textureDimension),multisampled:e.textureMultisampled}:void 0})))}),destroy(){}}}function X(e,t){const r=t.layout.layout;return{group:r&&e.device?.createBindGroup({layout:r,entries:t.entries.map(((e,t)=>{const r=e.sampler?.sampler??e.texture?.view??(e.buffer?.buffer&&{buffer:e.buffer.buffer,offset:e.bufferOffset,size:e.bufferSize});return r&&{binding:e.binding??t,resource:r}})).filter((e=>!!e))}),destroy(){}}}function k(e,t={}){const r=t.colors||[{view:{texture:e.surface},clear:t.clearColor}];let n=t.depthStencil;return!t.colors?.length&&!n&&(n={texture:e.depth}),{colors:r.map((e=>e.view)),colorTargets:r.map((e=>e.view.texture.msaa?e.view:void 0)),colorOps:r.map((e=>y(e.clear))),depth:n,depthOps:y(isNaN(t.clearDepth)?void 0:t.clearDepth),stencilOps:y(isNaN(t.clearStencil)?void 0:t.clearStencil),destroy(){}}}function I(e,t){const r=e.device,n=[];for(const e of t.buffers)for(const t of e.attributes)n.push({format:B(t.format),offset:t.offset,shaderLocation:t.shaderLocation});const s=[];{let e=0;for(const r of t.buffers)s.push({stepMode:r.stepMode===i.Kz.Instance?"instance":"vertex",arrayStride:r.stride,attributes:n.slice(e,e+r.attributes.length)}),e+=r.attributes.length}const a=t.primitive?.indexFormat===i.iD.UInt32?"uint32":"uint16";return{indexFormat:a,pipeline:r?.createRenderPipeline({layout:r.createPipelineLayout({bindGroupLayouts:t.bindGroups?.map((e=>e.layout)).filter((e=>!!e))||[]}),vertex:{module:t.vertex.shader,entryPoint:t.vertexEntryPoint||"vs_main",buffers:s},fragment:{module:t.fragment.shader,entryPoint:t.fragmentEntryPoint||"fs_main",targets:t.targets?.targets?.length?t.targets.targets.map((e=>({format:d(e.format),writeMask:e.writeMask,blend:{color:v(e.blendColor),alpha:v(e.blendAlpha)}}))):[{format:navigator.gpu.getPreferredCanvasFormat(),writeMask:t.targets?.writeMask,blend:{color:v(t.targets?.blendColor),alpha:v(t.targets?.blendAlpha)}}]},primitive:{topology:h(t.primitive?.topology),stripIndexFormat:t.primitive?.topology===i.YV.TriangleStrip||t.primitive?.topology===i.YV.LineStrip?a:void 0,frontFace:t.primitive?.frontFace===i.zX.CW?"cw":"ccw",cullMode:t.primitive?.cullMode===i.Wf.Back?"back":t.primitive?.cullMode===i.Wf.Front?"front":"none"},depthStencil:t.depthStencil?{format:d(t.depthStencil?.format||i.EV.Depth16),depthWriteEnabled:!!t.depthStencil.depthWrite,depthCompare:l(t.depthStencil.depthCompare),stencilFront:m(t.depthStencil.stencilFront),stencilBack:m(t.depthStencil.stencilBack),stencilReadMask:t.depthStencil.stencilReadMask,stencilWriteMask:t.depthStencil.stencilWriteMask,depthBias:t.depthStencil.depthBias,depthBiasSlopeScale:t.depthStencil.depthBiasSlopeScale,depthBiasClamp:t.depthStencil.depthBiasClamp}:void 0,multisample:{count:t.multisample?.sampleCount,alphaToCoverageEnabled:t.multisample?.alphaToCoverage}}),destroy(){}}}function A(e,t,r,i=0){const s=e.device,a=t.buffer,o=(a?.size||0)-i,c=r||new Uint8Array(Math.max(0,o));if(!s||!a||o<=0)return{status:n.Q.Error,value:c,then:(e,t)=>Promise.reject().then(e,t)};let l;{let t;for(t=e.readBuffers.pop();t&&t.size<o;t=e.readBuffers.pop())t.destroy();l=t||s.createBuffer({usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ,size:256*Math.ceil(o/256)})}e.encoder?.copyBufferToBuffer(a,i,l,0,o),R(e);const u={status:n.Q.Pending,value:c,then:(e,t)=>d.then(e,t)},d=s.queue.onSubmittedWorkDone().then((()=>l.mapAsync(GPUMapMode.READ,0,o))).then((()=>(c.set(new Uint8Array(l.getMappedRange())),l.unmap(),e.readBuffers.unshift(l),u.status=n.Q.Done,c)),(e=>{throw u.status=n.Q.Error,e}));return u}function _(e,t,r,n=0){const i=t.buffer;i&&e.device?.queue.writeBuffer(i,n,r)}function V(e,{texture:t,mipLevel:r,origin:[n,i,s]=[0,0,0]},a,{offset:o,bytesPerRow:c,rowsPerImage:l},[u,d,p]=[(t.tex?.width||0)-n,(t.tex?.height||0)-i,(t.tex?.depthOrArrayLayers||0)-s]){const f=t.tex;f&&e.device?.queue.writeTexture({texture:f,mipLevel:r,origin:[n,i,s]},a,{offset:o,bytesPerRow:c,rowsPerImage:l},[u,d,p])}function L(e,{src:t,origin:[r,n]=[0,0]},{texture:i,mipLevel:s=0,origin:[a,o,c]=[0,0,0]},[l,u]=[t.width-r,t.height-n]){const d=i.tex;d&&e.device?.queue.copyExternalImageToTexture({source:t,origin:[r,n]},{texture:d,mipLevel:s,origin:[a,o,c]},[l,u])}function Y(e,t,r,n=t.buffer?.size||0,i=0,s=0){const a=t.buffer,o=r.buffer;a&&o&&e.encoder?.copyBufferToBuffer(a,i,o,s,n)}function $(e,{texture:t,mipLevel:r,origin:[n,i,s]=[0,0,0]},{texture:a,mipLevel:o,origin:[c,l,u]=[0,0,0]},[d,p,f]=[(t.tex?.width||0)-n,(t.tex?.height||0)-i,(t.tex?.depthOrArrayLayers||0)-s]){const h=t.tex,g=a.tex;h&&g&&e.encoder?.copyTextureToTexture({texture:h,mipLevel:r,origin:[n,i,s]},{texture:g,mipLevel:o,origin:[c,l,u]},[d,p,f])}function q(e,{texture:t,mipLevel:r,origin:[n,i,s]=[0,0,0]},a,{offset:o,bytesPerRow:c,rowsPerImage:l},[u,d,p]=[(t.tex?.width||0)-n,(t.tex?.height||0)-i,(t.tex?.depthOrArrayLayers||0)-s]){const f=t.tex,h=a.buffer;f&&h&&e.encoder?.copyTextureToBuffer({texture:f,mipLevel:r,origin:[n,i,s]},{buffer:h,offset:o,bytesPerRow:c,rowsPerImage:l},[u,d,p])}function z(e,t=k(e)){e.submit();const r=e.encoder,n=S(t.depth),i=t.colors,s=t.colorTargets;e.renderPass=r?.beginRenderPass({colorAttachments:i.map(((e,r)=>{const n=S(e,!0);return n?{view:n,resolveTarget:S(s[r]),clearValue:t.colorOps[r].clearValue,loadOp:t.colorOps[r].loadOp,storeOp:t.colorOps[r].storeOp}:null})),depthStencilAttachment:n&&{view:n,depthClearValue:t.depthOps.clearValue,depthLoadOp:t.depthOps.loadOp,depthStoreOp:t.depthOps.storeOp,stencilClearValue:t.stencilOps.clearValue,stencilLoadOp:t.stencilOps.loadOp,stencilStoreOp:t.stencilOps.storeOp}})}function W(e,t=!0){e.renderPass?.end(),e.renderPass=void 0,e.indexFormat=void 0,t&&e.submit()}function N(e,t){const r=t.pipeline;r&&e.renderPass?.setPipeline(r),e.indexFormat=t.indexFormat}function j(e,t){const r=t.buffer;r&&e.renderPass?.setIndexBuffer(r,e.indexFormat||"uint16")}function H(e,t,r,n=0){const i=r.buffer;i&&e.renderPass?.setVertexBuffer(t,i,n)}function J(e,t,r,n=[]){const i=r.group;i&&e.renderPass?.setBindGroup(t,i,n)}function Q(e,t,r=1,n=0,i=0){e.renderPass?.draw(t,r,n,i)}function K(e,t,r=1,n=0,i=0,s=0){e.renderPass?.drawIndexed(t,r,n,s,i)}function Z(e,t,r,n,i,s=0,a=1){e.renderPass?.setViewport(t,r,n,i,s,a)}function ee(e,t,r,n,i){e.renderPass?.setScissorRect(t,r,n,i)}function te(e,t){e.renderPass?.setBlendConstant(t)}function re(e,t){e.renderPass?.setStencilReference(t)}},811:(e,t,r)=>{r.d(t,{PM:()=>n.PM,gK:()=>n.gK,ZM:()=>n.ZM,uH:()=>n.uH,AF:()=>n.AF,Ow:()=>n.Ow,Me:()=>n.Me,QB:()=>n.QB,wx:()=>n.wx,U3:()=>n.U3,Ko:()=>n.Ko,WS:()=>n.WS,EY:()=>n.EY,Fb:()=>n.Fb,Dx:()=>n.Dx,FL:()=>n.FL,E5:()=>n.E5,hw:()=>n.hw,y9:()=>n.y9,FE:()=>n.FE,ii:()=>n.ii,ci:()=>n.ci,uq:()=>n.uq,kS:()=>n.kS,Jj:()=>n.Jj,IL:()=>n.IL,BK:()=>n.BK,EX:()=>n.EX,eu:()=>n.eu,RS:()=>n.RS,z0:()=>n.z0,bo:()=>n.bo});var n=r(837)},132:(e,t,r)=>{r.a(e,(async(n,i)=>{try{var s=r(497),a=r(811),o=n([s]),[s]=o.then?(await o)():o;await r.v(t,e.id,"e0ce69b03fbef7b9cc81",{env:{abort:s.J,seed:s.D},"mugl/wasm":{create_shader:a.wx,create_buffer:a.AF,write_buffer:a.bo,create_render_pipeline:a.Me,create_render_pass:a.Ow,create_bind_group_layout:a.uH,create_bind_group:a.ZM,create_texture:a.U3,create_sampler:a.QB,get_image_by_id:a.uq,copy_external_image_to_texture:a.gK,get_image_width:a.Jj,get_image_height:a.kS,delete_bind_group_layout:a.WS,begin_render_pass:a.PM,set_render_pipeline:a.EX,set_vertex:a.RS,draw:a.ii,submit_render_pass:a.z0,set_index:a.BK,set_bind_group:a.IL,draw_indexed:a.ci,set_stencil_ref:a.eu,delete_render_pipeline:a.E5,delete_bind_group:a.Ko,delete_texture:a.FE,delete_sampler:a.hw,delete_buffer:a.EY,delete_image:a.Dx,delete_device:a.Fb,delete_shader:a.y9,delete_render_pass:a.FL}}),i()}catch(e){i(e)}}),1)}},s={};function a(e){var t=s[e];if(void 0!==t)return t.exports;var r=s[e]={id:e,exports:{}};return i[e](r,r.exports,a),r.exports}e="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",t="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",r="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",n=e=>{e&&!e.d&&(e.d=1,e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},a.a=(i,s,a)=>{var o;a&&((o=[]).d=1);var c,l,u,d=new Set,p=i.exports,f=new Promise(((e,t)=>{u=t,l=e}));f[t]=p,f[e]=e=>(o&&e(o),d.forEach(e),f.catch((e=>{}))),i.exports=f,s((i=>{var s;c=(i=>i.map((i=>{if(null!==i&&"object"==typeof i){if(i[e])return i;if(i.then){var s=[];s.d=0,i.then((e=>{a[t]=e,n(s)}),(e=>{a[r]=e,n(s)}));var a={};return a[e]=e=>e(s),a}}var o={};return o[e]=e=>{},o[t]=i,o})))(i);var a=()=>c.map((e=>{if(e[r])throw e[r];return e[t]})),l=new Promise((t=>{(s=()=>t(a)).r=0;var r=e=>e!==o&&!d.has(e)&&(d.add(e),e&&!e.d&&(s.r++,e.push(s)));c.map((t=>t[e](r)))}));return s.r?l:a()}),(e=>(e?u(f[r]=e):l(p),n(o)))),o&&(o.d=0)},a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.v=(e,t,r,n)=>{var i=fetch(a.p+""+r+".module.wasm");return"function"==typeof WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(i,n).then((t=>Object.assign(e,t.instance.exports))):i.then((e=>e.arrayBuffer())).then((e=>WebAssembly.instantiate(e,n))).then((t=>Object.assign(e,t.instance.exports)))},(()=>{var e;a.g.importScripts&&(e=a.g.location+"");var t=a.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var n=r.length-1;n>-1&&!e;)e=r[n--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=e})(),a(440)})();