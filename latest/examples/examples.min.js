(()=>{var e,t,r,i,n,s,a={903:(e,t,r)=>{r.d(t,{p:()=>ie,B:()=>ne});var i=r(873),n=r(253),s=r(987);const a=(0,s.LI)(s.CJ);class o extends s.r{buffer=null;pipeline=null;constructor(e){super(),this.device=e}init(){const e=s.bl.createShader(this.device,{code:"#version 300 es\nlayout (location=0) in vec3 position;\nlayout (location=1) in vec4 color;\nout vec4 vColor;\nvoid main () {\n  gl_Position = vec4(position, 1);\n  vColor = color;\n}\n",usage:i.$X.Vertex}),t=s.bl.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nin vec4 vColor;\nout vec4 outColor;\nvoid main () {\n  outColor = vColor;\n}\n",usage:i.$X.Fragment});this.buffer=(0,s.gS)(this.device,a),this.pipeline=s.bl.createRenderPipeline(this.device,{vertex:e,fragment:t,buffers:(0,n.O5)([{attributes:[i.gB.F32x3,i.gB.F32x4]}])}),this.register([this.buffer,this.pipeline,e,t])}render(e){return s.bl.beginDefaultPass(this.device,{clearColor:[.1,.2,.3,1]}),s.bl.setRenderPipeline(this.device,this.pipeline),s.bl.setVertex(this.device,0,this.buffer),s.bl.draw(this.device,3),s.bl.submitRenderPass(this.device),!1}}const l=(0,s.MA)([0,1,2]),c=(0,s.om)([0,-.05,-.05,0,.05,.05]),u=new Float32Array(500),d=new Float32Array(100);for(let e=0;e<100;e++){d[e]=Math.random()*(2*Math.PI),u[5*e]=2*Math.floor(e/10)/10-1+.1,u[5*e+1]=e%10*2/10-1+.1;const t=Math.floor(e/10)/10,r=e%10/10,i=t*r+.2;u[5*e+2]=t,u[5*e+3]=r,u[5*e+4]=i}class f extends s.r{pipeline=null;indexBuffer=null;position=null;offsetColor=null;angle=null;bindGroup=null;ambient=null;ambientData=new Float32Array(4);t=0;constructor(e){super(),this.device=e}init(){const e=s.bl.createShader(this.device,{code:"#version 300 es\nlayout (location=0) in vec2 position;\nlayout (location=1) in vec2 offset;\nlayout (location=2) in vec3 color;\nlayout (location=3) in float angle;\nout vec3 vColor;\nvoid main() {\n  gl_Position = vec4(\n    cos(angle) * position.x + sin(angle) * position.y + offset.x,\n    -sin(angle) * position.x + cos(angle) * position.y + offset.y,\n    0, 1);\n  vColor = color;\n}\n",usage:i.$X.Vertex}),t=s.bl.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nlayout(std140) uniform Data {\n  vec3 ambient;\n};\nin vec3 vColor;\nout vec4 outColor;\nvoid main () {\n  outColor = vec4(ambient + vColor, 1.0);\n}\n",usage:i.$X.Fragment});this.indexBuffer=(0,s.gS)(this.device,l,i.FB.Index),this.position=(0,s.gS)(this.device,c),this.offsetColor=(0,s.gS)(this.device,u),this.angle=(0,s.gS)(this.device,d,i.FB.Vertex|i.FB.Stream),this.ambient=(0,s.gS)(this.device,this.ambientData,i.FB.Uniform|i.FB.Stream);const r=s.bl.createBindGroupLayout(this.device,{entries:[{label:"Data",type:i.$l.Buffer}]});this.bindGroup=s.bl.createBindGroup(this.device,{layout:r,entries:[{buffer:this.ambient}]}),this.pipeline=s.bl.createRenderPipeline(this.device,{vertex:e,fragment:t,buffers:(0,n.O5)([{attributes:[i.gB.F32x2]},{attributes:[i.gB.F32x2,i.gB.F32x3],instanced:!0},{attributes:[i.gB.F32],instanced:!0}]),bindGroups:[r]}),this.register([this.bindGroup,this.indexBuffer,this.position,this.offsetColor,this.angle,this.pipeline,e,t,r])}render(e){for(let t=0;t<100;t++)d[t]+=this.t-e-2*Math.PI*Math.floor(d[t]/Math.PI/2);this.t=e,s.bl.writeBuffer(this.device,this.angle,d);const t=Math.sin(e)/2;return this.ambientData[0]=this.ambientData[1]=this.ambientData[2]=t,s.bl.writeBuffer(this.device,this.ambient,this.ambientData),s.bl.beginDefaultPass(this.device,{clearColor:[0,0,0,1]}),s.bl.setRenderPipeline(this.device,this.pipeline),s.bl.setIndex(this.device,this.indexBuffer),s.bl.setVertex(this.device,0,this.position),s.bl.setVertex(this.device,1,this.offsetColor),s.bl.setVertex(this.device,2,this.angle),s.bl.setBindGroup(this.device,0,this.bindGroup),s.bl.drawIndexed(this.device,3,100),s.bl.submitRenderPass(this.device),!0}}function h(e,t,r=0,i=0,n=e.length-r){for(let s=0;s<n;++s)t[i+s]=e[r+s];return t}function p(e,t,r,i,n){for(let s=0;s<n;++s)t[i+s]=e[r+s];return t}function g(e=0,t=0,r=0,i=0){return[e,t,r,i]}function b(e=0,t=0,r=0){return[e,t,r]}function v(e,t){return function(e,t){let r=0;for(let i=0;i<e.length;++i)r+=e[i]*t[i];return r}(e,t)}function m(e,t=b()){return function(e,t,r){for(let i=0;i<e.length;++i)r[i]=e[i]*t;return r}(e,1/(function(e){return Math.sqrt(v(e,e))}(e)||1),t)}function x(e,t,r=b()){const i=e[2]*t[0]-t[2]*e[0],n=e[0]*t[1]-t[0]*e[1];return r[0]=e[1]*t[2]-t[1]*e[2],r[1]=i,r[2]=n,r}g(),b(),g(),g();const B=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function y(e){for(let t=0;t<16;++t)e[t]=t%5?0:1;return e}function S(e,t,r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]){return h(function(e,t,r,i){const n=t.length/4,s=r.length/4;let a=0;for(let e=0;e<s;++e)for(let s=0;s<n;++s){a=0;for(let i=0;i<4;++i)a+=t[i*n+s]*r[4*e+i];i[e*n+s]=a}return i}(0,e,t,B),r)}const w=b(),F=b(),D=b();function P(e,t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]){return y(t),t[0]=e[0],t[5]=e[1],t[10]=e[2],t}function k(e,t,r,i=1/0,n=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]){const s=1/Math.tan(t/2);if(y(n),n[0]=s/e,n[5]=s,n[11]=-1,n[15]=0,isFinite(i)){const e=1/(r-i);n[10]=(r+i)*e,n[14]=2*r*i*e}else n[10]=-1,n[14]=-2*r;return n}function M(e,t=b(),r=b(0,1,0),i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]){const n=function(e,t,r=b()){return function(e,t,r){for(let i=0;i<e.length;++i)r[i]=e[i]-t[i];return r}(e,t,r)}(t,e,w);m(n,n);const s=x(n,r,F);m(s,s);const a=x(s,n,D);return m(a,a),i[0]=s[0],i[1]=a[0],i[2]=-n[0],i[4]=s[1],i[5]=a[1],i[6]=-n[1],i[8]=s[2],i[9]=a[2],i[10]=-n[2],i[12]=-v(s,e),i[13]=-v(a,e),i[14]=v(n,e),i[3]=i[7]=i[11]=0,i[15]=1,i}const R=512,C=(0,s.LI)({positions:s.Xv.positions,uvs:s.Xv.uvs}),G=(0,s.iy)(s.Xv),T=(0,s.LI)(s.lD);class I extends s.r{offscreenPass=null;vertBuffer=null;indexBuffer=null;quadVertBuffer=null;cubeDataBuffer=null;cubePipeline=null;quadPipeline=null;colorTex=null;uvTex=null;positionTex=null;depthTex=null;offscreenTexSampler=null;offscreenTexBindGroup=null;cubeBindGroup=null;cubeData=new Float32Array(40);constructor(e){super(),this.device=e}init(){const e=s.bl.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nlayout(std140) uniform Data {\n  mat4 model, vp;\n  vec3 color;\n};\nlayout(location = 0) in vec3 position;\nlayout(location = 1) in vec2 uv;\nout vec3 vPosition;\nout vec2 vUv;\nvoid main(void) {\n  vec4 worldPos = model * vec4(position, 1.0);\n  vPosition = worldPos.xyz;\n  vUv = uv;\n  gl_Position = vp * worldPos;\n}",usage:i.$X.Vertex}),t=s.bl.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nlayout(std140) uniform Data {\n  mat4 model;\n  mat4 vp;\n  vec3 color;\n};\nin vec3 vPosition;\nin vec2 vUv;\nlayout(location = 0) out vec4 out0;\nlayout(location = 1) out vec4 out1;\nlayout(location = 2) out vec4 out2;\nvoid main(void) {\n  out0 = vec4(color, 1.0);\n  out1 = vec4(vUv, 0.0, 0.0);\n  out2 = vec4(vPosition, 0.0);\n}",usage:i.$X.Fragment}),r=s.bl.createShader(this.device,{code:"#version 300 es\nlayout (location=0) in vec3 position;\nlayout (location=1) in vec2 uv;\nout vec2 vUv;\nvoid main(void) {\n  gl_Position = vec4(position, 1.0);\n  vUv = uv;\n}\n",usage:i.$X.Vertex}),a=s.bl.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nuniform sampler2D tex0, tex1, tex2;\nin vec2 vUv;\nout vec4 outColor;\nvoid main(void) {\n  vec4 colorSum =\n    texture(tex0, vUv * 2.0 - vec2(0.0, 1.0)) * step(0.5, 1.0 - vUv.x) * step(0.5, vUv.y) +\n    texture(tex1, vUv * 2.0 - vec2(0.0, 0.0)) * step(0.5, 1.0 - vUv.x) * step(0.5, 1.0 - vUv.y) +\n    texture(tex2, vUv * 2.0 - vec2(1.0, 1.0)) * step(0.5, vUv.x) * step(0.5, vUv.y);\n    outColor = vec4(colorSum.rgb, 1.0);\n}\n",usage:i.$X.Fragment}),o=s.bl.createBindGroupLayout(this.device,{entries:[{label:"Data",type:i.$l.Buffer}]});this.vertBuffer=(0,s.gS)(this.device,C),this.indexBuffer=(0,s.gS)(this.device,G,i.FB.Index),this.cubeDataBuffer=(0,s.gS)(this.device,this.cubeData,i.FB.Uniform|i.FB.Stream),this.cubeBindGroup=s.bl.createBindGroup(this.device,{layout:o,entries:[{buffer:this.cubeDataBuffer}]}),this.cubePipeline=s.bl.createRenderPipeline(this.device,{vertex:e,fragment:t,buffers:(0,n.O5)([{attributes:[i.gB.F32x3,i.gB.F32x2]}]),bindGroups:[o],depthStencil:{depthCompare:i.wb.LessEqual,depthWrite:!0},primitive:{cullMode:i.Wf.Back}});const l=s.bl.createBindGroupLayout(this.device,{entries:[{binding:0,label:"tex0",type:i.$l.Texture},{binding:1,label:"tex0",type:i.$l.Sampler},{binding:2,label:"tex1",type:i.$l.Texture},{binding:3,label:"tex1",type:i.$l.Sampler},{binding:4,label:"tex2",type:i.$l.Texture},{binding:5,label:"tex2",type:i.$l.Sampler}]});this.quadVertBuffer=(0,s.gS)(this.device,T),this.colorTex=s.bl.createTexture(this.device,{size:[R,R,1],sampleCount:4}),this.uvTex=s.bl.createTexture(this.device,{size:[R,R,1],sampleCount:4}),this.positionTex=s.bl.createTexture(this.device,{size:[R,R,1],sampleCount:4}),this.offscreenTexSampler=s.bl.createSampler(this.device,{magFilter:i.X9.Linear,minFilter:i.X9.Linear}),this.offscreenTexBindGroup=s.bl.createBindGroup(this.device,{layout:l,entries:[{binding:0,texture:this.colorTex},{binding:1,sampler:this.offscreenTexSampler},{binding:2,texture:this.uvTex},{binding:3,sampler:this.offscreenTexSampler},{binding:4,texture:this.positionTex},{binding:5,sampler:this.offscreenTexSampler}]}),this.quadPipeline=s.bl.createRenderPipeline(this.device,{vertex:r,fragment:a,bindGroups:[l],buffers:(0,n.O5)([{attributes:[i.gB.F32x3,i.gB.F32x2]}])}),this.depthTex=s.bl.createTexture(this.device,{format:i.EV.Depth16,size:[R,R,1],usage:i.v2.RenderAttachment,sampleCount:4}),this.offscreenPass=s.bl.createRenderPass(this.device,{colors:[{view:{texture:this.colorTex},clear:[.1,.2,.3,1]},{view:{texture:this.uvTex},clear:[.3,.1,.2,1]},{view:{texture:this.positionTex},clear:[.1,.3,.2,1]}],depthStencil:{texture:this.depthTex},clearDepth:1}),this.register([this.offscreenPass,this.cubePipeline,this.vertBuffer,this.indexBuffer,this.cubeDataBuffer,this.cubeBindGroup,this.quadPipeline,this.quadVertBuffer,this.offscreenTexBindGroup,this.colorTex,this.uvTex,this.positionTex,this.depthTex,this.offscreenTexSampler,t,e,a,r,o,l])}render(e){{const t=b(.5,.5,.5),r=S(k(this.width/this.height,Math.PI/4,.01,100),M(function(e,t,r=b()){return function(e,t,r){for(let i=0;i<e.length;++i)r[i]=e[i]+t[i];return r}(e,t,r)}([5*Math.cos(e),2.5*Math.sin(e),5*Math.sin(e)],t),t));let i=function(e,t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]){return y(t),h(e,t,0,12,3),t}(t);i=S(i,P([.5,.5,.5]),i),p(i,this.cubeData,0,0,16),p(r,this.cubeData,0,16,16),p([1,1,1],this.cubeData,0,32,3),s.bl.writeBuffer(this.device,this.cubeDataBuffer,this.cubeData)}return s.bl.beginRenderPass(this.device,this.offscreenPass),s.bl.setRenderPipeline(this.device,this.cubePipeline),s.bl.setIndex(this.device,this.indexBuffer),s.bl.setVertex(this.device,0,this.vertBuffer),s.bl.setBindGroup(this.device,0,this.cubeBindGroup),s.bl.drawIndexed(this.device,G.length),s.bl.submitRenderPass(this.device),s.bl.beginDefaultPass(this.device,{clearColor:[0,0,0,1],clearDepth:1}),s.bl.setRenderPipeline(this.device,this.quadPipeline),s.bl.setVertex(this.device,0,this.quadVertBuffer),s.bl.setBindGroup(this.device,0,this.offscreenTexBindGroup),s.bl.draw(this.device,6),s.bl.submitRenderPass(this.device),!0}}var _=r(657);const A=s.c4,U=(0,s.LI)({positions:s.Xv.positions,normals:s.Xv.normals,uvs:s.Xv.uvs}),L=(0,s.iy)(s.Xv);class E extends s.r{vertBuffer=null;indexBuffer=null;matBuffer=null;envBuffer=null;cubeDataBuffer=null;skyDataBuffer=null;cubePipeline=null;cubeTex=null;skyPipeline=null;skyTex=null;sampler=null;envBindGroup=null;cubeTexBindGroup=null;cubeDataBindGroup=null;skyTexBindGroup=null;skyDataBindGroup=null;cubeData=new Float32Array(36);skyData=new Float32Array(36);constructor(e){super(),this.device=e}init(){const e=(0,s.Kz)("airplane"),t=(0,s.Kz)("sky0"),r=(0,s.Kz)("sky1"),a=(0,s.Kz)("sky2"),o=s.bl.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nlayout(std140) uniform Data {\n  mat4 model, viewProj;\n  vec4 camPos;\n};\nlayout (location=0) in vec3 position;\nlayout (location=1) in vec2 uv;\nlayout (location=2) in vec3 normal;\nout vec3 vPosition;\nout vec2 vUv;\nout vec3 vNormal;\n\nvoid main(void) {\n  vec4 worldPos = model * vec4(position, 1.0);\n  vPosition = worldPos.xyz / worldPos.w;\n  vNormal = mat3(model) * normalize(normal);\n  vUv = uv;\n  gl_Position = viewProj * worldPos;\n}\n",usage:i.$X.Vertex}),l=s.bl.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nuniform sampler2D tex;\nlayout(std140) uniform Data {\n  mat4 model, viewProj;\n  vec4 camPos;\n};\nlayout(std140) uniform Material {\n  vec4 albedo;\n  vec2 metallicRoughness;\n};\nlayout(std140) uniform Env {\n  vec4 ambient;\n  vec4 lightDir;\n  vec4 lightColor;\n};\n\nin vec3 vPosition;\nin vec2 vUv;\nin vec3 vNormal;\nout vec4 color;\n\nconst float PI = 3.14159265359;\n\nvec3 toSrgb(vec3 color) {\n  return pow(color, vec3(1.0/2.2));\n}\n\nvec4 toLinear(vec4 srgbIn) {\n  return vec4(pow(srgbIn.rgb, vec3(2.2)), srgbIn.a);\n}\n\nvec3 diffuse(vec3 color) {\n  return color / PI;\n}\n\nfloat specularD(float aSqr, float nDotH) {\n  float f = (nDotH * nDotH) * (aSqr - 1.0) + 1.0;\n  return aSqr / (PI * f * f);\n}\n\nvec3 specularF(vec3 r0, vec3 r90, float vDotH) {\n  return r0 + (r90 - r0) * pow(clamp(1.0 - vDotH, 0.0, 1.0), 5.0);\n}\n\nfloat specularG(float aSqr, float nDotL, float nDotV) {\n  float gl = 2.0 * nDotL / (nDotL + sqrt(aSqr + (1.0 - aSqr) * (nDotL * nDotL)));\n  float gv = 2.0 * nDotV / (nDotV + sqrt(aSqr + (1.0 - aSqr) * (nDotV * nDotV)));\n  return gl * gv;\n}\n\nvoid main () {\n  vec3 n = normalize(vNormal);\n  vec3 v = normalize(camPos.xyz - vPosition);\n  vec3 l = normalize(-lightDir.xyz);\n  vec3 h = normalize(l + v);\n\n  float nDotL = clamp(dot(n, l), 0.001, 1.0);\n  float nDotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n  float nDotH = clamp(dot(n, h), 0.0, 1.0);\n  float vDotH = clamp(dot(v, h), 0.0, 1.0);\n\n  vec4 baseColor = toLinear(texture(tex, vUv)) * albedo;\n\n  vec3 f0 = vec3(0.04);\n  vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0) * (1.0 - metallicRoughness.x);\n  vec3 specularColor = mix(f0, baseColor.rgb, metallicRoughness.x);\n\n  float r0 = max(max(specularColor.r, specularColor.g), specularColor.b);\n  float r90 = clamp(r0 * 25.0, 0.0, 1.0);\n  vec3 specularEnvR0 = specularColor.rgb;\n  vec3 specularEnvR90 = vec3(1.0, 1.0, 1.0) * r90;\n\n  float a = clamp(metallicRoughness.y, 0.04, 1.0);\n  a *= a;\n  float aSqr = a * a;\n\n  vec3 color0 = vec3(0.0);\n\n  vec3 F = specularF(specularEnvR0, specularEnvR90, vDotH);\n  float D = specularD(aSqr, nDotH);\n  float G = specularG(aSqr, nDotL, nDotV);\n\n  vec3 diffuse = (1.0 - F) * diffuse(diffuseColor);\n  vec3 specular = F * G * D / (4.0 * nDotL * nDotV);\n\n  color0 += nDotL * lightColor.rgb * lightColor.a * (diffuse + specular);\n  color0 += ambient.rgb * diffuseColor;\n\n  color = vec4(toSrgb(color0), baseColor.a);\n}",usage:i.$X.Fragment}),c=s.bl.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nuniform samplerCube tex;\nin vec3 vPosition;\nout vec4 color;\nvoid main () {\n  color = texture(tex, normalize(vPosition));\n}",usage:i.$X.Fragment});this.matBuffer=(0,s.gS)(this.device,(0,s.om)([1,1,1,1,.5,.5,0,0]),i.FB.Uniform),this.envBuffer=(0,s.gS)(this.device,(0,s.om)([223/255*.75,246/255*.75,245/255*.75,1,1,-2,1,0,252/255,203/255,203/255,5]),i.FB.Uniform),this.vertBuffer=(0,s.gS)(this.device,U),this.indexBuffer=(0,s.gS)(this.device,L,i.FB.Index),this.cubeDataBuffer=(0,s.gS)(this.device,this.cubeData,i.FB.Uniform|i.FB.Stream),this.skyDataBuffer=(0,s.gS)(this.device,this.skyData,i.FB.Uniform|i.FB.Stream);const u=s.bl.createBindGroupLayout(this.device,{entries:[{binding:0,label:"tex",type:i.$l.Texture},{binding:1,label:"tex",type:i.$l.Sampler}]}),d=s.bl.createBindGroupLayout(this.device,{entries:[{binding:0,label:"Material",type:i.$l.Buffer},{binding:1,label:"Env",type:i.$l.Buffer}]}),f=s.bl.createBindGroupLayout(this.device,{entries:[{label:"Data",type:i.$l.Buffer}]});this.cubeTex=s.bl.createTexture(this.device,{size:[A,A,1]}),e&&(s.bl.copyExternalImageToTexture(this.device,{src:e},{texture:this.cubeTex}),_.generateMipmap(this.device,this.cubeTex)),this.sampler=s.bl.createSampler(this.device,{magFilter:i.X9.Linear,minFilter:i.X9.Linear,mipmapFilter:i.X9.Linear,maxAnisotropy:16}),this.cubeTexBindGroup=s.bl.createBindGroup(this.device,{layout:u,entries:[{binding:0,texture:this.cubeTex},{binding:1,sampler:this.sampler}]}),this.envBindGroup=s.bl.createBindGroup(this.device,{layout:d,entries:[{binding:0,buffer:this.matBuffer},{binding:1,buffer:this.envBuffer}]}),this.cubeDataBindGroup=s.bl.createBindGroup(this.device,{layout:f,entries:[{buffer:this.cubeDataBuffer}]});const h={vertex:o,fragment:l,buffers:(0,n.O5)([{attributes:[i.gB.F32x3,i.gB.F32x2,i.gB.F32x3]}]),bindGroups:[u,d,f],depthStencil:{depthWrite:!0,depthCompare:i.wb.LessEqual},primitive:{cullMode:i.Wf.Back}};if(this.cubePipeline=s.bl.createRenderPipeline(this.device,h),this.skyTex=s.bl.createTexture(this.device,{dimension:i.kd.CubeMap,size:[A,A,1]}),t&&r&&a){const e=[t,t,r,a,t,t];for(let t=0;t<6;++t)s.bl.copyExternalImageToTexture(this.device,{src:e[t]},{texture:this.skyTex,origin:[0,0,t]});_.generateMipmap(this.device,this.skyTex)}this.skyTexBindGroup=s.bl.createBindGroup(this.device,{layout:u,entries:[{binding:0,texture:this.skyTex},{binding:1,sampler:this.sampler}]}),this.skyDataBindGroup=s.bl.createBindGroup(this.device,{layout:f,entries:[{buffer:this.skyDataBuffer}]}),this.skyPipeline=s.bl.createRenderPipeline(this.device,{vertex:o,fragment:c,buffers:h.buffers,bindGroups:[u,f],depthStencil:h.depthStencil,primitive:{cullMode:i.Wf.Front}}),this.register([this.vertBuffer,this.indexBuffer,this.matBuffer,this.envBuffer,this.cubeDataBuffer,this.skyDataBuffer,this.cubePipeline,this.cubeTex,this.skyPipeline,this.skyTex,this.sampler,this.envBindGroup,this.cubeDataBindGroup,this.cubeTexBindGroup,this.skyDataBindGroup,this.skyTexBindGroup,o,l,c,u,d,f])}render(e){{const t=b(10*Math.cos(e),5*Math.sin(e),10*Math.sin(e)),r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],i=S(k(this.width/this.height,Math.PI/4,.01,100),M(t,[0,0,0]));p(r,this.cubeData,0,0,16),p(i,this.cubeData,0,16,16),p(t,this.cubeData,0,32,3),s.bl.writeBuffer(this.device,this.cubeDataBuffer,this.cubeData),p(P([10,10,10]),this.skyData,0,0,16),p(i,this.skyData,0,16,16),p(t,this.skyData,0,32,3),s.bl.writeBuffer(this.device,this.skyDataBuffer,this.skyData)}return s.bl.beginDefaultPass(this.device,{clearColor:[0,0,0,1],clearDepth:1}),s.bl.setRenderPipeline(this.device,this.cubePipeline),s.bl.setIndex(this.device,this.indexBuffer),s.bl.setVertex(this.device,0,this.vertBuffer),s.bl.setBindGroup(this.device,0,this.cubeTexBindGroup),s.bl.setBindGroup(this.device,1,this.envBindGroup),s.bl.setBindGroup(this.device,2,this.cubeDataBindGroup),s.bl.drawIndexed(this.device,L.length),s.bl.setRenderPipeline(this.device,this.skyPipeline),s.bl.setIndex(this.device,this.indexBuffer),s.bl.setVertex(this.device,0,this.vertBuffer),s.bl.setBindGroup(this.device,0,this.skyTexBindGroup),s.bl.setBindGroup(this.device,1,this.skyDataBindGroup),s.bl.drawIndexed(this.device,L.length),s.bl.submitRenderPass(this.device),!0}}const O=512,$=[[-1,-1,-1,0,-1,8,-1,0,-1,-1,-1,0,0,0,0,0],[-2,-1,0,0,-1,1,1,0,0,1,2,0,0,0,0,0],[0,-1,0,0,-1,4,-1,0,0,-1,0,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0]],X=(0,s.LI)({positions:s.Xv.positions,colors:s.Xv.colors}),V=(0,s.iy)(s.Xv),j=(0,s.LI)(s.lD);class q extends s.r{offscreenPass=null;vertBuffer=null;indexBuffer=null;quadVertBuffer=null;cubeDataBuffer=null;kernelDataBuffer=null;cubePipeline=null;quadPipeline=null;offscreenTex=null;offscreenTexSampler=null;depthTex=null;offscreenTexBindGroup=null;cubeBindGroup=null;kernelBindGroup=null;cubeData=new Float32Array(16);kernelData=new Float32Array(20);constructor(e){super(),this.device=e}init(){const e=s.bl.createShader(this.device,{code:"#version 300 es\nlayout(std140) uniform Data {\n  mat4 mvp;\n};\nlayout (location=0) in vec4 position;\nlayout (location=1) in vec4 color;\nout vec4 vColor;\nvoid main(void) {\n  gl_Position = mvp * position;\n  vColor = color;\n}",usage:i.$X.Vertex}),t=s.bl.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nin vec4 vColor;\nout vec4 outColor;\nvoid main(void) {\n  outColor = vColor;\n}",usage:i.$X.Fragment}),r=s.bl.createShader(this.device,{code:"#version 300 es\nlayout (location=0) in vec4 position;\nlayout (location=1) in vec2 uv;\nout vec2 vUv;\nvoid main(void) {\n  gl_Position = position;\n  vUv = uv;\n}",usage:i.$X.Vertex}),a=s.bl.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nuniform sampler2D tex;\nlayout(std140) uniform Data {\n  mat4 kernel;\n  vec2 texSize;\n  float kernelWeight;\n};\nin vec2 vUv;\nout vec4 outColor;\nvoid main(void) {\n  vec2 onePixel = vec2(1.0, 1.0) / texSize;\n  vec4 colorSum =\n    texture(tex, vUv + onePixel * vec2(-1, -1)) * kernel[0][0] +\n    texture(tex, vUv + onePixel * vec2( 0, -1)) * kernel[0][1] +\n    texture(tex, vUv + onePixel * vec2( 1, -1)) * kernel[0][2] +\n    texture(tex, vUv + onePixel * vec2(-1,  0)) * kernel[1][0] +\n    texture(tex, vUv + onePixel * vec2( 0,  0)) * kernel[1][1] +\n    texture(tex, vUv + onePixel * vec2( 1,  0)) * kernel[1][2] +\n    texture(tex, vUv + onePixel * vec2(-1,  1)) * kernel[2][0] +\n    texture(tex, vUv + onePixel * vec2( 0,  1)) * kernel[2][1] +\n    texture(tex, vUv + onePixel * vec2( 1,  1)) * kernel[2][2] ;\n    outColor = vec4((colorSum / kernelWeight).rgb, 1);\n}",usage:i.$X.Fragment}),o=s.bl.createBindGroupLayout(this.device,{entries:[{label:"Data",type:i.$l.Buffer}]});this.vertBuffer=(0,s.gS)(this.device,X),this.indexBuffer=(0,s.gS)(this.device,V,i.FB.Index),this.cubeDataBuffer=(0,s.gS)(this.device,this.cubeData,i.FB.Uniform|i.FB.Stream),this.cubeBindGroup=s.bl.createBindGroup(this.device,{layout:o,entries:[{buffer:this.cubeDataBuffer}]}),this.cubePipeline=s.bl.createRenderPipeline(this.device,{vertex:e,fragment:t,buffers:(0,n.O5)([{attributes:[i.gB.F32x3,i.gB.F32x4]}]),bindGroups:[o],depthStencil:{depthCompare:i.wb.LessEqual,depthWrite:!0},primitive:{cullMode:i.Wf.Back}});const l=s.bl.createBindGroupLayout(this.device,{entries:[{binding:0,label:"tex",type:i.$l.Texture},{binding:1,label:"tex",type:i.$l.Sampler}]});this.quadVertBuffer=(0,s.gS)(this.device,j),this.kernelDataBuffer=(0,s.gS)(this.device,this.kernelData,i.FB.Uniform|i.FB.Stream),this.offscreenTex=s.bl.createTexture(this.device,{size:[O,O,1],sampleCount:1}),this.offscreenTexSampler=s.bl.createSampler(this.device,{magFilter:i.X9.Linear,minFilter:i.X9.Linear}),this.offscreenTexBindGroup=s.bl.createBindGroup(this.device,{layout:l,entries:[{binding:0,texture:this.offscreenTex},{binding:1,sampler:this.offscreenTexSampler}]}),this.kernelBindGroup=s.bl.createBindGroup(this.device,{layout:o,entries:[{buffer:this.kernelDataBuffer}]}),this.quadPipeline=s.bl.createRenderPipeline(this.device,{vertex:r,fragment:a,bindGroups:[l,o],buffers:(0,n.O5)([{attributes:[i.gB.F32x3,i.gB.F32x2]}])}),this.depthTex=s.bl.createTexture(this.device,{format:i.EV.Depth16,size:[O,O,1],usage:i.v2.RenderAttachment,sampleCount:1}),this.offscreenPass=s.bl.createRenderPass(this.device,{colors:[{view:{texture:this.offscreenTex},clear:[.25,.25,.25,1]}],depthStencil:{texture:this.depthTex},clearDepth:1}),this.register([this.cubePipeline,this.vertBuffer,this.indexBuffer,this.cubeDataBuffer,this.kernelDataBuffer,this.quadPipeline,this.quadVertBuffer,this.offscreenTex,this.offscreenTexSampler,this.depthTex,this.offscreenPass,this.cubeBindGroup,this.offscreenTexBindGroup,this.kernelBindGroup,t,e,a,r,l,o])}render(e){p(S(k(this.width/this.height,Math.PI/4,.01,100),M([10*Math.cos(e),5*Math.sin(e),10*Math.sin(e)],[0,0,0])),this.cubeData,0,0,16),s.bl.writeBuffer(this.device,this.cubeDataBuffer,this.cubeData);{const t=$[Math.floor(e/2)%$.length];let r=0;for(let e=0;e<t.length;++e)r+=t[e];r=r<=0?1:r,p(t,this.kernelData,0,0,16),this.kernelData[16]=O,this.kernelData[17]=O,this.kernelData[18]=r,s.bl.writeBuffer(this.device,this.kernelDataBuffer,this.kernelData)}return s.bl.beginRenderPass(this.device,this.offscreenPass),s.bl.setRenderPipeline(this.device,this.cubePipeline),s.bl.setIndex(this.device,this.indexBuffer),s.bl.setVertex(this.device,0,this.vertBuffer),s.bl.setBindGroup(this.device,0,this.cubeBindGroup),s.bl.drawIndexed(this.device,V.length),s.bl.submitRenderPass(this.device),s.bl.beginDefaultPass(this.device,{clearColor:[0,0,0,1],clearDepth:1}),s.bl.setRenderPipeline(this.device,this.quadPipeline),s.bl.setVertex(this.device,0,this.quadVertBuffer),s.bl.setBindGroup(this.device,0,this.offscreenTexBindGroup),s.bl.setBindGroup(this.device,1,this.kernelBindGroup),s.bl.draw(this.device,6),s.bl.submitRenderPass(this.device),!0}}const z=(0,s.LI)({positions:s.Xv.positions,uvs:s.Xv.uvs}),W=(0,s.iy)(s.Xv),N=W.length,H=new Uint16Array(2*N);for(let e=0;e<N;++e)H[e]=W[e];for(let e=0;e<N;e+=3)H[N+e]=W[e+2],H[N+e+1]=W[e+1],H[N+e+2]=W[e];const K=s.c4;class Q extends s.r{vertBuffer=null;indexBuffer=null;data=new Float32Array(192);dataBuffer=null;texture=null;sampler=null;cubePipeline=null;cubeOutlinePipeline=null;textureBindGroup=null;dataBindGroup=null;constructor(e){super(),this.device=e}init(){const e=s.bl.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nlayout(std140) uniform Data {\n  mat4 mvp;\n  vec4 outline;\n};\nlayout (location=0) in vec3 position;\nlayout (location=1) in vec2 uv;\nout vec2 vUv;\nvoid main(void) {\n  vUv = uv;\n  gl_Position = mvp * vec4(position, 1.0);\n}\n",usage:i.$X.Vertex}),t=s.bl.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nin vec2 vUv;\nout vec4 outColor;\nuniform sampler2D tex;\nvoid main () {\n  outColor = texture(tex, vUv);\n}\n",usage:i.$X.Fragment}),r=s.bl.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nlayout(std140) uniform Data {\n  mat4 mvp;\n  vec4 outline;\n};\nout vec4 outColor;\nvoid main () {\n  outColor = outline;\n}\n",usage:i.$X.Fragment});this.vertBuffer=(0,s.gS)(this.device,z),this.indexBuffer=(0,s.gS)(this.device,H,i.FB.Index),this.dataBuffer=(0,s.gS)(this.device,this.data,i.FB.Uniform|i.FB.Stream),this.texture=s.bl.createTexture(this.device,{size:[K,K,1]});const a=(0,s.Kz)("airplane");a&&s.bl.copyExternalImageToTexture(this.device,{src:a},{texture:this.texture}),this.sampler=s.bl.createSampler(this.device,{});const o=s.bl.createBindGroupLayout(this.device,{entries:[{binding:0,label:"tex",type:i.$l.Texture},{binding:1,label:"tex",type:i.$l.Sampler}]}),l=s.bl.createBindGroupLayout(this.device,{entries:[{label:"Data",type:i.$l.Buffer,bufferDynamicOffset:!0}]});this.textureBindGroup=s.bl.createBindGroup(this.device,{layout:o,entries:[{binding:0,texture:this.texture},{binding:1,sampler:this.sampler}]}),this.dataBindGroup=s.bl.createBindGroup(this.device,{layout:l,entries:[{buffer:this.dataBuffer,bufferSize:256}]});const c={vertex:e,fragment:t,buffers:(0,n.O5)([{attributes:[i.gB.F32x3,i.gB.F32x2]}]),bindGroups:[o,l],depthStencil:{depthWrite:!0,depthCompare:i.wb.LessEqual,stencilBack:{compare:i.wb.Always,passOp:i.xS.Replace},stencilFront:{compare:i.wb.Always,passOp:i.xS.Replace}},primitive:{cullMode:i.Wf.Back}};this.cubePipeline=s.bl.createRenderPipeline(this.device,c),this.cubeOutlinePipeline=s.bl.createRenderPipeline(this.device,{vertex:e,fragment:r,buffers:c.buffers,bindGroups:[l],depthStencil:{depthWrite:!0,stencilBack:{compare:i.wb.NotEqual},stencilFront:{compare:i.wb.NotEqual},stencilWriteMask:0},primitive:c.primitive}),this.register([this.vertBuffer,this.indexBuffer,this.dataBuffer,this.texture,this.sampler,this.textureBindGroup,this.dataBindGroup,this.cubePipeline,this.cubeOutlinePipeline,e,t,r,o,l])}render(e){{const t=S(k(this.width/this.height,Math.PI/4,.01,100),M([10*Math.cos(e),5*Math.sin(e),10*Math.sin(e)],[0,0,0]));let r=t;p(r,this.data,0,0,16),r=S(t,P([1.1,1.1,1.1])),p(r,this.data,0,64,16),p([.1,.3,.2,1],this.data,0,80,4),r=S(t,P([10,10,10])),p(r,this.data,0,128,16)}return s.bl.writeBuffer(this.device,this.dataBuffer,this.data),s.bl.beginDefaultPass(this.device,{clearDepth:1,clearStencil:0}),s.bl.setRenderPipeline(this.device,this.cubePipeline),s.bl.setIndex(this.device,this.indexBuffer),s.bl.setVertex(this.device,0,this.vertBuffer),s.bl.setBindGroup(this.device,0,this.textureBindGroup),s.bl.setBindGroup(this.device,1,this.dataBindGroup,[0]),s.bl.setStencilRef(this.device,1),s.bl.drawIndexed(this.device,N),s.bl.setBindGroup(this.device,1,this.dataBindGroup,[512]),s.bl.setStencilRef(this.device,0),s.bl.drawIndexed(this.device,N,1,N),s.bl.setRenderPipeline(this.device,this.cubeOutlinePipeline),s.bl.setIndex(this.device,this.indexBuffer),s.bl.setVertex(this.device,0,this.vertBuffer),s.bl.setBindGroup(this.device,0,this.dataBindGroup,[256]),s.bl.setStencilRef(this.device,1),s.bl.drawIndexed(this.device,N),s.bl.submitRenderPass(this.device),!0}}const Y=s.c4,J=[];for(let e=0;e<s.Xv.uvs.length;++e){const t=s.Xv.uvs[e];J.push([2*t[0],2*t[1]])}const Z=(0,s.LI)({positions:s.Xv.positions,uvs:J}),ee=(0,s.iy)(s.Xv);class te{cameraData=new Float32Array(16);constructor(e,t,r,n,a,o){this.device=e,this.vertexBuffer=n,this.indexBuffer=a,this.indexCount=o;const l=s.bl.createBindGroupLayout(e,{entries:[{label:"tex",type:i.$l.Texture,binding:0},{label:"tex",type:i.$l.Sampler,binding:1}]}),c=s.bl.createBindGroupLayout(e,{entries:[{label:"Camera",type:i.$l.Buffer}]});t.bindGroups=[l,c],this.pipeline=s.bl.createRenderPipeline(e,t),this.texture=s.bl.createTexture(e,{dimension:r,size:[Y,Y,1]}),this.sampler=s.bl.createSampler(e,{magFilter:i.X9.Linear,minFilter:i.X9.Linear,mipmapFilter:i.X9.Linear,addressModeU:i.OB.Repeat,addressModeV:i.OB.Repeat,maxAnisotropy:16}),this.cameraBuffer=(0,s.gS)(e,this.cameraData,i.FB.Uniform|i.FB.Stream),this.textureBindGroup=s.bl.createBindGroup(e,{layout:l,entries:[{binding:0,texture:this.texture},{binding:1,sampler:this.sampler}]}),this.cameraBindGroup=s.bl.createBindGroup(e,{layout:c,entries:[{buffer:this.cameraBuffer}]}),l.destroy(),c.destroy()}updateCamera(e){p(e,this.cameraData,0,0,16),s.bl.writeBuffer(this.device,this.cameraBuffer,this.cameraData)}render(e){s.bl.setRenderPipeline(e,this.pipeline),s.bl.setIndex(e,this.indexBuffer),s.bl.setVertex(e,0,this.vertexBuffer),s.bl.setBindGroup(e,0,this.textureBindGroup),s.bl.setBindGroup(e,1,this.cameraBindGroup),s.bl.drawIndexed(e,this.indexCount)}destroy(){this.pipeline.destroy(),this.textureBindGroup.destroy(),this.cameraBindGroup.destroy(),this.texture.destroy(),this.sampler.destroy(),this.cameraBuffer.destroy()}}class re extends s.r{vertBuffer=null;indexBuffer=null;cube=null;skybox=null;constructor(e){super(),this.device=e}init(){const e=(0,s.Kz)("airplane"),t=(0,s.Kz)("sky0"),r=(0,s.Kz)("sky1"),a=(0,s.Kz)("sky2"),o=s.bl.createShader(this.device,{code:"#version 300 es\nlayout(std140) uniform Camera {\n  mat4 mvp;\n};\nlayout (location=0) in vec3 position;\nlayout (location=1) in vec2 uv;\nout vec2 vUv;\nout vec3 vNormal;\nvoid main(void) {\n  vUv = uv;\n  vNormal = normalize(position);\n  gl_Position = mvp * vec4(position, 1.0);\n}\n",usage:i.$X.Vertex}),l=s.bl.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nuniform sampler2D tex;\nin vec2 vUv;\nout vec4 outColor;\nvoid main () {\n  outColor = texture(tex, vUv);\n}\n",usage:i.$X.Fragment}),c=s.bl.createShader(this.device,{code:"#version 300 es\nprecision mediump float;\nuniform samplerCube tex;\nin vec3 vNormal;\nout vec4 outColor;\nvoid main () {\n  outColor = texture(tex, normalize(vNormal));\n}\n",usage:i.$X.Fragment});this.vertBuffer=(0,s.gS)(this.device,Z),this.indexBuffer=(0,s.gS)(this.device,ee,i.FB.Index);const u={vertex:o,fragment:l,buffers:(0,n.O5)([{attributes:[i.gB.F32x3,i.gB.F32x2]}]),depthStencil:{depthWrite:!0,depthCompare:i.wb.LessEqual},primitive:{cullMode:i.Wf.Back}};this.cube=new te(this.device,u,i.kd.D2,this.vertBuffer,this.indexBuffer,ee.length),e&&(s.bl.copyExternalImageToTexture(this.device,{src:e},{texture:this.cube.texture}),_.generateMipmap(this.device,this.cube.texture));const d={vertex:o,fragment:c,buffers:u.buffers,depthStencil:u.depthStencil,primitive:{cullMode:i.Wf.Front}};if(this.skybox=new te(this.device,d,i.kd.CubeMap,this.vertBuffer,this.indexBuffer,ee.length),t&&r&&a){const e=[t,t,r,a,t,t];for(let t=0;t<6;++t)s.bl.copyExternalImageToTexture(this.device,{src:e[t]},{texture:this.skybox.texture,origin:[0,0,t]});_.generateMipmap(this.device,this.skybox.texture)}this.register([this.vertBuffer,this.indexBuffer,o,l,c])}render(e){const t=S(k(this.width/this.height,Math.PI/4,.01,100),M([10*Math.cos(e),5*Math.sin(e),10*Math.sin(e)],[0,0,0]));let r=t;return this.cube.updateCamera(r),r=S(t,P([10,10,10]),t),this.skybox.updateCamera(r),s.bl.beginDefaultPass(this.device,{clearColor:[.1,.2,.3,1],clearDepth:1}),this.cube.render(this.device),this.skybox.render(this.device),s.bl.submitRenderPass(this.device),!0}destroy(){super.destroy(),this.cube.destroy(),this.skybox.destroy()}}class ie{constructor(e,t,r){this.id=e,this.title=t,this.factory=r}}const ne=[new ie("basic","Hello World",(e=>new o(e))),new ie("instancing","Buffers & Instancing",(e=>new f(e))),new ie("texture","Texture & Sampler",(e=>new re(e))),new ie("stencil","Depth Stencil",(e=>new Q(e))),new ie("postprocess","Post-processing",(e=>new q(e))),new ie("mrt","Multi Render Targets",(e=>new I(e))),new ie("pbr","Physically Based Rendering",(e=>new E(e)))]},987:(e,t,r)=>{r.d(t,{bl:()=>i,db:()=>o,r:()=>a,Xv:()=>h,Go:()=>s,lD:()=>f,c4:()=>l,CJ:()=>d,gS:()=>g,om:()=>b,MA:()=>v,Kz:()=>n,iy:()=>u,LI:()=>c});var i=r(657);function n(e){return document.getElementById(e)}class s{init(){}render(e){return!1}resize(e,t){}destroy(){}}class a extends s{resources=[];width=1;height=1;resize(e,t){this.width=e,this.height=t}destroy(){for(let e=0;e<this.resources.length;++e)this.resources[e].destroy();this.resources.length=0}register(e){for(let t=0;t<e.length;++t)this.resources.push(e[t])}}const o=1337,l=512;function c(e){const t=e.positions,r=e.uvs,i=e.normals,n=e.colors;let s=0,a=0;t&&(a=t.length,s+=3),r&&(s+=2),i&&(s+=3),n&&(s+=4);const o=new Float32Array(s*a);for(let e=0;e<a;++e){let a=0;t&&(o[e*s+a++]=t[e][0],o[e*s+a++]=t[e][1],o[e*s+a++]=t[e][2]),r&&(o[e*s+a++]=r[e][0],o[e*s+a++]=r[e][1]),i&&(o[e*s+a++]=i[e][0],o[e*s+a++]=i[e][1],o[e*s+a++]=i[e][2]),n&&(o[e*s+a++]=n[e][0],o[e*s+a++]=n[e][1],o[e*s+a++]=n[e][2],o[e*s+a++]=n[e][3])}return o}function u(e){const t=e.indices;if(!t)return new Uint16Array(0);const r=new Uint16Array(3*t.length);for(let e=0;e<t.length;++e)r[3*e]=t[e][0],r[3*e+1]=t[e][1],r[3*e+2]=t[e][2];return r}const d={positions:[[0,.5,0],[.5,-.5,0],[-.5,-.5,0]],colors:[[1,0,0,1],[0,1,0,1],[0,0,1,1]]},f={positions:[[-1,-1,1],[1,-1,1],[1,1,1],[-1,-1,1],[1,1,1],[-1,1,1]],uvs:[[0,0],[1,0],[1,1],[0,0],[1,1],[0,1]]},h={indices:[[2,1,0],[2,0,3],[6,5,4],[6,4,7],[10,9,8],[10,8,11],[14,13,12],[14,12,15],[18,17,16],[18,16,19],[20,21,22],[23,20,22]],positions:[[-1,1,1],[1,1,1],[1,-1,1],[-1,-1,1],[1,1,-1],[-1,1,-1],[-1,-1,-1],[1,-1,-1],[1,1,1],[1,1,-1],[1,-1,-1],[1,-1,1],[-1,1,-1],[-1,1,1],[-1,-1,1],[-1,-1,-1],[-1,1,-1],[1,1,-1],[1,1,1],[-1,1,1],[-1,-1,-1],[1,-1,-1],[1,-1,1],[-1,-1,1]],uvs:[[0,0],[1,0],[1,1],[0,1],[0,0],[1,0],[1,1],[0,1],[0,0],[1,0],[1,1],[0,1],[0,0],[1,0],[1,1],[0,1],[0,0],[1,0],[1,1],[0,1],[0,0],[1,0],[1,1],[0,1]],normals:[[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,-1],[0,0,-1],[0,0,-1],[0,0,-1],[1,0,0],[1,0,0],[1,0,0],[1,0,0],[-1,0,0],[-1,0,0],[-1,0,0],[-1,0,0],[0,1,0],[0,1,0],[0,1,0],[0,1,0],[0,-1,0],[0,-1,0],[0,-1,0],[0,-1,0]],colors:[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[0,1,0,1],[0,1,0,1],[0,1,0,1],[0,1,0,1],[0,0,1,1],[0,0,1,1],[0,0,1,1],[0,0,1,1],[1,1,0,1],[1,1,0,1],[1,1,0,1],[1,1,0,1],[0,1,1,1],[0,1,1,1],[0,1,1,1],[0,1,1,1],[1,0,1,1],[1,0,1,1],[1,0,1,1],[1,0,1,1]]};var p=r(873);function g(e,t,r=p.FB.Vertex){const n=i.createBuffer(e,{usage:r,size:t.byteLength});return i.writeBuffer(e,n,t),n}function b(e){const t=new Float32Array(e.length);for(let r=0;r<e.length;++r)t[r]=e[r];return t}function v(e){const t=new Uint16Array(e.length);for(let r=0;r<e.length;++r)t[r]=e[r];return t}},947:(e,t,r)=>{r.d(t,{lL:()=>s});var i=r(987);function n(e){const t=new Image;return e.canvas.toBlob((e=>t.src=URL.createObjectURL(e))),t}function s(e=i.c4){const t=document.createElement("div");return t.style.display="none",document.body.appendChild(t),new Promise(((r,i)=>{let s=1;const a=()=>{--s<=0&&r()},o=function(e){const t=new Image;return t.crossOrigin="anonymous",t.src="./airplane.png",t}();o.id="airplane",o.onload=a,o.onerror=i,t.appendChild(o);const l=function(e){const t=document.createElement("canvas");t.width=t.height=e;const r=t.getContext("2d"),i="#28ccdf",s="#39314b",a=r.createLinearGradient(0,0,0,e);a.addColorStop(0,i),a.addColorStop(.4,"#8aebf1"),a.addColorStop(.99,"#dff6f5"),a.addColorStop(1,s),r.fillStyle=i,r.fillRect(0,0,e,e);const o=n(r);r.fillStyle=s,r.fillRect(0,0,e,e);const l=n(r);return r.fillStyle=a,r.fillRect(0,0,e,e),[n(r),o,l]}(e);s+=l.length;for(let e=0;e<l.length;++e)l[e].id=`sky${e}`,l[e].onload=a,l[e].onerror=i,t.appendChild(l[e])}))}},439:(e,t,r)=>{r.a(e,(async(e,t)=>{try{var i=r(657),n=r(568),s=r(987),a=r(903),o=r(947),l=r(438),c=e([l]);l=(c.then?(await c)():c)[0];class f extends s.Go{constructor(e){super(),this.uri=e}render(){return window.location.replace(this.uri),!1}}let h=!1;const p=await(0,l.Y)();class g extends s.Go{wasmModule=null;constructor(e){super(),this.id=e}init(){p.init(this.id)}render(e){return p.render(e)}resize(e,t){p.resize(e,t)}destroy(){p.destroy()}}function u(e,t,r){return t=>h?new g(e):r(t)}const b={};for(let F=0;F<a.B.length;++F)b[a.B[F].id]=new a.p(a.B[F].id,a.B[F].title,u(F,a.B[F].id,a.B[F].factory));b.gltf=new a.p("gltf","glTF Model Viewer 🔗",(()=>new f("./gltf.html"))),b.docs=new a.p("docs","API Documentation 🔗",(()=>new f("../docs")));const v=document.getElementById("menu");for(const D in b){const P=document.createElement("li"),k=document.createElement("a");k.id=b[D].id,k.href=`#${b[D].id}`,k.innerText=b[D].title,P.appendChild(k),v.appendChild(P)}const m=document.querySelector("canvas"),x=window.devicePixelRatio||1;if(x>1){const{width:M,height:R}=m;m.width=M*x,m.height=R*x,m.style.width=`${M}px`,m.style.height=`${R}px`}const B=i.requestWebGL2Device(m,{stencil:!0,powerPreference:"low-power"},n.N.TextureAnisotropic|n.N.TextureHalfFloatLinear|n.N.TextureFloatLinear|n.N.ColorBufferFloat);let y,S=0;function d(e=0){S=requestAnimationFrame(d),y.render(e/1e3)||cancelAnimationFrame(S)}window.loadExample=function(e=location.hash){const t=b[e.replace("#","")];t&&(document.getElementById("title").innerText=t.title,document.getElementById("code").href=`https://github.com/andykswong/mugl/tree/main/examples/src/apps/${t.id}.ts`,cancelAnimationFrame(S),y&&(y.destroy(),i.resetDevice(B)),y=t.factory(B),y.init(),y.resize(m.width,m.height),d())};const w=(0,o.lL)();location.hash=location.hash||"#basic",document.getElementById("mode")?.addEventListener("click",(e=>{h=e.target.checked,window.loadExample()})),w.then((()=>{window.loadExample()})),t()}catch(C){t(C)}}),1)},474:(e,t,r)=>{r.a(e,(async(e,i)=>{try{r.d(t,{D:()=>o,J:()=>a});var n=r(132),s=e([n]);function a(){}n=(s.then?(await s)():s)[0];const o=Date.now;i()}catch(l){i(l)}}))},438:(e,t,r)=>{r.a(e,(async(e,i)=>{try{r.d(t,{Y:()=>l});var n=r(795),s=r(132),a=r(987),o=e([s]);async function l(){return(0,n.GH)(a.db,s.memory),{init:s.init,render:s.render,resize:s.resize,destroy:s.destroy}}s=(o.then?(await o)():o)[0],i()}catch(c){i(c)}}))},624:(e,t,r)=>{r.d(t,{i:()=>i});const i=!0},249:(e,t,r)=>{r.d(t,{$Hb:()=>Ze,$X9:()=>Re,$mf:()=>jt,$oc:()=>Jt,$sD:()=>Ee,AAP:()=>st,ABS:()=>Ut,Ae4:()=>J,BIZ:()=>Xt,BjA:()=>S,Brs:()=>pe,Bxn:()=>Te,BzQ:()=>he,C4F:()=>oe,C6Q:()=>ye,CW:()=>X,Cip:()=>br,DXJ:()=>ue,DuX:()=>_,EP2:()=>fr,EPl:()=>yt,EZf:()=>_t,Ec0:()=>ze,Elr:()=>L,Ep7:()=>Ie,Erx:()=>a,F_0:()=>R,FoO:()=>I,GNc:()=>He,GPd:()=>le,HI8:()=>ae,HiH:()=>ut,Hnw:()=>Ne,If2:()=>Zt,J51:()=>ot,J57:()=>be,Jhs:()=>w,JpA:()=>wt,KTj:()=>F,KXm:()=>dt,Khk:()=>St,LGL:()=>er,LOg:()=>pt,LRx:()=>De,LrX:()=>Kt,M$f:()=>ge,MBW:()=>C,MJi:()=>Wt,MfQ:()=>dr,Mgl:()=>lr,Mh0:()=>re,Msg:()=>Mt,NRq:()=>N,Nug:()=>xt,OAz:()=>b,Oxh:()=>Pe,PB6:()=>x,Q0U:()=>D,QPP:()=>c,Qjo:()=>Rt,QoO:()=>Y,R8:()=>Vt,RFu:()=>te,RG:()=>$t,Rb8:()=>y,RcM:()=>ve,Rkd:()=>Ft,SE0:()=>Gt,Sr6:()=>Ke,TMl:()=>v,TU:()=>We,T_I:()=>j,Tr1:()=>at,U02:()=>Ye,U0z:()=>je,Ukp:()=>o,VGh:()=>Be,VKS:()=>Ae,VS8:()=>ne,Vwh:()=>It,WsI:()=>qt,Xeo:()=>Me,XjA:()=>pr,YMo:()=>se,Z$E:()=>qe,ZLz:()=>ir,_Hr:()=>s,_fi:()=>_e,_hT:()=>Bt,_j0:()=>Ve,aRZ:()=>Ue,b0H:()=>u,bBe:()=>Z,bW:()=>$e,blh:()=>it,brc:()=>h,cJA:()=>bt,cMJ:()=>gr,cXR:()=>M,cgb:()=>l,coM:()=>tr,d8P:()=>q,d93:()=>K,d_Y:()=>ht,dj5:()=>Tt,eXq:()=>ie,ecp:()=>n,fRZ:()=>$,fa2:()=>lt,fjQ:()=>Oe,fqf:()=>mt,gUF:()=>ce,gYZ:()=>O,gq9:()=>W,gtH:()=>kt,h2H:()=>zt,hMC:()=>tt,hw6:()=>rt,hy5:()=>g,i$_:()=>p,iFn:()=>de,iHR:()=>V,iRB:()=>hr,iVF:()=>Yt,iXE:()=>Et,i_:()=>ur,jX6:()=>Se,jgr:()=>me,jnw:()=>vt,jpO:()=>H,k2X:()=>ft,k5F:()=>Je,kdr:()=>G,kpY:()=>T,kv5:()=>Xe,ldG:()=>P,m89:()=>sr,mLJ:()=>At,mYe:()=>Le,miX:()=>B,mku:()=>nt,n4e:()=>Ce,nR4:()=>nr,nT3:()=>U,nbD:()=>Ge,njp:()=>m,nl2:()=>xe,pge:()=>ct,q0S:()=>ke,q6i:()=>Ht,qB9:()=>rr,qOY:()=>k,qed:()=>Nt,r$7:()=>et,r1O:()=>ee,r5A:()=>Pt,rxK:()=>Dt,ryP:()=>f,sVf:()=>ar,s_k:()=>Ot,t$R:()=>we,u$q:()=>Qe,u99:()=>cr,uvM:()=>A,vPF:()=>Ct,vkJ:()=>fe,w0M:()=>gt,wAm:()=>or,wFH:()=>Fe,wdg:()=>z,wgU:()=>Q,xEJ:()=>d,xWx:()=>Lt,xiM:()=>Qt,yN1:()=>E,yXb:()=>i});const i=256,n=1024,s=16384,a=0,o=1,l=3,c=4,u=5,d=0,f=1,h=768,p=769,g=770,b=771,v=772,m=773,x=774,B=775,y=776,S=32774,w=32778,F=32779,D=32769,P=32770,k=34962,M=34963,R=35040,C=35044,G=35048,T=1028,I=1029,_=2884,A=3042,U=2960,L=2929,E=3089,O=32823,$=32926,X=2304,V=2305,j=3317,q=3333,z=4352,W=4353,N=4354,H=33170,K=5120,Q=5121,Y=5122,J=5123,Z=5124,ee=5125,te=5126,re=6402,ie=6407,ne=6408,se=35632,ae=35633,oe=512,le=513,ce=514,ue=515,de=516,fe=517,he=518,pe=519,ge=7680,be=7681,ve=7682,me=7683,xe=5386,Be=34055,ye=34056,Se=9728,we=9729,Fe=9984,De=9985,Pe=9986,ke=9987,Me=10240,Re=10241,Ce=10242,Ge=10243,Te=3553,Ie=34067,_e=34069,Ae=33984,Ue=10497,Le=33071,Ee=33648,Oe=36160,$e=36161,Xe=33189,Ve=36168,je=34041,qe=36064,ze=36096,We=33306,Ne=0,He=3314,Ke=3315,Qe=3316,Ye=3330,Je=3331,Ze=3332,et=6144,tt=6403,rt=32856,it=32857,nt=32877,st=32878,at=32879,ot=32882,lt=33640,ct=33082,ut=33083,dt=32775,ft=32776,ht=33190,pt=34892,gt=34893,bt=35051,vt=35907,mt=34894,xt=34836,Bt=34842,yt=35866,St=35898,wt=35899,Ft=36208,Dt=36214,Pt=36220,kt=36226,Mt=36232,Rt=36238,Ct=36244,Gt=36249,Tt=36012,It=36013,_t=36269,At=34042,Ut=35056,Lt=36008,Et=36009,Ot=5131,$t=33319,Xt=33320,Vt=33321,jt=33323,qt=33325,zt=33326,Wt=33327,Nt=33328,Ht=33329,Kt=33330,Qt=33331,Yt=33332,Jt=33333,Zt=33334,er=33335,tr=33336,rr=33337,ir=33338,nr=33339,sr=33340,ar=36756,or=36757,lr=36759,cr=36662,ur=36663,dr=35345,fr=4294967295,hr=37147,pr=37149,gr=34046,br=34047},253:(e,t,r)=>{r.d(t,{EC:()=>f,IO:()=>h,Ij:()=>a,O5:()=>d,S5:()=>c,Vg:()=>g,Xm:()=>l,bA:()=>u,cX:()=>b,cj:()=>s,jk:()=>p,xN:()=>v});var i=r(249),n=r(873);function s(e){return e===i.Tr1||e===i.EPl}function a(e){return e===i.Ae4?2:4}function o(e){return(e>>4&15)*l(e)}function l(e){return 15&e}function c(e){switch(e>>4&511){case 36:return i.RFu;case 34:return i.s_k;case 274:return i.QoO;case 273:return i.d93;case 18:return i.Ae4;case 17:return i.wgU}return i.Hnw}function u(e){return!!(e>>13)}function d(e){let t=0;const r=[];for(let i=0;i<e.length;++i){const s=[];let a=0;for(let r=0;r<e[i].attributes.length;++r){const n=e[i].attributes[r];s.push({format:n,offset:a,shaderLocation:t}),a+=o(n),++t}r.push({attributes:s,stride:a,stepMode:e[i].instanced?n.Kz.Instance:n.Kz.Vertex})}return r}function f(e){switch(e){case i.kv5:case i.d_Y:case i.ABS:case i.dj5:case i.Vwh:return!0}return!1}function h(e){switch(e){case i._j0:case i.ABS:case i.Vwh:return!0}return!1}function p(e){switch(e){case i.R8:case i.sVf:case i.WsI:case i.h2H:return i.hMC;case i.LrX:case i.q6i:case i.iVF:case i.xiM:case i.If2:case i.$oc:return i.vPF;case i.$mf:case i.wAm:case i.MJi:case i.qed:return i.RG;case i.coM:case i.LGL:case i.ZLz:case i.qB9:case i.m89:case i.nR4:return i.BIZ;case i.hw6:case i.jnw:case i.Mgl:case i.blh:case i._hT:case i.Nug:return i.VS8;case i.r5A:case i.Qjo:case i.rxK:case i.Rkd:case i.Msg:case i.gtH:return i.SE0;case i.Khk:return i.eXq;case i.kv5:case i.d_Y:case i.dj5:return i.Mh0;case i.ABS:case i.Vwh:return i.U0z}return i.Hnw}function g(e){switch(e){case i.R8:case i.LrX:case i.sVf:case i.q6i:return 1;case i.iVF:case i.xiM:case i.$mf:case i.coM:case i.wAm:case i.LGL:case i.WsI:return 2;case i.If2:case i.$oc:case i.h2H:case i.ZLz:case i.qB9:case i.MJi:case i.hw6:case i.jnw:case i.r5A:case i.Mgl:case i.Qjo:case i.blh:case i.Khk:return 4;case i.m89:case i.nR4:case i.qed:case i.rxK:case i.Msg:case i._hT:return 8;case i.Rkd:case i.gtH:case i.Nug:return 16;case i.kv5:return 2;case i.d_Y:case i.ABS:case i.dj5:return 4;case i.Vwh:return 8}return 0}function b(e){switch(e){case i.R8:case i.LrX:case i.$mf:case i.coM:case i.hw6:case i.jnw:case i.r5A:return i.wgU;case i.sVf:case i.q6i:case i.wAm:case i.LGL:case i.Mgl:case i.Qjo:return i.d93;case i.iVF:case i.ZLz:case i.rxK:return i.Ae4;case i.xiM:case i.qB9:case i.Msg:return i.QoO;case i.If2:case i.m89:case i.Rkd:return i.r1O;case i.$oc:case i.nR4:case i.gtH:return i.bBe;case i.blh:return i.fa2;case i.WsI:case i.MJi:case i._hT:return i.s_k;case i.h2H:case i.qed:case i.Nug:return i.RFu;case i.Khk:return i.JpA;case i.kv5:return i.Ae4;case i.d_Y:return i.r1O;case i.ABS:return i.mLJ;case i.dj5:return i.RFu;case i.Vwh:return i.EZf}return i.Hnw}function v(e){switch(e){case i.q6i:case i.xiM:case i.$oc:case i.LGL:case i.qB9:case i.nR4:case i.Qjo:case i.Msg:case i.gtH:return i.bBe;case i.LrX:case i.iVF:case i.If2:case i.coM:case i.ZLz:case i.m89:case i.r5A:case i.rxK:case i.Rkd:return i.r1O}return i.RFu}},568:(e,t,r)=>{r.d(t,{N:()=>i,T:()=>n});const i={TextureAnisotropic:1,TextureHalfFloatLinear:2,TextureFloatLinear:4,ColorBufferFloat:8},n={1:"EXT_texture_filter_anisotropic",2:"OES_texture_half_float_linear",4:"OES_texture_float_linear",8:"EXT_color_buffer_float"}},657:(e,t,r)=>{r.r(t),r.d(t,{beginDefaultPass:()=>I,beginRenderPass:()=>T,copyBuffer:()=>P,copyExternalImageToTexture:()=>R,copyTexture:()=>C,copyTextureToBuffer:()=>G,createBindGroup:()=>S,createBindGroupLayout:()=>y,createBuffer:()=>b,createRenderPass:()=>B,createRenderPipeline:()=>w,createSampler:()=>m,createShader:()=>x,createTexture:()=>v,draw:()=>O,drawIndexed:()=>$,generateMipmap:()=>k,getDeviceFeatures:()=>g,isDeviceLost:()=>p,readBuffer:()=>F,requestWebGL2Device:()=>f,resetDevice:()=>h,setBindGroup:()=>E,setBlendConst:()=>j,setIndex:()=>U,setRenderPipeline:()=>A,setScissorRect:()=>V,setStencilRef:()=>q,setVertex:()=>L,setViewport:()=>X,submitRenderPass:()=>_,writeBuffer:()=>D,writeTexture:()=>M});var i=r(624),n=r(249),s=r(17),a=r(873),o=r(568),l=r(253);const c=255,u=4294967295;let d=null;function f(e,t={},r=0){const n=e.getContext("webgl2",t);if(n){let t=0;for(const e in o.T)r&+e&&n.getExtension(o.T[+e])&&(t|=+e);const s=z(n),a=e=>{e.deleteFramebuffer(s.copyFrameBuffer)},l={canvas:e,gl:n,state:s,features:t,pass:null,destroy(){a(this.gl)}};return i.i&&d.register(l,{finalizer:a,gl:n}),l}return null}function h(e){e.destroy(),Object.assign(e.state,z(e.gl))}function p(e){return e.gl.isContextLost()}function g(e){return e.features}function b(e,t){const r=t.usage&a.FB.Uniform?n.MfQ:t.usage&a.FB.Index?n.cXR:n.qOY,s=t.usage&a.FB.Stream?n.F_0:t.usage&a.FB.Dynamic?n.kdr:n.MBW,o=e.gl.createBuffer();e.gl.bindBuffer(r,o),e.gl.bufferData(r,t.size,s);const l=e=>{e.deleteBuffer(o)},c={gl:e.gl,glb:o,type:r,size:t.size,destroy(){l(this.gl)}};return i.i&&d.register(c,{finalizer:l,gl:e.gl}),c}function v(e,t){const r=t.sampleCount||1,s=t.dimension||n.Bxn,o=t.format||n.hw6,c=!(0,l.EC)(o)||(t.usage||0)&a.v2.TextureBinding,[u,f,h]=t.size||[1,1,1],p=s===n.Ep7?6:s===n.Bxn?1:h;let g=null,b=null;(r>1||!c)&&(b=e.gl.createRenderbuffer(),e.gl.bindRenderbuffer(n.bW,b),r>1?e.gl.renderbufferStorageMultisample(n.bW,r,o,u,f):e.gl.renderbufferStorage(n.bW,o,u,f)),c&&(g=e.gl.createTexture(),e.gl.activeTexture(n.VKS),e.gl.bindTexture(s,g),(0,l.cj)(s)?e.gl.texStorage3D(s,t.mipLevelCount||1,o,u,f,p):e.gl.texStorage2D(s,t.mipLevelCount||1,o,u,f));const v=e=>{e.deleteTexture(g),e.deleteRenderbuffer(b)},m={gl:e.gl,glt:g,glrb:b,type:s,format:o,width:u,height:f,depth:p,samples:r,destroy(){v(this.gl)}};return i.i&&d.register(m,{finalizer:v,gl:e.gl}),m}function m(e,t={}){const r=e.gl.createSampler();let s=t.minFilter||n.jX6;t.mipmapFilter&&(s=t.mipmapFilter===n.jX6?s===n.jX6?n.wFH:n.LRx:s===n.jX6?n.Oxh:n.q0S),e.gl.samplerParameteri(r,n.$X9,s),e.gl.samplerParameteri(r,n.Xeo,t.magFilter||n.jX6),e.gl.samplerParameteri(r,n.n4e,t.addressModeU||n.mYe),e.gl.samplerParameteri(r,n.nbD,t.addressModeV||n.mYe),e.gl.samplerParameteri(r,n.J51,t.addressModeW||n.mYe),e.gl.samplerParameterf(r,n.HiH,t.lodMaxClamp||32),e.gl.samplerParameterf(r,n.pge,t.lodMinClamp||0),t.compare&&(e.gl.samplerParameterf(r,n.LOg,n.fqf),e.gl.samplerParameterf(r,n.w0M,t.compare)),(t.maxAnisotropy||1)>1&&e.gl.samplerParameterf(r,n.cMJ,Math.min(t.maxAnisotropy||1,e.gl.getParameter(n.Cip)));const a=e=>{e.deleteSampler(r)},o={gls:r,gl:e.gl,destroy(){a(this.gl)}};return i.i&&d.register(o,{finalizer:a,gl:e.gl}),o}function x(e,t){const r=t.usage===a.$X.Vertex?n.HI8:n.YMo,s=e.gl.createShader(r);e.gl.shaderSource(s,t.code),e.gl.compileShader(s);const o=e=>{e.deleteShader(s)},l={gl:e.gl,gls:s,destroy(){o(this.gl)}};return i.i&&d.register(l,{finalizer:o,gl:e.gl}),l}function B(e,t={}){let r=null;const s=[],a=t.depthStencil?t.depthStencil.texture:null,o=a&&(0,l.IO)(a.format)||!1;if(t.colors&&t.colors.length){r=e.gl.createFramebuffer(),e.gl.bindFramebuffer(n.fjQ,r);for(let r=0;r<t.colors.length;++r)t.colors[r].view.texture.samples>1?e.gl.framebufferRenderbuffer(n.fjQ,n.Z$E+r,n.bW,t.colors[r].view.texture.glrb):W(e.gl,n.Z$E+r,t.colors[r].view);t.colors.length>1&&e.gl.drawBuffers(t.colors.map(((e,t)=>n.Z$E+t))),a&&(a.glrb?e.gl.framebufferRenderbuffer(n.fjQ,o?n.TU:n.Ec0,n.bW,a.glrb):W(e.gl,o?n.TU:n.Ec0,t.depthStencil));for(let r=0;r<t.colors.length;++r)s.push(t.colors[r].view.texture.samples>1?N(e.gl,n.Z$E,t.colors[r].view):null);s.push(a&&a.samples>1&&a.glt?N(e.gl,o?n.TU:n.Ec0,t.depthStencil):null)}const c=e=>{e.deleteFramebuffer(r);for(const t of s)e.deleteFramebuffer(t)},u={gl:e.gl,glfb:r,glrfb:s,depth:a,color:t.colors?t.colors.map((e=>e.view.texture)):[],clearColors:t.colors?t.colors.map((e=>e.clear)):[],clearColor:t.clearColor,clearDepth:t.clearDepth,clearStencil:t.clearStencil,destroy(){c(this.gl)}};return i.i&&d.register(u,{finalizer:c,gl:e.gl}),u}function y(e,t){return{entries:t.entries.map(((e,t)=>({binding:t,...e}))),destroy(){}}}function S(e,t){return{entries:t.entries.map(((e,t)=>({binding:t,...e}))),destroy(){}}}function w(e,t){const r=function(e,t,r){const i=e.gl.createProgram();return e.gl.attachShader(i,t),e.gl.attachShader(i,r),e.gl.linkProgram(i),i}(e,t.vertex.gls,t.fragment.gls),s=[],o={};let l=0,c=0;if(t.bindGroups){for(let i=0;i<t.bindGroups.length;++i){const u=t.bindGroups[i].entries;s.push([]);for(let t=0;t<u.length;++t){const d=u[t];let f=null,h=n.EP2;d.type===a.$l.Buffer?(h=e.gl.getUniformBlockIndex(r,d.label),e.gl.uniformBlockBinding(r,h,l++)):d.type===a.$l.Texture&&(f=e.gl.getUniformLocation(r,d.label),o[d.label]=c++),s[i][d.binding]={...d,loc:f,index:h,slot:d.type===a.$l.Buffer?l-1:d.type===a.$l.Texture?c-1:0}}}for(let e=0;e<t.bindGroups.length;++e){const r=t.bindGroups[e].entries;for(let t=0;t<r.length;++t)r[t].type===a.$l.Sampler&&o[r[t].label]&&(s[e][r[t].binding].slot=o[r[t].label])}}const u=e=>{e.deleteProgram(r)},f={gl:e.gl,glp:r,buffers:t.buffers,cache:s,state:K(t),destroy(){u(this.gl)}};return i.i&&d.register(f,{finalizer:u,gl:e.gl}),f}function F(e,t,r,i=0){const a={status:s.Q.Pending};return function(e,t,r,i,s){const a=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);return e.flush(),function(e,t,r,i){return new Promise(((r,i)=>{!function s(){const a=e.clientWaitSync(t,0,0);a==n.XjA?i():a==n.iRB?setTimeout(s,10):r()}()}))}(e,a).finally((()=>e.deleteSync(a))).then((()=>{const n=new Uint8Array(s);return e.bindBuffer(t,r),e.getBufferSubData(t,i,n,0,s),n}))}(e.gl,t.type,t.glb,i,r.byteLength).then((e=>{r.set(e),a.status=s.Q.Done}),(()=>a.status=s.Q.Error)),a}function D(e,t,r,i=0){e.gl.bindBuffer(t.type,t.glb),e.gl.bufferSubData(t.type,i,r)}function P(e,t,r,i=t.size,s=0,a=0){e.gl.bindBuffer(n.u99,t.glb),e.gl.bindBuffer(n.i_,r.glb),e.gl.copyBufferSubData(n.u99,n.i_,s,a,i)}function k(e,t,r=n.wdg){e.gl.activeTexture(n.VKS),e.gl.bindTexture(t.type,t.glt),e.gl.hint(n.jpO,r),e.gl.generateMipmap(t.type)}function M(e,{texture:t,mipLevel:r=0,origin:[i,s,a]=[0,0,0]},o,{offset:c=0,bytesPerRow:u,rowsPerImage:d=0},[f,h,p]=[t.width-i,t.height-s,t.depth-a]){const g=(0,l.jk)(t.format),b=(0,l.cX)(t.format),v=t.type===n.Ep7,m=v?n._fi+a:t.type;e.gl.activeTexture(n.VKS),e.gl.bindTexture(t.type,t.glt);const x=(0,l.Vg)(t.format),B=d||h,y=Math.floor(u/x),S=c-c%u;if(e.gl.pixelStorei(n.AAP,B),e.gl.pixelStorei(n.GNc,y),e.gl.pixelStorei(n.u$q,Math.floor(c%u/x)),e.gl.pixelStorei(n.Sr6,0),e.gl.pixelStorei(n.mku,0),(0,l.cj)(t.type))e.gl.texSubImage3D(m,r,i,s,a,f,h,p,t.format,b,o,S);else if(v)for(let t=a;t<a+p;++t)e.gl.pixelStorei(n.Sr6,t*y*B),e.gl.texSubImage2D(m+t,r,i,s,f,h,g,b,o,S);else e.gl.texSubImage2D(m,r,i,s,f,h,g,b,o,S)}function R(e,{src:t,origin:[r,i]=[0,0]},{texture:s,mipLevel:a=0,origin:[o,c,u]=[0,0,0]},[d,f]=[t.width-r,t.height-i]){const h=(0,l.cX)(s.format),p=s.type===n.Ep7?n._fi+u:s.type;e.gl.activeTexture(n.VKS),e.gl.bindTexture(s.type,s.glt),e.gl.pixelStorei(n.u$q,r),e.gl.pixelStorei(n.Sr6,i),e.gl.pixelStorei(n.mku,0),e.gl.pixelStorei(n.AAP,0),(0,l.cj)(s.type)?e.gl.texSubImage3D(p,a,o,c,u,d,f,1,s.format,h,t):e.gl.texSubImage2D(p,a,o,c,d,f,(0,l.jk)(s.format),h,t)}function C(e,{texture:t,mipLevel:r=0,origin:[i,s,a]=[0,0,0]},{texture:o,mipLevel:c=0,origin:[u,d,f]=[0,0,0]},[h,p,g]=[t.width-i,t.height-s,t.depth-a]){const b=o.type===n.Ep7,v=b?n._fi+f:o.type;if(e.gl.activeTexture(n.VKS),e.gl.bindTexture(o.type,o.glt),e.gl.readBuffer(n.Z$E),e.gl.bindFramebuffer(n.fjQ,e.state.copyFrameBuffer),(0,l.cj)(t.type)||t.type===n.Ep7)for(let m=a;m<a+g;++m)W(e.gl,n.Z$E,{texture:t,mipLevel:r,slice:m}),(0,l.cj)(o.type)?e.gl.copyTexSubImage3D(v+(b?m:0),c,u,d,f,i,s,h,p):e.gl.copyTexSubImage2D(v+(b?m:0),c,u,d,i,s,h,p);else{const a=0;W(e.gl,n.Z$E,{texture:t,mipLevel:r,slice:a}),(0,l.cj)(o.type)?e.gl.copyTexSubImage3D(v+(b?a:0),c,u,d,f,i,s,h,p):e.gl.copyTexSubImage2D(v+(b?a:0),c,u,d,i,s,h,p)}e.gl.bindFramebuffer(n.fjQ,e.pass?e.pass.glfb:null)}function G(e,{texture:t,mipLevel:r=0,origin:[i,s,a]=[0,0,0]},o,{offset:c=0,bytesPerRow:u,rowsPerImage:d=0},[f,h,p]=[t.width-i,t.height-s,t.depth-a]){e.gl.bindBuffer(n.cJA,o),e.gl.readBuffer(n.Z$E),e.gl.bindFramebuffer(n.fjQ,e.state.copyFrameBuffer);const g=(0,l.cX)(t.format),b=(0,l.jk)(t.format),v=(0,l.Vg)(t.format),m=d||h,x=Math.floor(u/v),B=c-c%u;if(e.gl.pixelStorei(n.U02,x),e.gl.pixelStorei(n.$Hb,Math.floor(c%u/v)),e.gl.pixelStorei(n.k5F,0),(0,l.cj)(t.type)||t.type===n.Ep7)for(let o=a;o<a+p;++o)W(e.gl,n.Z$E,{texture:t,mipLevel:r,slice:o}),e.gl.readPixels(i,s,f,h,b,g,B+(o-a)*u*m);else{const a=0;W(e.gl,n.Z$E,{texture:t,mipLevel:r,slice:a}),e.gl.readPixels(i,s,f,h,b,g,B)}e.gl.bindFramebuffer(n.fjQ,e.pass?e.pass.glfb:null)}function T(e,t){let r=e.gl.drawingBufferWidth,i=e.gl.drawingBufferHeight;t.color.length&&(r=t.color[0].width,i=t.color[0].height),e.gl.bindFramebuffer(n.fjQ,t.glfb),e.gl.viewport(0,0,r,i),e.gl.depthRange(0,1),e.state.scissor&&(e.state.scissor=!1,ee(e.gl,n.yN1,!1));let s=0;if(isNaN(t.clearDepth)||(s|=n.yXb,e.gl.clearDepth(t.clearDepth),J(e.gl,e.state.state.depthWrite,!0),e.state.state.depthWrite=!0),isNaN(t.clearStencil)||(s|=n.ecp,e.gl.clearStencil(t.clearStencil),Z(e.gl,e.state.state.stencilWriteMask,c),e.state.state.stencilWriteMask=c),Y(e.gl,e.state.state.blendWriteMask,a.Yw.All),e.state.state.blendWriteMask=a.Yw.All,t.color.length){for(let r=0;r<t.color.length;++r)if(t.clearColors[r]){const i=(0,l.xN)(t.color[r].format);i===n.bBe?e.gl.clearBufferiv(n.r$7,r,t.clearColors[r]):i===n.r1O?e.gl.clearBufferuiv(n.r$7,r,t.clearColors[r]):e.gl.clearBufferfv(n.r$7,r,t.clearColors[r])}}else t.clearColor&&(s|=n._Hr,e.gl.clearColor(...t.clearColor));s&&e.gl.clear(s),e.pass=t}function I(e,t={}){e.gl.bindFramebuffer(n.fjQ,null),e.gl.viewport(0,0,e.gl.drawingBufferWidth,e.gl.drawingBufferHeight),e.gl.depthRange(0,1),e.state.scissor&&(e.state.scissor=!1,ee(e.gl,n.yN1,!1));let r=0;isNaN(t.clearDepth)||(r|=n.yXb,e.gl.clearDepth(t.clearDepth),J(e.gl,e.state.state.depthWrite,!0),e.state.state.depthWrite=!0),isNaN(t.clearStencil)||(r|=n.ecp,e.gl.clearStencil(t.clearStencil),Z(e.gl,e.state.state.stencilWriteMask,c),e.state.state.stencilWriteMask=c),t.clearColor&&(r|=n._Hr,e.gl.clearColor(...t.clearColor),Y(e.gl,e.state.state.blendWriteMask,a.Yw.All),e.state.state.blendWriteMask=a.Yw.All),r&&e.gl.clear(r),e.pass=null}function _(e){if(e.pass){for(let t=0;t<e.pass.color.length;++t)e.pass.glrfb[t]&&H(e.gl,e.pass.glfb,e.pass.glrfb[t],e.pass.color[t],n._Hr,n.Z$E+t);const t=e.pass.glrfb[e.pass.glrfb.length-1];e.pass.depth&&t&&H(e.gl,e.pass.glfb,t,e.pass.depth,n.yXb|n.ecp)}e.pass=null}function A(e,t){if(e.state.pipeline===t)return;e.state.pipeline&&e.state.pipeline.glp===t.glp||e.gl.useProgram(t.glp),Q(e.gl,e.state.state,t.state,e.state.stencilRef),Object.assign(e.state.state,t.state);const r=[];for(const{attributes:t}of e.state.buffers)for(const{ptr:e}of t)r[e[0]]=1;e.state.buffers=Array(t.buffers.length);for(let i=0;i<t.buffers.length;++i){const{attributes:n,stride:s,stepMode:a=0}=t.buffers[i],o=[];e.state.buffers[i]={glb:null,attributes:o,stride:s,step:a,offset:0,instanceOffset:0};for(const{format:e,offset:t,shaderLocation:c}of n)r[c]=(r[c]||0)+2,o.push({buffer:i,ptr:[c,(0,l.Xm)(e),(0,l.S5)(e),(0,l.bA)(e),s,t],step:a})}for(let t=0;t<r.length;++t)2===r[t]?e.gl.enableVertexAttribArray(t):1===r[t]&&e.gl.disableVertexAttribArray(t);e.state.pipeline=t}function U(e,t){t.glb!==e.state.index&&e.gl.bindBuffer(n.cXR,e.state.index=t.glb)}function L(e,t,r,i=0){const n=e.state.buffers[t];!n||n.glb===r.glb&&n.offset===i||(n.glb=r.glb,n.offset=i,n.instanceOffset=0,te(e.gl,n,i))}function E(e,t,r,i=[]){if(e.state.pipeline)for(let s=0,a=0;s<r.entries.length;++s){const o=r.entries[s],l=e.state.pipeline.cache[t]&&e.state.pipeline.cache[t][o.binding];if(l)if(o.buffer){let t=o.bufferOffset||0;l.bufferDynamicOffset&&(t+=i[a]||0,++a),e.gl.bindBufferRange(n.MfQ,l.slot,o.buffer.glb,t,o.bufferSize||o.buffer.size-t)}else o.texture?(e.gl.activeTexture(n.VKS+l.slot),e.gl.bindTexture(o.texture.type,o.texture.glt),e.gl.uniform1i(l.loc,l.slot)):o.sampler&&e.gl.bindSampler(l.slot,o.sampler.gls)}}function O(e,t,r=1,i=0,n=0){for(const t of e.state.buffers)t.step&&t.instanceOffset!==n&&(t.instanceOffset=n,te(e.gl,t,n*t.stride));e.gl.drawArraysInstanced(e.state.state.topology,i,t,r)}function $(e,t,r=1,i=0,n=0){for(const t of e.state.buffers)t.step&&t.instanceOffset!==n&&(t.instanceOffset=n,te(e.gl,t,n*t.stride));e.gl.drawElementsInstanced(e.state.state.topology,t,e.state.state.indexFormat,i*(0,l.Ij)(e.state.state.indexFormat),r)}function X(e,t,r,i,n,s=0,a=1){e.gl.viewport(t,r,i,n),e.gl.depthRange(s,a)}function V(e,t,r,i,s){e.state.scissor||(ee(e.gl,n.yN1,!0),e.state.scissor=!0),e.gl.scissor(t,r,i,s)}function j(e,t){e.gl.blendColor(...t)}function q(e,t){if(e.state.stencilRef!==t){const{stencilFrontCompare:r,stencilBackCompare:i,stencilReadMask:s}=e.state.state;e.gl.stencilFuncSeparate(n.kpY,r,t,s),e.gl.stencilFuncSeparate(n.FoO,i,t,s),e.state.stencilRef=t}}function z(e){const t=K();e.blendColor(1,1,1,1),Q(e,t,t,0,!0);for(let t=0;t<16;++t)e.disableVertexAttribArray(t);return e.pixelStorei(n.d8P,1),e.pixelStorei(n.T_I,1),{copyFrameBuffer:e.createFramebuffer(),buffers:[],state:t,pipeline:null,index:null,stencilRef:0,scissor:!1}}function W(e,t,{texture:r,slice:i=0,mipLevel:s=0}){if((0,l.cj)(r.type))e.framebufferTextureLayer(n.fjQ,t,r.glt,s,i);else{const a=r.type===n.Ep7?n._fi+i:r.type;e.framebufferTexture2D(n.fjQ,t,a,r.glt,s)}}function N(e,t,r){const i=e.createFramebuffer();return e.bindFramebuffer(n.fjQ,i),W(e,t,r),i}function H(e,t,r,i,s,a=n.Z$E){e.bindFramebuffer(n.xWx,t),e.bindFramebuffer(n.iXE,r),e.readBuffer(a),e.blitFramebuffer(0,0,i.width,i.height,0,0,i.width,i.height,s,n.jX6)}function K(e={}){const t=e.primitive||{},r=e.depthStencil||{},{stencilFront:i={},stencilBack:s={}}=r,{sampleCount:o=1,alphaToCoverage:l=!1}=e.multisample||{},c=e.targets||{};let d=c.writeMask||a.Yw.All,f=c.blendColor||{},h=c.blendColor||{};return c.targets&&c.targets[0]&&(d=c.targets[0].writeMask||d,f=c.targets[0].blendColor||f,h=c.targets[0].blendAlpha||h),{sampleCount:o,alphaToCoverage:l,topology:t.topology||n.QPP,indexFormat:t.indexFormat||n.Ae4,frontFace:t.frontFace||n.iHR,cullMode:t.cullMode||n.Hnw,depth:!!e.depthStencil,depthWrite:r.depthWrite||!1,depthFormat:r.format||n.kv5,depthCompare:r.depthCompare||n.Brs,depthBias:r.depthBias||0,depthBiasSlopeScale:r.depthBiasSlopeScale||0,stencil:!(!r.stencilFront&&!r.stencilBack),stencilFrontCompare:i.compare||n.Brs,stencilFrontFailOp:i.failOp||n.M$f,stencilFrontDepthFailOp:i.depthFailOp||n.M$f,stencilFrontPassOp:i.passOp||n.M$f,stencilBackCompare:s.compare||n.Brs,stencilBackFailOp:s.failOp||n.M$f,stencilBackDepthFailOp:s.depthFailOp||n.M$f,stencilBackPassOp:s.passOp||n.M$f,stencilReadMask:r.stencilReadMask||u,stencilWriteMask:r.stencilWriteMask||u,blend:!!e.targets,blendWriteMask:d,blendColorOp:f.operation||n.BjA,blendColorSrcFactor:f.srcFactor||n.ryP,blendColorDstFactor:f.dstFactor||n.xEJ,blendAlphaOp:h.operation||n.BjA,blendAlphaSrcFactor:h.srcFactor||n.ryP,blendAlphaDstFactor:h.dstFactor||n.xEJ}}function Q(e,t,r,i=0,s=!1){let a=!1,o=0,l=0,c=0,u=0;o=r.frontFace,(s||t.frontFace!==o)&&e.frontFace(o),o=r.cullMode,(s||t.cullMode!==o)&&((a=o!==n.Hnw)&&e.cullFace(o),ee(e,n.DuX,a)),a=r.alphaToCoverage,(s||t.alphaToCoverage!==a)&&ee(e,n.fRZ,a),a=!!r.depth,(s||t.depth!==a)&&ee(e,n.Elr,a),(s||a)&&(J(e,t.depthWrite,r.depthWrite,s),o=r.depthCompare,(s||t.depthCompare!==o)&&e.depthFunc(o)),o=r.depthBiasSlopeScale,l=r.depthBias,(s||t.depthBiasSlopeScale!==o||t.depthBias!==l)&&(ee(e,n.gYZ,!(!o&&!l)),e.polygonOffset(o,l)),a=!!r.stencil,(s||t.stencil!==a)&&ee(e,n.nT3,a),(s||a)&&(o=r.stencilReadMask,a=s||t.stencilReadMask!==o,l=r.stencilFrontCompare,(a||t.stencilFrontCompare!==l)&&e.stencilFuncSeparate(n.kpY,l,i,o),l=r.stencilBackCompare,(a||t.stencilBackCompare!==l)&&e.stencilFuncSeparate(n.FoO,l,i,o),o=r.stencilFrontFailOp,l=r.stencilFrontDepthFailOp,c=r.stencilFrontPassOp,(s||t.stencilFrontFailOp!==o||t.stencilFrontDepthFailOp!==l||t.stencilFrontPassOp!==c)&&e.stencilOpSeparate(n.kpY,o,l,c),o=r.stencilBackFailOp,l=r.stencilBackDepthFailOp,c=r.stencilBackPassOp,(s||t.stencilBackFailOp!==o||t.stencilBackDepthFailOp!==l||t.stencilBackPassOp!==c)&&e.stencilOpSeparate(n.FoO,o,l,c),Z(e,t.stencilWriteMask,r.stencilWriteMask,s)),a=r.blend,(s||t.blend!==a)&&ee(e,n.uvM,a),(s||a)&&(o=r.blendColorSrcFactor,l=r.blendColorDstFactor,c=r.blendAlphaSrcFactor,u=r.blendAlphaDstFactor,(s||t.blendColorSrcFactor!==o||t.blendColorDstFactor!==l||t.blendAlphaSrcFactor!==c||t.blendAlphaDstFactor!==u)&&e.blendFuncSeparate(o,l,c,u),o=r.blendColorOp,l=r.blendAlphaOp,(s||t.blendColorOp!==o||t.blendAlphaOp!==l)&&e.blendEquationSeparate(o,l),Y(e,t.blendWriteMask,r.blendWriteMask,s))}function Y(e,t,r,i=!1){(i||t!==r)&&e.colorMask(!!(r&a.Yw.Red),!!(r&a.Yw.Green),!!(r&a.Yw.Blue),!!(r&a.Yw.Alpha))}function J(e,t,r,i=!1){(i||t!==r)&&e.depthMask(r)}function Z(e,t,r,i=!1){(i||t!==r)&&e.stencilMask(r)}function ee(e,t,r){r?e.enable(t):e.disable(t)}function te(e,t,r){e.bindBuffer(n.qOY,t.glb);for(let i=0;i<t.attributes.length;++i){const{ptr:n,step:s}=t.attributes[i],a=[...n];a[5]+=r,e.vertexAttribPointer(...a),e.vertexAttribDivisor(n[0],s)}}i.i&&(d=new FinalizationRegistry((({finalizer:e,gl:t})=>{e(t)})))},17:(e,t,r)=>{r.d(t,{Q:()=>i});const i={Pending:0,Done:1,Error:2}},873:(e,t,r)=>{r.d(t,{$X:()=>f,$l:()=>v,EV:()=>l,FB:()=>n,Kz:()=>g,OB:()=>c,Wf:()=>h,X9:()=>u,Yw:()=>a,dV:()=>m,gB:()=>b,kd:()=>o,oD:()=>x,v2:()=>s,wb:()=>d,xS:()=>p});var i=r(249);const n={Index:16,Vertex:32,Uniform:64,Dynamic:4096,Stream:8192},s={TextureBinding:4,RenderAttachment:16},a={Red:1,Green:2,Blue:4,Alpha:8,All:15},o={D2:i.Bxn,D2Array:i.EPl,CubeMap:i.Ep7,D3:i.Tr1},l={R8:i.R8,R8SNORM:i.sVf,R8UI:i.LrX,R8I:i.q6i,R16UI:i.iVF,R16I:i.xiM,RG8:i.$mf,RG8SNORM:i.wAm,RG8UI:i.coM,RG8I:i.LGL,R32UI:i.If2,R32I:i.$oc,RG16UI:i.ZLz,RG16I:i.qB9,RGBA8:i.hw6,SRGBA8:i.jnw,RGBA8SNORM:i.Mgl,RGBA8UI:i.r5A,RGBA8I:i.Qjo,RGB10A2:i.blh,RG32UI:i.m89,RG32I:i.nR4,RGBA16UI:i.rxK,RGBA16I:i.Msg,RGBA32UI:i.Rkd,RGBA32I:i.gtH,R16F:i.WsI,RG16F:i.MJi,RG11B10F:i.Khk,RGBA16F:i._hT,R32F:i.h2H,RG32F:i.qed,RGBA32F:i.Nug,Depth16:i.kv5,Depth24:i.d_Y,Depth24Stencil8:i.ABS,Depth32F:i.dj5,Depth32FStencil8:i.Vwh},c={ClampToEdge:i.mYe,Repeat:i.aRZ,MirrorRepeat:i.$sD},u={Nearest:i.jX6,Linear:i.t$R},d={Never:i.C4F,Less:i.GPd,Equal:i.gUF,LessEqual:i.DXJ,Greater:i.iFn,NotEqual:i.vkJ,GreaterEqual:i.BzQ,Always:i.Brs},f={Vertex:1,Fragment:2},h=(i.Erx,i.Ukp,i.cgb,i.QPP,i.b0H,i.Ae4,i.r1O,i.iHR,i.CW,{None:i.Hnw,Front:i.kpY,Back:i.FoO}),p={Keep:i.M$f,Zero:i.xEJ,Replace:i.J57,Invert:i.nl2,Increment:i.RcM,Decrement:i.jgr,IncrementWrap:i.VGh,DecrementWrap:i.C6Q},g=(i.xEJ,i.ryP,i.brc,i.i$_,i.hy5,i.OAz,i.PB6,i.miX,i.TMl,i.njp,i.Rb8,i.Q0U,i.ldG,i.BjA,i.Jhs,i.KTj,i.KXm,i.k2X,{Vertex:0,Instance:1}),b={UI8x2:274,UI8x4:276,I8x2:4370,I8x4:4372,UNORM8x2:8466,UNORM8x4:8468,SNORM8x2:12562,SNORM8x4:12564,UI16x2:290,UI16x4:292,I16x2:4386,I16x4:4388,UNORM16x2:8482,UNORM16x4:8484,SNORM16x2:12578,SNORM16x4:12580,F16x2:546,F16x4:548,F32:577,F32x2:578,F32x3:579,F32x4:580},v={Buffer:0,Sampler:1,Texture:2},m={Filtering:0,NonFiltering:1,Comparison:2},x={Float:0,Depth:1,Int:2,UInt:3};i.gq9,i.NRq},795:(e,t,r)=>{r.d(t,{hx:()=>K,PM:()=>H,gK:()=>N,ZM:()=>j,uH:()=>V,AF:()=>E,Ow:()=>z,Me:()=>q,QB:()=>$,wx:()=>X,U3:()=>O,Ko:()=>k,WS:()=>k,EY:()=>k,Fb:()=>L,Dx:()=>C,FL:()=>k,E5:()=>k,hw:()=>k,y9:()=>k,FE:()=>k,ii:()=>te,ci:()=>re,Cf:()=>I,uq:()=>R,kS:()=>T,Jj:()=>G,kb:()=>U,IL:()=>ee,GH:()=>M,BK:()=>J,EX:()=>Y,eu:()=>ie,RS:()=>Z,z0:()=>Q,C7:()=>A,CS:()=>_,bo:()=>W});var i=r(873),n=r(657);const s=2097151,a=2**32;function o(e,t){return(t&s)*a+(e>>>0)}function l(e){return e>>>0}let c,u;c=Symbol.iterator;class d{constructor(){this.generations=[],this.freeList=[]}get size(){return this.generations.length-this.freeList.length}clear(){this.generations.length=0,this.freeList.length=0}create(){let e,t;return this.freeList.length>0?(e=this.freeList.pop(),t=Math.abs(this.generations[e]),this.generations[e]=t):(e=this.generations.length,t=e?0:1,this.generations.push(t)),o(e,t)}delete(e){if(!this.has(e))return!1;const t=l(e);let r=-(this.generations[t]+1&s);return t||r||++r,this.generations[t]=r,this.freeList.push(t),!0}forEach(e,t){let r=0;for(const i of this.values())e.call(t,i,r,this),r+=1}has(e){return l(e)<this.generations.length&&function(e){return e/a&s}(e)===this.generations[l(e)]}*values(){for(let e=0;e<this.generations.length;++e){const t=this.generations[e];this.generations[e]>=0&&(yield o(e,t))}}[c](){return this.values()}}u=Symbol.iterator;class f{constructor(){this.allocator=new d,this.data=[]}add(e){const t=this.allocator.create();return this.data[l(t)]=e,t}clear(){this.allocator.clear(),this.data.length=0}delete(e){return!!this.allocator.delete(e)&&(delete this.data[l(e)],!0)}*entries(){for(const e of this.allocator.values())yield[e,this.data[l(e)]]}forEach(e,t){this.allocator.forEach((r=>{e.call(t,this.data[l(r)],r,this)}),t)}get(e){return this.has(e)?this.data[l(e)]:void 0}has(e){return this.allocator.has(e)}keys(){return this.allocator.values()}*values(){for(const e of this.allocator.values())yield this.data[l(e)]}[u](){return this.entries()}}const h=new TextDecoder("utf-8");let p=new DataView(new ArrayBuffer(0));function g(e){return p.buffer!==e.buffer&&(p=new DataView(e.buffer)),p}function b(e,t,r){return h.decode(new Uint8Array(e.buffer,t,r))}const v={},m=(new f,new f),x={},B=new f,y={},S={},w=new f,F={};function D(e){return v[e].memory}function P(e){return D(F[e])}function k(e){const t=w.get(e);t&&(t.destroy(),w.delete(e))}function M(e,t){(v[e]=v[e]||{memory:null}).memory=t}function R(e,t,r){const i=b(D(e),t,r);if(x[i])return x[i];const n=document.getElementById(i);return n?x[i]=m.add(n):0}function C(e){m.delete(e)}function G(e){var t;return(null===(t=m.get(e))||void 0===t?void 0:t.width)||0}function T(e){var t;return(null===(t=m.get(e))||void 0===t?void 0:t.height)||0}function I(e,t,r){const i=b(D(e),t,r);if(y[i])return y[i];const n=document.getElementById(i);if(!n)return 0;const s=y[i]=B.add(n);return S[s]=e,s}function _(e,t,r){const i=B.get(e);if(i){const a=n.requestWebGL2Device(i,{alpha:!!(1&(s=t)),antialias:!!(2&s),depth:!!(4&s),desynchronized:!!(8&s),failIfMajorPerformanceCaveat:!!(16&s),powerPreference:32&s?"high-performance":"low-power",premultipliedAlpha:!!(64&s),preserveDrawingBuffer:!!(128&s),stencil:!!(256&s)},r);if(a){const t=w.add(a);return F[t]=S[e],t}}var s;return 0}function A(e,t,r){n.generateMipmap(w.get(e),w.get(t),r)}function U(e){n.resetDevice(w.get(e))}function L(e){k(e),delete F[e]}function E(e,t,r){const i=n.createBuffer(w.get(e),{size:t>>>0,usage:r>>>0});return w.add(i)}function O(e,t,r,i,s,a,o,l,c){const u=n.createTexture(w.get(e),{size:[t>>>0,r>>>0,i>>>0],mipLevelCount:s>>>0,sampleCount:a>>>0,dimension:o>>>0,format:l>>>0,usage:c>>>0});return w.add(u)}function $(e,t,r,i,s,a,o,l,c,u,d){const f=n.createSampler(w.get(e),{addressModeU:t>>>0,addressModeV:r>>>0,addressModeW:i>>>0,magFilter:s>>>0,minFilter:a>>>0,mipmapFilter:o>>>0,lodMinClamp:l,lodMaxClamp:c,compare:u>>>0,maxAnisotropy:d>>>0});return w.add(f)}function X(e,t,r,i){const s=n.createShader(w.get(e),{code:b(P(e),t,r),usage:i>>>0});return w.add(s)}function V(e,t,r){const s=P(e),a=[];for(let e=0;e<r;e++){const r=t+32*e,n=g(s).getUint32(r+0,!0),o=g(s).getUint32(r+4,!0),l=g(s).getUint8(r+16);let c=!1,u=i.dV.Filtering,d=i.oD.Float,f=i.kd.D2,h=!1;switch(l){case i.$l.Buffer:c=!!g(s).getUint8(r+20);break;case i.$l.Sampler:u=g(s).getUint32(r+20,!0)>>>0;break;case i.$l.Texture:d=g(s).getUint32(r+20,!0)>>>0,f=g(s).getUint32(r+24,!0)>>>0,h=!!g(s).getUint8(r+28);break;default:throw new RangeError("invalid variant discriminant for BindingType")}a.push({label:b(s,n,o),binding:g(s).getUint32(r+8,!0)>>>0,visibility:g(s).getUint32(r+12,!0)>>>0,type:l,bufferDynamicOffset:c,samplerType:u,textureSampleType:d,textureDimension:f,textureMultisampled:h})}const o=n.createBindGroupLayout(w.get(e),{entries:a});return w.add(o)}function j(e,t,r,s){const a=P(e),o=[];for(let e=0;e<s;e++){const t=r+24*e;let n=null,s=0,l=0,c=null,u=null;switch(g(a).getUint8(t+4)){case i.$l.Buffer:n=w.get(g(a).getFloat64(t+8,!0)),s=g(a).getUint32(t+16,!0),l=g(a).getUint32(t+20,!0);break;case i.$l.Sampler:c=w.get(g(a).getFloat64(t+8,!0));break;case i.$l.Texture:u=w.get(g(a).getFloat64(t+8,!0));break;default:throw new RangeError("invalid variant discriminant for BindingResource")}o.push({binding:g(a).getUint32(t+0,!0),buffer:n,bufferOffset:s,bufferSize:l,sampler:c,texture:u})}const l=n.createBindGroup(w.get(e),{layout:w.get(t),entries:o});return w.add(l)}function q(e,t,r,i,s,a,o,l,c,u,d,f,h,p,b,v,m,x,B,y,S,F,D,k,M,R,C,G,T,I,_,A,U,L,E,O,$,X,V,j,q){const z=P(e),W=[];for(let e=0;e<s;e++){const t=i+12*e;W.push({format:g(z).getUint32(t+0,!0),offset:g(z).getUint32(t+4,!0),shaderLocation:g(z).getUint32(t+8,!0)})}const N=[];for(let e=0;e<o;e++){const t=a+16*e,r=g(z).getUint32(t+0,!0),i=g(z).getUint32(t+4,!0);N.push({attributes:W.slice(r,r+i),stride:g(z).getUint32(t+8,!0),stepMode:g(z).getUint32(t+12,!0)})}const H=[];for(let e=0;e<c;e++){const t=l+8*e;H.push(w.get(g(z).getFloat64(t+0,!0)))}const K=[];for(let e=0;e<L;e++){const t=U+32*e;K.push({format:g(z).getUint32(t+0,!0)>>>0,writeMask:g(z).getUint32(t+4,!0)>>>0,blendColor:{operation:g(z).getUint32(t+8,!0)>>>0,srcFactor:g(z).getUint32(t+12,!0)>>>0,dstFactor:g(z).getUint32(t+16,!0)>>>0},blendAlpha:{operation:g(z).getUint32(t+20,!0)>>>0,srcFactor:g(z).getUint32(t+24,!0)>>>0,dstFactor:g(z).getUint32(t+28,!0)>>>0}})}const Q=n.createRenderPipeline(w.get(e),{vertex:w.get(t),fragment:w.get(r),buffers:N,bindGroups:H,primitive:{topology:u>>>0,indexFormat:d>>>0,frontFace:f>>>0,cullMode:h>>>0},multisample:{sampleCount:p>>>0,alphaToCoverage:!!b},depthStencil:v?{format:m>>>0,depthWrite:!!x,depthCompare:B>>>0,stencilFront:{compare:y>>>0,failOp:S>>>0,depthFailOp:F>>>0,passOp:D>>>0},stencilBack:{compare:k>>>0,failOp:M>>>0,depthFailOp:R>>>0,passOp:C>>>0},stencilReadMask:G>>>0,stencilWriteMask:T>>>0,depthBias:I,depthBiasSlopeScale:_,depthBiasClamp:A}:null,targets:{writeMask:E>>>0,blendColor:{operation:O>>>0,srcFactor:$>>>0,dstFactor:X>>>0},blendAlpha:{operation:V>>>0,srcFactor:j>>>0,dstFactor:q>>>0},targets:K}});return w.add(Q)}function z(e,t,r,i,s,a,o,l,c,u,d,f,h){const p=P(e);let b;switch(l){case 0:b={clearDepth:t,clearStencil:r,clearColor:isNaN(i)?null:[i,s,a,o]};break;case 1:{const e=[];for(let t=0;t<h;t++){const r=f+32*t,i=[g(p).getFloat32(r+16,!0),g(p).getFloat32(r+20,!0),g(p).getFloat32(r+24,!0),g(p).getFloat32(r+28,!0)];e.push({view:{texture:w.get(g(p).getFloat64(r+0,!0)),mipLevel:g(p).getUint32(r+8,!0),slice:g(p).getUint32(r+12,!0)},clear:isNaN(i[0])?null:i})}b={clearDepth:t,clearStencil:r,colors:e,depthStencil:{texture:w.get(c),mipLevel:u>>>0,slice:d>>>0}};break}default:throw new RangeError("invalid variant discriminant for RenderPassDescriptor")}const v=n.createRenderPass(w.get(e),b);return w.add(v)}function W(e,t,r,i,s){n.writeBuffer(w.get(e),w.get(t),new Uint8Array(P(e).buffer.slice(r,r+1*i)),s>>>0)}function N(e,t,r,i,s,a,o,l,c,u,d){n.copyExternalImageToTexture(w.get(e),{src:m.get(t),origin:[r>>>0,i>>>0]},{texture:w.get(s),mipLevel:a>>>0,origin:[o>>>0,l>>>0,c>>>0]},[u>>>0,d>>>0])}function H(e,t){n.beginRenderPass(w.get(e),w.get(t))}function K(e,t,r,i,s,a,o){n.beginDefaultPass(w.get(e),{clearColor:isNaN(i)?null:[i,s,a,o],clearDepth:t,clearStencil:r})}function Q(e){n.submitRenderPass(w.get(e))}function Y(e,t){n.setRenderPipeline(w.get(e),w.get(t))}function J(e,t){n.setIndex(w.get(e),w.get(t))}function Z(e,t,r,i){n.setVertex(w.get(e),t>>>0,w.get(r),i>>>0)}function ee(e,t,r,i,s){n.setBindGroup(w.get(e),t>>>0,w.get(r),new Uint32Array(P(e).buffer.slice(i,i+4*s)))}function te(e,t,r,i,s){n.draw(w.get(e),t>>>0,r>>>0,i>>>0,s>>>0)}function re(e,t,r,i,s){n.drawIndexed(w.get(e),t>>>0,r>>>0,i>>>0,s>>>0)}function ie(e,t){n.setStencilRef(w.get(e),t>>>0)}},891:(e,t,r)=>{r.d(t,{hx:()=>i.hx,PM:()=>i.PM,gK:()=>i.gK,ZM:()=>i.ZM,uH:()=>i.uH,AF:()=>i.AF,Ow:()=>i.Ow,Me:()=>i.Me,QB:()=>i.QB,wx:()=>i.wx,U3:()=>i.U3,Ko:()=>i.Ko,WS:()=>i.WS,EY:()=>i.EY,Fb:()=>i.Fb,Dx:()=>i.Dx,FL:()=>i.FL,E5:()=>i.E5,hw:()=>i.hw,y9:()=>i.y9,FE:()=>i.FE,ii:()=>i.ii,ci:()=>i.ci,Cf:()=>i.Cf,uq:()=>i.uq,kS:()=>i.kS,Jj:()=>i.Jj,kb:()=>i.kb,IL:()=>i.IL,BK:()=>i.BK,EX:()=>i.EX,eu:()=>i.eu,RS:()=>i.RS,z0:()=>i.z0,C7:()=>i.C7,CS:()=>i.CS,bo:()=>i.bo});var i=r(795)},132:(e,t,r)=>{r.a(e,(async(i,n)=>{try{var s=r(474),a=r(891),o=i([s]),[s]=o.then?(await o)():o;await r.v(t,e.id,"0a473631f59bc9a81d0f",{env:{abort:s.J,seed:s.D},"mugl/wasm":{get_canvas_by_id:a.Cf,webgl_request_device:a.CS,reset_device:a.kb,create_shader:a.wx,create_buffer:a.AF,write_buffer:a.bo,create_render_pipeline:a.Me,create_bind_group_layout:a.uH,create_bind_group:a.ZM,create_texture:a.U3,create_sampler:a.QB,create_render_pass:a.Ow,get_image_by_id:a.uq,copy_external_image_to_texture:a.gK,get_image_width:a.Jj,get_image_height:a.kS,webgl_generate_mipmap:a.C7,delete_bind_group_layout:a.WS,begin_default_pass:a.hx,set_render_pipeline:a.EX,set_vertex:a.RS,draw:a.ii,submit_render_pass:a.z0,set_index:a.BK,set_bind_group:a.IL,draw_indexed:a.ci,begin_render_pass:a.PM,set_stencil_ref:a.eu,delete_render_pipeline:a.E5,delete_bind_group:a.Ko,delete_texture:a.FE,delete_sampler:a.hw,delete_buffer:a.EY,delete_device:a.Fb,delete_shader:a.y9,delete_render_pass:a.FL,delete_image:a.Dx}}),n()}catch(e){n(e)}}),1)}},o={};function l(e){var t=o[e];if(void 0!==t)return t.exports;var r=o[e]={id:e,exports:{}};return a[e](r,r.exports,l),r.exports}e="function"==typeof Symbol?Symbol("webpack then"):"__webpack_then__",t="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",r="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",i=e=>{e&&(e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},n=e=>!--e.r&&e(),s=(e,t)=>e?e.push(t):n(t),l.a=(a,o,l)=>{var c,u,d,f=l&&[],h=a.exports,p=!0,g=!1,b=(t,r,i)=>{g||(g=!0,r.r+=t.length,t.map(((t,n)=>t[e](r,i))),g=!1)},v=new Promise(((e,t)=>{d=t,u=()=>(e(h),i(f),f=0)}));v[t]=h,v[e]=(e,t)=>{if(p)return n(e);c&&b(c,e,t),s(f,e),v.catch(t)},a.exports=v,o((a=>{var o;c=(a=>a.map((a=>{if(null!==a&&"object"==typeof a){if(a[e])return a;if(a.then){var o=[];a.then((e=>{l[t]=e,i(o),o=0}),(e=>{l[r]=e,i(o),o=0}));var l={};return l[e]=(e,t)=>(s(o,e),a.catch(t)),l}}var c={};return c[e]=e=>n(e),c[t]=a,c})))(a);var l=()=>c.map((e=>{if(e[r])throw e[r];return e[t]})),u=new Promise(((e,t)=>{(o=()=>e(l)).r=0,b(c,o,t)}));return o.r?u:l()}),(e=>(e&&d(v[r]=e),u()))),p=!1},l.d=(e,t)=>{for(var r in t)l.o(t,r)&&!l.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},l.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.v=(e,t,r,i)=>{var n=fetch(l.p+""+r+".module.wasm");return"function"==typeof WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(n,i).then((t=>Object.assign(e,t.instance.exports))):n.then((e=>e.arrayBuffer())).then((e=>WebAssembly.instantiate(e,i))).then((t=>Object.assign(e,t.instance.exports)))},(()=>{var e;l.g.importScripts&&(e=l.g.location+"");var t=l.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),l.p=e})(),l(439)})();