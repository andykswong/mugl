var e,t;e=self,t=function(){return(()=>{var e={d:(t,r)=>{for(var a in r)e.o(r,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:r[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{begin_default_pass:()=>pr,begin_render_pass:()=>gr,copy_buffer:()=>ir,copy_external_image_to_texture:()=>cr,copy_texture:()=>ur,copy_texture_to_buffer:()=>fr,create_bind_group:()=>rr,create_bind_group_layout:()=>tr,create_buffer:()=>Qt,create_image:()=>Wt,create_render_pass:()=>nr,create_render_pipeline:()=>ar,create_sampler:()=>$t,create_shader:()=>er,create_texture:()=>Zt,delete_bind_group:()=>Rt,delete_bind_group_layout:()=>Rt,delete_buffer:()=>Rt,delete_device:()=>Yt,delete_image:()=>Et,delete_render_pass:()=>Rt,delete_render_pipeline:()=>Rt,delete_sampler:()=>Rt,delete_shader:()=>Rt,delete_texture:()=>Rt,draw:()=>xr,draw_indexed:()=>Fr,free_context:()=>Lt,get_canvas_by_id:()=>zt,get_canvas_height:()=>jt,get_canvas_width:()=>Vt,get_device_features:()=>Kt,get_future_status:()=>At,get_image_by_id:()=>It,get_image_height:()=>Gt,get_image_width:()=>Nt,is_device_lost:()=>Jt,read_buffer:()=>sr,reset_device:()=>Xt,set_bind_group:()=>yr,set_blend_const:()=>vr,set_context_memory:()=>Ut,set_index:()=>br,set_render_pipeline:()=>hr,set_scissor_rect:()=>_r,set_stencil_ref:()=>wr,set_vertex:()=>mr,set_viewport:()=>Sr,submit_render_pass:()=>dr,webgl_generate_mipmap:()=>Ht,webgl_request_device:()=>qt,write_buffer:()=>lr,write_texture:()=>or});var r={};e.r(r),e.d(r,{beginDefaultPass:()=>Ne,beginRenderPass:()=>Ee,copyBuffer:()=>Re,copyExternalImageToTexture:()=>Ae,copyTexture:()=>We,copyTextureToBuffer:()=>Ie,createBindGroup:()=>De,createBindGroupLayout:()=>Oe,createBuffer:()=>ve,createRenderPass:()=>Me,createRenderPipeline:()=>ke,createSampler:()=>Be,createShader:()=>Ce,createTexture:()=>we,draw:()=>He,drawIndexed:()=>Xe,generateMipmap:()=>Ue,getDeviceFeatures:()=>_e,isDeviceLost:()=>Se,readBuffer:()=>Pe,requestWebGL2Device:()=>xe,resetDevice:()=>Fe,setBindGroup:()=>qe,setBlendConst:()=>Ke,setIndex:()=>Ve,setRenderPipeline:()=>ze,setScissorRect:()=>Je,setStencilRef:()=>Qe,setVertex:()=>je,setViewport:()=>Ye,submitRenderPass:()=>Ge,writeBuffer:()=>Te,writeTexture:()=>Le});const a=16384,n=1028,s=1029,l=3089,i=5123,o=5124,c=5125,u=5126,f=7680,g=9728,p=34067,d=34069,h=33984,b=33071,m=36160,y=36161,x=33189,F=36064,S=36096,_=33306,v=3315,w=6144,B=32856,C=32857,M=33190,O=35907,D=34836,k=34842,P=35898,T=36208,R=36214,U=36220,L=36226,A=36232,W=36238,I=36012,E=36013,N=35056,G=33321,z=33323,V=33325,j=33326,q=33327,H=33328,X=33329,Y=33330,J=33331,K=33332,Q=33333,Z=33334,$=33335,ee=33336,te=33337,re=33338,ae=33339,ne=33340,se=36756,le=36757,ie=36759,oe={1:"EXT_texture_filter_anisotropic",2:"OES_texture_half_float_linear",4:"OES_texture_float_linear",8:"EXT_color_buffer_float"};function ce(e){return 32879===e||35866===e}function ue(e){return 15&e}function fe(e){switch(e>>4&511){case 36:return u;case 34:return 5131;case 274:return 5122;case 273:return 5120;case 18:return i;case 17:return 5121}return 0}function ge(e){return!!(e>>13)}function pe(e){switch(e){case G:case se:case V:case j:return 6403;case Y:case X:case K:case J:case Z:case Q:return 36244;case z:case le:case q:case H:return 33319;case ee:case $:case re:case te:case ne:case ae:return 33320;case B:case O:case ie:case C:case k:case D:return 6408;case U:case W:case R:case T:case A:case L:return 36249;case P:return 6407;case x:case M:case I:return 6402;case N:case E:return 34041}return 0}function de(e){switch(e){case G:case Y:case se:case X:return 1;case K:case J:case z:case ee:case le:case $:case V:return 2;case Z:case Q:case j:case re:case te:case q:case B:case O:case U:case ie:case W:case C:case P:return 4;case ne:case ae:case H:case R:case A:case k:return 8;case T:case L:case D:return 16;case x:return 2;case M:case N:case I:return 4;case E:return 8}return 0}function he(e){switch(e){case G:case Y:case z:case ee:case B:case O:case U:return 5121;case se:case X:case le:case $:case ie:case W:return 5120;case K:case re:case R:return i;case J:case te:case A:return 5122;case Z:case ne:case T:return c;case Q:case ae:case L:return o;case C:return 33640;case V:case q:case k:return 5131;case j:case H:case D:return u;case P:return 35899;case x:return i;case M:return c;case N:return 34042;case I:return u;case E:return 36269}return 0}function be(e){switch(e){case X:case J:case Q:case $:case te:case ae:case W:case A:case L:return o;case Y:case K:case Z:case ee:case re:case ne:case U:case R:case T:return c}return u}const me=255,ye=4294967295;function xe(e,t={},r=0){const a=e.getContext("webgl2",t);if(a){let t=0;for(const e in oe)r&+e&&a.getExtension(oe[+e])&&(t|=+e);return{canvas:e,gl:a,features:t,pass:null,state:Ze(a),destroy(){this.gl.deleteFramebuffer(this.state.copyFrameBuffer)}}}return null}function Fe(e){e.destroy(),e.state=Ze(e.gl)}function Se(e){return e.gl.isContextLost()}function _e(e){return e.features}function ve(e,t){const r=64&t.usage?35345:16&t.usage?34963:34962,a=8192&t.usage?35040:4096&t.usage?35048:35044,n=e.gl.createBuffer();return e.gl.bindBuffer(r,n),e.gl.bufferData(r,t.size,a),{gl:e.gl,glb:n,type:r,size:t.size,destroy(){this.gl.deleteBuffer(this.glb)}}}function we(e,t){const r=t.sampleCount||1,a=t.dimension||3553,n=t.format||B,s=!function(e){switch(e){case x:case M:case N:case I:case E:return!0}return!1}(n)||4&(t.usage||0),[l,i,o]=t.size||[1,1,1],c=a===p?6:3553===a?1:o;let u=null,f=null;return(r>1||!s)&&(f=e.gl.createRenderbuffer(),e.gl.bindRenderbuffer(y,f),r>1?e.gl.renderbufferStorageMultisample(y,r,n,l,i):e.gl.renderbufferStorage(y,n,l,i)),s&&(u=e.gl.createTexture(),e.gl.activeTexture(h),e.gl.bindTexture(a,u),ce(a)?e.gl.texStorage3D(a,t.mipLevelCount||1,n,l,i,c):e.gl.texStorage2D(a,t.mipLevelCount||1,n,l,i)),{gl:e.gl,glt:u,glrb:f,type:a,format:n,width:l,height:i,depth:c,samples:r,destroy(){this.gl.deleteTexture(this.glt),this.gl.deleteRenderbuffer(this.glrb)}}}function Be(e,t={}){const r=e.gl.createSampler();let a=t.minFilter||g;return t.mipmapFilter&&(a=t.mipmapFilter===g?a===g?9984:9985:a===g?9986:9987),e.gl.samplerParameteri(r,10241,a),e.gl.samplerParameteri(r,10240,t.magFilter||g),e.gl.samplerParameteri(r,10242,t.addressModeU||b),e.gl.samplerParameteri(r,10243,t.addressModeV||b),e.gl.samplerParameteri(r,32882,t.addressModeW||b),e.gl.samplerParameterf(r,33083,t.lodMaxClamp||32),e.gl.samplerParameterf(r,33082,t.lodMinClamp||0),t.compare&&(e.gl.samplerParameterf(r,34892,34894),e.gl.samplerParameterf(r,34893,t.compare)),(t.maxAnisotropy||1)>1&&e.gl.samplerParameterf(r,34046,Math.min(t.maxAnisotropy||1,e.gl.getParameter(34047))),{gls:r,gl:e.gl,destroy(){this.gl.deleteSampler(this.gls)}}}function Ce(e,t){const r=1===t.usage?35633:35632,a=e.gl.createShader(r);return e.gl.shaderSource(a,t.code),e.gl.compileShader(a),{gl:e.gl,gls:a,destroy(){this.gl.deleteShader(this.gls)}}}function Me(e,t={}){let r=null;const a=[],n=t.depthStencil?t.depthStencil.texture:null,s=n&&function(e){switch(e){case 36168:case N:case E:return!0}return!1}(n.format)||!1;if(t.colors&&t.colors.length){r=e.gl.createFramebuffer(),e.gl.bindFramebuffer(m,r);for(let r=0;r<t.colors.length;++r)t.colors[r].view.texture.samples>1?e.gl.framebufferRenderbuffer(m,F+r,y,t.colors[r].view.texture.glrb):$e(e.gl,F+r,t.colors[r].view);t.colors.length>1&&e.gl.drawBuffers(t.colors.map(((e,t)=>F+t))),n&&(n.glrb?e.gl.framebufferRenderbuffer(m,s?_:S,y,n.glrb):$e(e.gl,s?_:S,t.depthStencil));for(let r=0;r<t.colors.length;++r)a.push(t.colors[r].view.texture.samples>1?et(e.gl,F,t.colors[r].view):null);a.push(n&&n.samples>1&&n.glt?et(e.gl,s?_:S,t.depthStencil):null)}return{gl:e.gl,glfb:r,glrfb:a,depth:n,color:t.colors?t.colors.map((e=>e.view.texture)):[],clearColors:t.colors?t.colors.map((e=>e.clear)):[],clearColor:t.clearColor,clearDepth:t.clearDepth,clearStencil:t.clearStencil,destroy(){this.gl.deleteFramebuffer(this.glfb);for(const e of this.glrfb)this.gl.deleteFramebuffer(e)}}}function Oe(e,t){return{entries:t.entries.map(((e,t)=>({binding:t,...e}))),destroy(){}}}function De(e,t){return{entries:t.entries.map(((e,t)=>({binding:t,...e}))),destroy(){}}}function ke(e,t){const r=function(e,t,r){const a=e.gl.createProgram();return e.gl.attachShader(a,t),e.gl.attachShader(a,r),e.gl.linkProgram(a),a}(e,t.vertex.gls,t.fragment.gls),a=[],n={};let s=0,l=0;if(t.bindGroups){for(let i=0;i<t.bindGroups.length;++i){const o=t.bindGroups[i].entries;a.push([]);for(let t=0;t<o.length;++t){const c=o[t];let u=null,f=4294967295;0===c.type?(f=e.gl.getUniformBlockIndex(r,c.label),e.gl.uniformBlockBinding(r,f,s++)):2===c.type&&(u=e.gl.getUniformLocation(r,c.label),n[c.label]=l++),a[i][c.binding]={...c,loc:u,index:f,slot:0===c.type?s-1:2===c.type?l-1:0}}}for(let e=0;e<t.bindGroups.length;++e){const r=t.bindGroups[e].entries;for(let t=0;t<r.length;++t)1===r[t].type&&n[r[t].label]&&(a[e][r[t].binding].slot=n[r[t].label])}}return{gl:e.gl,glp:r,buffers:t.buffers,cache:a,state:rt(t),destroy(){this.gl.deleteProgram(this.glp)}}}function Pe(e,t,r,a=0){const n={status:0};return function(e,t,r,a,n){const s=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);return e.flush(),function(e,t,r,a){return new Promise(((r,a)=>{!function n(){const s=e.clientWaitSync(t,0,0);37149==s?a():37147==s?setTimeout(n,10):r()}()}))}(e,s).finally((()=>e.deleteSync(s))).then((()=>{const s=new Uint8Array(n);return e.bindBuffer(t,r),e.getBufferSubData(t,a,s,0,n),s}))}(e.gl,t.type,t.glb,a,r.byteLength).then((e=>{r.set(e),n.status=1}),(()=>n.status=2)),n}function Te(e,t,r,a=0){e.gl.bindBuffer(t.type,t.glb),e.gl.bufferSubData(t.type,a,r)}function Re(e,t,r,a=t.size,n=0,s=0){e.gl.bindBuffer(36662,t.glb),e.gl.bindBuffer(36663,r.glb),e.gl.copyBufferSubData(36662,36663,n,s,a)}function Ue(e,t,r=4352){e.gl.activeTexture(h),e.gl.bindTexture(t.type,t.glt),e.gl.hint(33170,r),e.gl.generateMipmap(t.type)}function Le(e,{texture:t,mipLevel:r=0,origin:[a,n,s]=[0,0,0]},l,{offset:i=0,bytesPerRow:o,rowsPerImage:c=0},[u,f,g]=[t.width-a,t.height-n,t.depth-s]){const b=pe(t.format),m=he(t.format),y=t.type===p,x=y?d+s:t.type;e.gl.activeTexture(h),e.gl.bindTexture(t.type,t.glt);const F=de(t.format),S=c||f,_=Math.floor(o/F),w=i-i%o;if(e.gl.pixelStorei(32878,S),e.gl.pixelStorei(3314,_),e.gl.pixelStorei(3316,Math.floor(i%o/F)),e.gl.pixelStorei(v,0),e.gl.pixelStorei(32877,0),ce(t.type))e.gl.texSubImage3D(x,r,a,n,s,u,f,g,t.format,m,l,w);else if(y)for(let t=s;t<s+g;++t)e.gl.pixelStorei(v,t*_*S),e.gl.texSubImage2D(x+t,r,a,n,u,f,b,m,l,w);else e.gl.texSubImage2D(x,r,a,n,u,f,b,m,l,w)}function Ae(e,{src:t,origin:[r,a]=[0,0]},{texture:n,mipLevel:s=0,origin:[l,i,o]=[0,0,0]},[c,u]=[t.width-r,t.height-a]){const f=he(n.format),g=n.type===p?d+o:n.type;e.gl.activeTexture(h),e.gl.bindTexture(n.type,n.glt),e.gl.pixelStorei(3316,r),e.gl.pixelStorei(v,a),e.gl.pixelStorei(32877,0),e.gl.pixelStorei(32878,0),ce(n.type)?e.gl.texSubImage3D(g,s,l,i,o,c,u,1,n.format,f,t):e.gl.texSubImage2D(g,s,l,i,c,u,pe(n.format),f,t)}function We(e,{texture:t,mipLevel:r=0,origin:[a,n,s]=[0,0,0]},{texture:l,mipLevel:i=0,origin:[o,c,u]=[0,0,0]},[f,g,b]=[t.width-a,t.height-n,t.depth-s]){const y=l.type===p,x=y?d+u:l.type;if(e.gl.activeTexture(h),e.gl.bindTexture(l.type,l.glt),e.gl.readBuffer(F),e.gl.bindFramebuffer(m,e.state.copyFrameBuffer),ce(t.type)||t.type===p)for(let p=s;p<s+b;++p)$e(e.gl,F,{texture:t,mipLevel:r,slice:p}),ce(l.type)?e.gl.copyTexSubImage3D(x+(y?p:0),i,o,c,u,a,n,f,g):e.gl.copyTexSubImage2D(x+(y?p:0),i,o,c,a,n,f,g);else{const s=0;$e(e.gl,F,{texture:t,mipLevel:r,slice:s}),ce(l.type)?e.gl.copyTexSubImage3D(x+(y?s:0),i,o,c,u,a,n,f,g):e.gl.copyTexSubImage2D(x+(y?s:0),i,o,c,a,n,f,g)}e.gl.bindFramebuffer(m,e.pass?e.pass.glfb:null)}function Ie(e,{texture:t,mipLevel:r=0,origin:[a,n,s]=[0,0,0]},l,{offset:i=0,bytesPerRow:o,rowsPerImage:c=0},[u,f,g]=[t.width-a,t.height-n,t.depth-s]){e.gl.bindBuffer(35051,l),e.gl.readBuffer(F),e.gl.bindFramebuffer(m,e.state.copyFrameBuffer);const d=he(t.format),h=pe(t.format),b=de(t.format),y=c||f,x=Math.floor(o/b),S=i-i%o;if(e.gl.pixelStorei(3330,x),e.gl.pixelStorei(3332,Math.floor(i%o/b)),e.gl.pixelStorei(3331,0),ce(t.type)||t.type===p)for(let l=s;l<s+g;++l)$e(e.gl,F,{texture:t,mipLevel:r,slice:l}),e.gl.readPixels(a,n,u,f,h,d,S+(l-s)*o*y);else{const s=0;$e(e.gl,F,{texture:t,mipLevel:r,slice:s}),e.gl.readPixels(a,n,u,f,h,d,S)}e.gl.bindFramebuffer(m,e.pass?e.pass.glfb:null)}function Ee(e,t){let r=e.gl.drawingBufferWidth,n=e.gl.drawingBufferHeight;t.color.length&&(r=t.color[0].width,n=t.color[0].height),e.gl.bindFramebuffer(m,t.glfb),e.gl.viewport(0,0,r,n),e.gl.depthRange(0,1),e.state.scissor&&(e.state.scissor=!1,it(e.gl,l,!1));let s=0;if(isNaN(t.clearDepth)||(s|=256,e.gl.clearDepth(t.clearDepth),st(e.gl,e.state.state.depthWrite,!0),e.state.state.depthWrite=!0),isNaN(t.clearStencil)||(s|=1024,e.gl.clearStencil(t.clearStencil),lt(e.gl,e.state.state.stencilWriteMask,me),e.state.state.stencilWriteMask=me),nt(e.gl,e.state.state.blendWriteMask,15),e.state.state.blendWriteMask=15,t.color.length){for(let r=0;r<t.color.length;++r)if(t.clearColors[r]){const a=be(t.color[r].format);a===o?e.gl.clearBufferiv(w,r,t.clearColors[r]):a===c?e.gl.clearBufferuiv(w,r,t.clearColors[r]):e.gl.clearBufferfv(w,r,t.clearColors[r])}}else t.clearColor&&(s|=a,e.gl.clearColor(...t.clearColor));s&&e.gl.clear(s),e.pass=t}function Ne(e,t={}){e.gl.bindFramebuffer(m,null),e.gl.viewport(0,0,e.gl.drawingBufferWidth,e.gl.drawingBufferHeight),e.gl.depthRange(0,1),e.state.scissor&&(e.state.scissor=!1,it(e.gl,l,!1));let r=0;isNaN(t.clearDepth)||(r|=256,e.gl.clearDepth(t.clearDepth),st(e.gl,e.state.state.depthWrite,!0),e.state.state.depthWrite=!0),isNaN(t.clearStencil)||(r|=1024,e.gl.clearStencil(t.clearStencil),lt(e.gl,e.state.state.stencilWriteMask,me),e.state.state.stencilWriteMask=me),t.clearColor&&(r|=a,e.gl.clearColor(...t.clearColor),nt(e.gl,e.state.state.blendWriteMask,15),e.state.state.blendWriteMask=15),r&&e.gl.clear(r),e.pass=null}function Ge(e){if(e.pass){for(let t=0;t<e.pass.color.length;++t)e.pass.glrfb[t]&&tt(e.gl,e.pass.glfb,e.pass.glrfb[t],e.pass.color[t],a,F+t);const t=e.pass.glrfb[e.pass.glrfb.length-1];e.pass.depth&&t&&tt(e.gl,e.pass.glfb,t,e.pass.depth,1280)}e.pass=null}function ze(e,t){if(e.state.pipeline===t)return;e.state.pipeline&&e.state.pipeline.glp===t.glp||e.gl.useProgram(t.glp),at(e.gl,e.state.state,t.state,e.state.stencilRef),Object.assign(e.state.state,t.state);const r=[];for(const{attributes:t}of e.state.buffers)for(const{ptr:e}of t)r[e[0]]=1;e.state.buffers=Array(t.buffers.length);for(let a=0;a<t.buffers.length;++a){const{attributes:n,stride:s,stepMode:l=0}=t.buffers[a],i=[];e.state.buffers[a]={glb:null,attributes:i,stride:s,step:l,offset:0,instanceOffset:0};for(const{format:e,offset:t,shaderLocation:o}of n)r[o]=(r[o]||0)+2,i.push({buffer:a,ptr:[o,ue(e),fe(e),ge(e),s,t],step:l})}for(let t=0;t<r.length;++t)2===r[t]?e.gl.enableVertexAttribArray(t):1===r[t]&&e.gl.disableVertexAttribArray(t);e.state.pipeline=t}function Ve(e,t){t.glb!==e.state.index&&e.gl.bindBuffer(34963,e.state.index=t.glb)}function je(e,t,r,a=0){const n=e.state.buffers[t];!n||n.glb===r.glb&&n.offset===a||(n.glb=r.glb,n.offset=a,n.instanceOffset=0,ot(e.gl,n,a))}function qe(e,t,r,a=[]){if(e.state.pipeline)for(let n=0,s=0;n<r.entries.length;++n){const l=r.entries[n],i=e.state.pipeline.cache[t]&&e.state.pipeline.cache[t][l.binding];if(i)if(l.buffer){let t=l.bufferOffset||0;i.bufferDynamicOffset&&(t+=a[s]||0,++s),e.gl.bindBufferRange(35345,i.slot,l.buffer.glb,t,l.bufferSize||l.buffer.size-t)}else l.texture?(e.gl.activeTexture(h+i.slot),e.gl.bindTexture(l.texture.type,l.texture.glt),e.gl.uniform1i(i.loc,i.slot)):l.sampler&&e.gl.bindSampler(i.slot,l.sampler.gls)}}function He(e,t,r=1,a=0,n=0){for(const t of e.state.buffers)t.step&&t.instanceOffset!==n&&(t.instanceOffset=n,ot(e.gl,t,n*t.stride));e.gl.drawArraysInstanced(e.state.state.topology,a,t,r)}function Xe(e,t,r=1,a=0,n=0){for(const t of e.state.buffers)t.step&&t.instanceOffset!==n&&(t.instanceOffset=n,ot(e.gl,t,n*t.stride));e.gl.drawElementsInstanced(e.state.state.topology,t,e.state.state.indexFormat,a*(e.state.state.indexFormat===i?2:4),r)}function Ye(e,t,r,a,n,s=0,l=1){e.gl.viewport(t,r,a,n),e.gl.depthRange(s,l)}function Je(e,t,r,a,n){e.state.scissor||(it(e.gl,l,!0),e.state.scissor=!0),e.gl.scissor(t,r,a,n)}function Ke(e,t){e.gl.blendColor(...t)}function Qe(e,t){if(e.state.stencilRef!==t){const{stencilFrontCompare:r,stencilBackCompare:a,stencilReadMask:l}=e.state.state;e.gl.stencilFuncSeparate(n,r,t,l),e.gl.stencilFuncSeparate(s,a,t,l),e.state.stencilRef=t}}function Ze(e){const t=rt();e.blendColor(1,1,1,1),at(e,t,t,0,!0);for(let t=0;t<16;++t)e.disableVertexAttribArray(t);return e.pixelStorei(3333,1),e.pixelStorei(3317,1),{copyFrameBuffer:e.createFramebuffer(),buffers:[],state:t,pipeline:null,index:null,stencilRef:0,scissor:!1}}function $e(e,t,{texture:r,slice:a=0,mipLevel:n=0}){if(ce(r.type))e.framebufferTextureLayer(m,t,r.glt,n,a);else{const s=r.type===p?d+a:r.type;e.framebufferTexture2D(m,t,s,r.glt,n)}}function et(e,t,r){const a=e.createFramebuffer();return e.bindFramebuffer(m,a),$e(e,t,r),a}function tt(e,t,r,a,n,s=36064){e.bindFramebuffer(36008,t),e.bindFramebuffer(36009,r),e.readBuffer(s),e.blitFramebuffer(0,0,a.width,a.height,0,0,a.width,a.height,n,g)}function rt(e={}){const t=e.primitive||{},r=e.depthStencil||{},{stencilFront:a={},stencilBack:n={}}=r,{sampleCount:s=1,alphaToCoverage:l=!1}=e.multisample||{},o=e.targets||{};let c=o.writeMask||15,u=o.blendColor||{},g=o.blendColor||{};return o.targets&&o.targets[0]&&(c=o.targets[0].writeMask||c,u=o.targets[0].blendColor||u,g=o.targets[0].blendAlpha||g),{sampleCount:s,alphaToCoverage:l,topology:t.topology||4,indexFormat:t.indexFormat||i,frontFace:t.frontFace||2305,cullMode:t.cullMode||0,depth:!!e.depthStencil,depthWrite:r.depthWrite||!1,depthFormat:r.format||x,depthCompare:r.depthCompare||519,depthBias:r.depthBias||0,depthBiasSlopeScale:r.depthBiasSlopeScale||0,stencil:!(!r.stencilFront&&!r.stencilBack),stencilFrontCompare:a.compare||519,stencilFrontFailOp:a.failOp||f,stencilFrontDepthFailOp:a.depthFailOp||f,stencilFrontPassOp:a.passOp||f,stencilBackCompare:n.compare||519,stencilBackFailOp:n.failOp||f,stencilBackDepthFailOp:n.depthFailOp||f,stencilBackPassOp:n.passOp||f,stencilReadMask:r.stencilReadMask||ye,stencilWriteMask:r.stencilWriteMask||ye,blend:!!e.targets,blendWriteMask:c,blendColorOp:u.operation||32774,blendColorSrcFactor:u.srcFactor||1,blendColorDstFactor:u.dstFactor||0,blendAlphaOp:g.operation||32774,blendAlphaSrcFactor:g.srcFactor||1,blendAlphaDstFactor:g.dstFactor||0}}function at(e,t,r,a=0,l=!1){let i=!1,o=0,c=0,u=0,f=0;o=r.frontFace,(l||t.frontFace!==o)&&e.frontFace(o),o=r.cullMode,(l||t.cullMode!==o)&&((i=0!==o)&&e.cullFace(o),it(e,2884,i)),i=r.alphaToCoverage,(l||t.alphaToCoverage!==i)&&it(e,32926,i),i=!!r.depth,(l||t.depth!==i)&&it(e,2929,i),(l||i)&&(st(e,t.depthWrite,r.depthWrite,l),o=r.depthCompare,(l||t.depthCompare!==o)&&e.depthFunc(o)),o=r.depthBiasSlopeScale,c=r.depthBias,(l||t.depthBiasSlopeScale!==o||t.depthBias!==c)&&(it(e,32823,!(!o&&!c)),e.polygonOffset(o,c)),i=!!r.stencil,(l||t.stencil!==i)&&it(e,2960,i),(l||i)&&(o=r.stencilReadMask,i=l||t.stencilReadMask!==o,c=r.stencilFrontCompare,(i||t.stencilFrontCompare!==c)&&e.stencilFuncSeparate(n,c,a,o),c=r.stencilBackCompare,(i||t.stencilBackCompare!==c)&&e.stencilFuncSeparate(s,c,a,o),o=r.stencilFrontFailOp,c=r.stencilFrontDepthFailOp,u=r.stencilFrontPassOp,(l||t.stencilFrontFailOp!==o||t.stencilFrontDepthFailOp!==c||t.stencilFrontPassOp!==u)&&e.stencilOpSeparate(n,o,c,u),o=r.stencilBackFailOp,c=r.stencilBackDepthFailOp,u=r.stencilBackPassOp,(l||t.stencilBackFailOp!==o||t.stencilBackDepthFailOp!==c||t.stencilBackPassOp!==u)&&e.stencilOpSeparate(s,o,c,u),lt(e,t.stencilWriteMask,r.stencilWriteMask,l)),i=r.blend,(l||t.blend!==i)&&it(e,3042,i),(l||i)&&(o=r.blendColorSrcFactor,c=r.blendColorDstFactor,u=r.blendAlphaSrcFactor,f=r.blendAlphaDstFactor,(l||t.blendColorSrcFactor!==o||t.blendColorDstFactor!==c||t.blendAlphaSrcFactor!==u||t.blendAlphaDstFactor!==f)&&e.blendFuncSeparate(o,c,u,f),o=r.blendColorOp,c=r.blendAlphaOp,(l||t.blendColorOp!==o||t.blendAlphaOp!==c)&&e.blendEquationSeparate(o,c),nt(e,t.blendWriteMask,r.blendWriteMask,l))}function nt(e,t,r,a=!1){(a||t!==r)&&e.colorMask(!!(1&r),!!(2&r),!!(4&r),!!(8&r))}function st(e,t,r,a=!1){(a||t!==r)&&e.depthMask(r)}function lt(e,t,r,a=!1){(a||t!==r)&&e.stencilMask(r)}function it(e,t,r){r?e.enable(t):e.disable(t)}function ot(e,t,r){e.bindBuffer(34962,t.glb);for(let a=0;a<t.attributes.length;++a){const{ptr:n,step:s}=t.attributes[a],l=[...n];l[5]+=r,e.vertexAttribPointer(...l),e.vertexAttribDivisor(n[0],s)}}const ct=2097151,ut=2**32;function ft(e,t){return(t&ct)*ut+(e>>>0)}function gt(e){return e>>>0}let pt,dt;pt=Symbol.iterator;class ht{constructor(){this.generations=[],this.freeList=[]}get size(){return this.generations.length-this.freeList.length}clear(){this.generations.length=0,this.freeList.length=0}create(){let e,t;return this.freeList.length>0?(e=this.freeList.pop(),t=Math.abs(this.generations[e]),this.generations[e]=t):(e=this.generations.length,t=e?0:1,this.generations.push(t)),ft(e,t)}delete(e){if(!this.has(e))return!1;const t=gt(e);let r=-(this.generations[t]+1&ct);return t||r||++r,this.generations[t]=r,this.freeList.push(t),!0}forEach(e,t){let r=0;for(const a of this.values())e.call(t,a,r,this),r+=1}has(e){return gt(e)<this.generations.length&&function(e){return e/ut&ct}(e)===this.generations[gt(e)]}*values(){for(let e=0;e<this.generations.length;++e){const t=this.generations[e];this.generations[e]>=0&&(yield ft(e,t))}}[pt](){return this.values()}}dt=Symbol.iterator;class bt{constructor(){this.allocator=new ht,this.data=[]}add(e){const t=this.allocator.create();return this.data[gt(t)]=e,t}clear(){this.allocator.clear(),this.data.length=0}delete(e){return!!this.allocator.delete(e)&&(delete this.data[gt(e)],!0)}*entries(){for(const e of this.allocator.values())yield[e,this.data[gt(e)]]}forEach(e,t){this.allocator.forEach((r=>{e.call(t,this.data[gt(r)],r,this)}),t)}get(e){return this.has(e)?this.data[gt(e)]:void 0}has(e){return this.allocator.has(e)}keys(){return this.allocator.values()}*values(){for(const e of this.allocator.values())yield this.data[gt(e)]}[dt](){return this.entries()}}const mt=new TextDecoder("utf-8");let yt=new DataView(new ArrayBuffer(0));function xt(e){return yt.buffer!==e.buffer&&(yt=new DataView(e.buffer)),yt}function Ft(e,t,r){return mt.decode(new Uint8Array(e.buffer,t,r))}const St={},_t=new bt,vt=new bt,wt={},Bt=new bt,Ct={},Mt={},Ot=new bt,Dt={},kt=r;function Pt(e){return St[e].memory}function Tt(e){return Pt(Dt[e])}function Rt(e){const t=Ot.get(e);t&&(t.destroy(),Ot.delete(e))}function Ut(e,t){(St[e]=St[e]||{memory:null}).memory=t}function Lt(e){delete St[e]}function At(e){const t=_t.get(e);return t?(0!==t.status&&_t.delete(e),t.status):1}function Wt(e,t,r){const a=new Image;return a.crossOrigin="anonymous",a.src=Ft(Pt(e),t,r),vt.add(a)}function It(e,t,r){const a=Ft(Pt(e),t,r);if(wt[a])return wt[a];const n=document.getElementById(a);return n?wt[a]=vt.add(n):0}function Et(e){vt.delete(e)}function Nt(e){var t;return(null===(t=vt.get(e))||void 0===t?void 0:t.width)||0}function Gt(e){var t;return(null===(t=vt.get(e))||void 0===t?void 0:t.height)||0}function zt(e,t,r){const a=Ft(Pt(e),t,r);if(Ct[a])return Ct[a];const n=document.getElementById(a);if(!n)return 0;const s=Ct[a]=Bt.add(n);return Mt[s]=e,s}function Vt(e){var t;return(null===(t=Bt.get(e))||void 0===t?void 0:t.width)||0}function jt(e){var t;return(null===(t=Bt.get(e))||void 0===t?void 0:t.height)||0}function qt(e,t,r){const a=Bt.get(e);if(a){const s=xe(a,{alpha:!!(1&(n=t)),antialias:!!(2&n),depth:!!(4&n),desynchronized:!!(8&n),failIfMajorPerformanceCaveat:!!(16&n),powerPreference:32&n?"high-performance":"low-power",premultipliedAlpha:!!(64&n),preserveDrawingBuffer:!!(128&n),stencil:!!(256&n)},r);if(s){const t=Ot.add(s);return Dt[t]=Mt[e],t}}var n;return 0}function Ht(e,t,r){Ue(Ot.get(e),Ot.get(t),r)}function Xt(e){kt.resetDevice(Ot.get(e))}function Yt(e){Rt(e),delete Dt[e]}function Jt(e){return kt.isDeviceLost(Ot.get(e))}function Kt(e){return kt.getDeviceFeatures(Ot.get(e))}function Qt(e,t,r){const a=kt.createBuffer(Ot.get(e),{size:t>>>0,usage:r>>>0});return Ot.add(a)}function Zt(e,t,r,a,n,s,l,i,o){const c=kt.createTexture(Ot.get(e),{size:[t>>>0,r>>>0,a>>>0],mipLevelCount:n>>>0,sampleCount:s>>>0,dimension:l>>>0,format:i>>>0,usage:o>>>0});return Ot.add(c)}function $t(e,t,r,a,n,s,l,i,o,c,u){const f=kt.createSampler(Ot.get(e),{addressModeU:t>>>0,addressModeV:r>>>0,addressModeW:a>>>0,magFilter:n>>>0,minFilter:s>>>0,mipmapFilter:l>>>0,lodMinClamp:i,lodMaxClamp:o,compare:c>>>0,maxAnisotropy:u>>>0});return Ot.add(f)}function er(e,t,r,a){const n=kt.createShader(Ot.get(e),{code:Ft(Tt(e),t,r),usage:a>>>0});return Ot.add(n)}function tr(e,t,r){const a=Tt(e),n=[];for(let e=0;e<r;e++){const r=t+32*e,s=xt(a).getUint32(r+0,!0),l=xt(a).getUint32(r+4,!0),i=xt(a).getUint8(r+16);let o=!1,c=0,u=0,f=3553,g=!1;switch(i){case 0:o=!!xt(a).getUint8(r+20);break;case 1:c=xt(a).getUint32(r+20,!0)>>>0;break;case 2:u=xt(a).getUint32(r+20,!0)>>>0,f=xt(a).getUint32(r+24,!0)>>>0,g=!!xt(a).getUint8(r+28);break;default:throw new RangeError("invalid variant discriminant for BindingType")}n.push({label:Ft(a,s,l),binding:xt(a).getUint32(r+8,!0)>>>0,visibility:xt(a).getUint32(r+12,!0)>>>0,type:i,bufferDynamicOffset:o,samplerType:c,textureSampleType:u,textureDimension:f,textureMultisampled:g})}const s=kt.createBindGroupLayout(Ot.get(e),{entries:n});return Ot.add(s)}function rr(e,t,r,a){const n=Tt(e),s=[];for(let e=0;e<a;e++){const t=r+24*e;let a=null,l=0,i=0,o=null,c=null;switch(xt(n).getUint8(t+4)){case 0:a=Ot.get(xt(n).getFloat64(t+8,!0)),l=xt(n).getUint32(t+16,!0),i=xt(n).getUint32(t+20,!0);break;case 1:o=Ot.get(xt(n).getFloat64(t+8,!0));break;case 2:c=Ot.get(xt(n).getFloat64(t+8,!0));break;default:throw new RangeError("invalid variant discriminant for BindingResource")}s.push({binding:xt(n).getUint32(t+0,!0),buffer:a,bufferOffset:l,bufferSize:i,sampler:o,texture:c})}const l=kt.createBindGroup(Ot.get(e),{layout:Ot.get(t),entries:s});return Ot.add(l)}function ar(e,t,r,a,n,s,l,i,o,c,u,f,g,p,d,h,b,m,y,x,F,S,_,v,w,B,C,M,O,D,k,P,T,R,U,L,A,W,I,E,N){const G=Tt(e),z=[];for(let e=0;e<n;e++){const t=a+12*e;z.push({format:xt(G).getUint32(t+0,!0),offset:xt(G).getUint32(t+4,!0),shaderLocation:xt(G).getUint32(t+8,!0)})}const V=[];for(let e=0;e<l;e++){const t=s+16*e,r=xt(G).getUint32(t+0,!0),a=xt(G).getUint32(t+4,!0);V.push({attributes:z.slice(r,r+a),stride:xt(G).getUint32(t+8,!0),stepMode:xt(G).getUint32(t+12,!0)})}const j=[];for(let e=0;e<o;e++){const t=i+8*e;j.push(Ot.get(xt(G).getFloat64(t+0,!0)))}const q=[];for(let e=0;e<R;e++){const t=T+32*e;q.push({format:xt(G).getUint32(t+0,!0)>>>0,writeMask:xt(G).getUint32(t+4,!0)>>>0,blendColor:{operation:xt(G).getUint32(t+8,!0)>>>0,srcFactor:xt(G).getUint32(t+12,!0)>>>0,dstFactor:xt(G).getUint32(t+16,!0)>>>0},blendAlpha:{operation:xt(G).getUint32(t+20,!0)>>>0,srcFactor:xt(G).getUint32(t+24,!0)>>>0,dstFactor:xt(G).getUint32(t+28,!0)>>>0}})}const H=kt.createRenderPipeline(Ot.get(e),{vertex:Ot.get(t),fragment:Ot.get(r),buffers:V,bindGroups:j,primitive:{topology:c>>>0,indexFormat:u>>>0,frontFace:f>>>0,cullMode:g>>>0},multisample:{sampleCount:p>>>0,alphaToCoverage:!!d},depthStencil:h?{format:b>>>0,depthWrite:!!m,depthCompare:y>>>0,stencilFront:{compare:x>>>0,failOp:F>>>0,depthFailOp:S>>>0,passOp:_>>>0},stencilBack:{compare:v>>>0,failOp:w>>>0,depthFailOp:B>>>0,passOp:C>>>0},stencilReadMask:M>>>0,stencilWriteMask:O>>>0,depthBias:D,depthBiasSlopeScale:k,depthBiasClamp:P}:null,targets:{writeMask:U>>>0,blendColor:{operation:L>>>0,srcFactor:A>>>0,dstFactor:W>>>0},blendAlpha:{operation:I>>>0,srcFactor:E>>>0,dstFactor:N>>>0},targets:q}});return Ot.add(H)}function nr(e,t,r,a,n,s,l,i,o,c,u,f,g){const p=Tt(e);let d;switch(i){case 0:d={clearDepth:t,clearStencil:r,clearColor:isNaN(a)?null:[a,n,s,l]};break;case 1:{const e=[];for(let t=0;t<g;t++){const r=f+32*t,a=[xt(p).getFloat32(r+16,!0),xt(p).getFloat32(r+20,!0),xt(p).getFloat32(r+24,!0),xt(p).getFloat32(r+28,!0)];e.push({view:{texture:Ot.get(xt(p).getFloat64(r+0,!0)),mipLevel:xt(p).getUint32(r+8,!0),slice:xt(p).getUint32(r+12,!0)},clear:isNaN(a[0])?null:a})}d={clearDepth:t,clearStencil:r,colors:e,depthStencil:{texture:Ot.get(o),mipLevel:c>>>0,slice:u>>>0}};break}default:throw new RangeError("invalid variant discriminant for RenderPassDescriptor")}const h=kt.createRenderPass(Ot.get(e),d);return Ot.add(h)}function sr(e,t,r,a,n){const s=kt.readBuffer(Ot.get(e),Ot.get(t),new Uint8Array(Tt(e).buffer.slice(a,a+1*n),r>>>0));return _t.add(s)}function lr(e,t,r,a,n){kt.writeBuffer(Ot.get(e),Ot.get(t),new Uint8Array(Tt(e).buffer.slice(r,r+1*a)),n>>>0)}function ir(e,t,r,a,n,s){kt.copyBuffer(Ot.get(e),Ot.get(t),Ot.get(r),a>>>0,n>>>0,s>>>0)}function or(e,t,r,a,n,s,l,i,o,c,u,f,g,p){kt.writeTexture(Ot.get(e),{texture:Ot.get(t),mipLevel:r>>>0,origin:[a>>>0,n>>>0,s>>>0]},new Uint8Array(Tt(e).buffer.slice(l,l+1*i)),{offset:o>>>0,bytesPerRow:c>>>0,rowsPerImage:u>>>0},[f>>>0,g>>>0,p>>>0])}function cr(e,t,r,a,n,s,l,i,o,c,u){kt.copyExternalImageToTexture(Ot.get(e),{src:vt.get(t),origin:[r>>>0,a>>>0]},{texture:Ot.get(n),mipLevel:s>>>0,origin:[l>>>0,i>>>0,o>>>0]},[c>>>0,u>>>0])}function ur(e,t,r,a,n,s,l,i,o,c,u,f,g,p){kt.copyTexture(Ot.get(e),{texture:Ot.get(t),mipLevel:r>>>0,origin:[a>>>0,n>>>0,s>>>0]},{texture:Ot.get(l),mipLevel:i>>>0,origin:[o>>>0,c>>>0,u>>>0]},[f>>>0,g>>>0,p>>>0])}function fr(e,t,r,a,n,s,l,i,o,c,u,f,g){kt.copyTextureToBuffer(Ot.get(e),{texture:Ot.get(t),mipLevel:r>>>0,origin:[a>>>0,n>>>0,s>>>0]},Ot.get(l),{offset:i>>>0,bytesPerRow:o>>>0,rowsPerImage:c>>>0},[u>>>0,f>>>0,g>>>0])}function gr(e,t){kt.beginRenderPass(Ot.get(e),Ot.get(t))}function pr(e,t,r,a,n,s,l){kt.beginDefaultPass(Ot.get(e),{clearColor:isNaN(a)?null:[a,n,s,l],clearDepth:t,clearStencil:r})}function dr(e){kt.submitRenderPass(Ot.get(e))}function hr(e,t){kt.setRenderPipeline(Ot.get(e),Ot.get(t))}function br(e,t){kt.setIndex(Ot.get(e),Ot.get(t))}function mr(e,t,r,a){kt.setVertex(Ot.get(e),t>>>0,Ot.get(r),a>>>0)}function yr(e,t,r,a,n){kt.setBindGroup(Ot.get(e),t>>>0,Ot.get(r),new Uint32Array(Tt(e).buffer.slice(a,a+4*n)))}function xr(e,t,r,a,n){kt.draw(Ot.get(e),t>>>0,r>>>0,a>>>0,n>>>0)}function Fr(e,t,r,a,n){kt.drawIndexed(Ot.get(e),t>>>0,r>>>0,a>>>0,n>>>0)}function Sr(e,t,r,a,n,s,l){kt.setViewport(Ot.get(e),t>>>0,r>>>0,a>>>0,n>>>0,s>>>0,l>>>0)}function _r(e,t,r,a,n){kt.setScissorRect(Ot.get(e),t>>>0,r>>>0,a>>>0,n>>>0)}function vr(e,t,r,a,n){kt.setBlendConst(Ot.get(e),[t,r,a,n])}function wr(e,t){kt.setStencilRef(Ot.get(e),t>>>0)}return t})()},"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("mugl",[],t):"object"==typeof exports?exports.mugl=t():e.mugl=t();