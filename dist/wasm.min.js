var e,t;e=self,t=function(){return(()=>{var e={d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{begin_default_pass:()=>Wt,begin_render_pass:()=>Ut,copy_buffer:()=>Bt,copy_external_image_to_texture:()=>Ot,copy_texture:()=>Dt,copy_texture_to_buffer:()=>Pt,create_bind_group:()=>St,create_bind_group_layout:()=>_t,create_buffer:()=>mt,create_image:()=>nt,create_render_pass:()=>wt,create_render_pipeline:()=>vt,create_sampler:()=>xt,create_shader:()=>Ft,create_texture:()=>yt,delete_bind_group:()=>$e,delete_bind_group_layout:()=>$e,delete_buffer:()=>$e,delete_device:()=>dt,delete_image:()=>st,delete_render_pass:()=>$e,delete_render_pipeline:()=>$e,delete_sampler:()=>$e,delete_shader:()=>$e,delete_texture:()=>$e,draw:()=>It,draw_indexed:()=>Et,free_context:()=>tt,get_canvas_by_id:()=>ot,get_canvas_height:()=>ft,get_canvas_width:()=>ct,get_device_features:()=>bt,get_future_status:()=>rt,get_image_by_id:()=>at,get_image_height:()=>it,get_image_width:()=>lt,is_device_lost:()=>ht,read_buffer:()=>Ct,reset_device:()=>pt,set_bind_group:()=>zt,set_blend_const:()=>Gt,set_context_memory:()=>et,set_index:()=>At,set_render_pipeline:()=>Tt,set_scissor_rect:()=>jt,set_stencil_ref:()=>Vt,set_vertex:()=>Lt,set_viewport:()=>Nt,submit_render_pass:()=>Rt,webgl_generate_mipmap:()=>gt,webgl_request_device:()=>ut,write_buffer:()=>kt,write_texture:()=>Mt});const r=16384,n=1028,a=1029,s=3089,l=5123,i=5124,o=5125,c=5126,f=7680,u=9728,g=34067,p=34069,d=33984,h=33071,b=36160,m=36161,y=33189,x=36064,F=36096,_=33306,S=3315,v=6144,w=32856,C=32857,k=33190,B=35907,M=34836,O=34842,D=35898,P=36208,U=36214,W=36220,R=36226,T=36232,A=36238,L=36012,z=36013,I=35056,E=33321,N=33323,j=33325,G=33326,V=33327,q=33328,H=33329,X=33330,Y=33331,J=33332,K=33333,Q=33334,Z=33335,$=33336,ee=33337,te=33338,re=33339,ne=33340,ae=36756,se=36757,le=36759,ie={1:"EXT_texture_filter_anisotropic",2:"OES_texture_half_float_linear",4:"OES_texture_float_linear",8:"EXT_color_buffer_float"};function oe(e){return 32879===e||35866===e}function ce(e){return 15&e}function fe(e){switch(e>>4&511){case 36:return c;case 34:return 5131;case 274:return 5122;case 273:return 5120;case 18:return l;case 17:return 5121}return 0}function ue(e){return!!(e>>13)}function ge(e){switch(e){case E:case ae:case j:case G:return 6403;case X:case H:case J:case Y:case Q:case K:return 36244;case N:case se:case V:case q:return 33319;case $:case Z:case te:case ee:case ne:case re:return 33320;case w:case B:case le:case C:case O:case M:return 6408;case W:case A:case U:case P:case T:case R:return 36249;case D:return 6407;case y:case k:case L:return 6402;case I:case z:return 34041}return 0}function pe(e){switch(e){case E:case X:case ae:case H:return 1;case J:case Y:case N:case $:case se:case Z:case j:return 2;case Q:case K:case G:case te:case ee:case V:case w:case B:case W:case le:case A:case C:case D:return 4;case ne:case re:case q:case U:case T:case O:return 8;case P:case R:case M:return 16;case y:return 2;case k:case I:case L:return 4;case z:return 8}return 0}function de(e){switch(e){case E:case X:case N:case $:case w:case B:case W:return 5121;case ae:case H:case se:case Z:case le:case A:return 5120;case J:case te:case U:return l;case Y:case ee:case T:return 5122;case Q:case ne:case P:return o;case K:case re:case R:return i;case C:return 33640;case j:case V:case O:return 5131;case G:case q:case M:return c;case D:return 35899;case y:return l;case k:return o;case I:return 34042;case L:return c;case z:return 36269}return 0}function he(e){switch(e){case H:case Y:case K:case Z:case ee:case re:case A:case T:case R:return i;case X:case J:case Q:case $:case te:case ne:case W:case U:case P:return o}return c}const be=255,me=4294967295;let ye=null;function xe(e){const t=ve();e.blendColor(1,1,1,1),we(e,t,t,0,!0);for(let t=0;t<16;++t)e.disableVertexAttribArray(t);return e.pixelStorei(3333,1),e.pixelStorei(3317,1),{copyFrameBuffer:e.createFramebuffer(),buffers:[],state:t,pipeline:null,index:null,stencilRef:0,scissor:!1}}function Fe(e,t,{texture:r,slice:n=0,mipLevel:a=0}){if(oe(r.type))e.framebufferTextureLayer(b,t,r.glt,a,n);else{const s=r.type===g?p+n:r.type;e.framebufferTexture2D(b,t,s,r.glt,a)}}function _e(e,t,r){const n=e.createFramebuffer();return e.bindFramebuffer(b,n),Fe(e,t,r),n}function Se(e,t,r,n,a,s=36064){e.bindFramebuffer(36008,t),e.bindFramebuffer(36009,r),e.readBuffer(s),e.blitFramebuffer(0,0,n.width,n.height,0,0,n.width,n.height,a,u)}function ve(e={}){const t=e.primitive||{},r=e.depthStencil||{},{stencilFront:n={},stencilBack:a={}}=r,{sampleCount:s=1,alphaToCoverage:i=!1}=e.multisample||{},o=e.targets||{};let c=o.writeMask||15,u=o.blendColor||{},g=o.blendColor||{};return o.targets&&o.targets[0]&&(c=o.targets[0].writeMask||c,u=o.targets[0].blendColor||u,g=o.targets[0].blendAlpha||g),{sampleCount:s,alphaToCoverage:i,topology:t.topology||4,indexFormat:t.indexFormat||l,frontFace:t.frontFace||2305,cullMode:t.cullMode||0,depth:!!e.depthStencil,depthWrite:r.depthWrite||!1,depthFormat:r.format||y,depthCompare:r.depthCompare||519,depthBias:r.depthBias||0,depthBiasSlopeScale:r.depthBiasSlopeScale||0,stencil:!(!r.stencilFront&&!r.stencilBack),stencilFrontCompare:n.compare||519,stencilFrontFailOp:n.failOp||f,stencilFrontDepthFailOp:n.depthFailOp||f,stencilFrontPassOp:n.passOp||f,stencilBackCompare:a.compare||519,stencilBackFailOp:a.failOp||f,stencilBackDepthFailOp:a.depthFailOp||f,stencilBackPassOp:a.passOp||f,stencilReadMask:r.stencilReadMask||me,stencilWriteMask:r.stencilWriteMask||me,blend:!!e.targets,blendWriteMask:c,blendColorOp:u.operation||32774,blendColorSrcFactor:u.srcFactor||1,blendColorDstFactor:u.dstFactor||0,blendAlphaOp:g.operation||32774,blendAlphaSrcFactor:g.srcFactor||1,blendAlphaDstFactor:g.dstFactor||0}}function we(e,t,r,s=0,l=!1){let i=!1,o=0,c=0,f=0,u=0;o=r.frontFace,(l||t.frontFace!==o)&&e.frontFace(o),o=r.cullMode,(l||t.cullMode!==o)&&((i=0!==o)&&e.cullFace(o),Me(e,2884,i)),i=r.alphaToCoverage,(l||t.alphaToCoverage!==i)&&Me(e,32926,i),i=!!r.depth,(l||t.depth!==i)&&Me(e,2929,i),(l||i)&&(ke(e,t.depthWrite,r.depthWrite,l),o=r.depthCompare,(l||t.depthCompare!==o)&&e.depthFunc(o)),o=r.depthBiasSlopeScale,c=r.depthBias,(l||t.depthBiasSlopeScale!==o||t.depthBias!==c)&&(Me(e,32823,!(!o&&!c)),e.polygonOffset(o,c)),i=!!r.stencil,(l||t.stencil!==i)&&Me(e,2960,i),(l||i)&&(o=r.stencilReadMask,i=l||t.stencilReadMask!==o,c=r.stencilFrontCompare,(i||t.stencilFrontCompare!==c)&&e.stencilFuncSeparate(n,c,s,o),c=r.stencilBackCompare,(i||t.stencilBackCompare!==c)&&e.stencilFuncSeparate(a,c,s,o),o=r.stencilFrontFailOp,c=r.stencilFrontDepthFailOp,f=r.stencilFrontPassOp,(l||t.stencilFrontFailOp!==o||t.stencilFrontDepthFailOp!==c||t.stencilFrontPassOp!==f)&&e.stencilOpSeparate(n,o,c,f),o=r.stencilBackFailOp,c=r.stencilBackDepthFailOp,f=r.stencilBackPassOp,(l||t.stencilBackFailOp!==o||t.stencilBackDepthFailOp!==c||t.stencilBackPassOp!==f)&&e.stencilOpSeparate(a,o,c,f),Be(e,t.stencilWriteMask,r.stencilWriteMask,l)),i=r.blend,(l||t.blend!==i)&&Me(e,3042,i),(l||i)&&(o=r.blendColorSrcFactor,c=r.blendColorDstFactor,f=r.blendAlphaSrcFactor,u=r.blendAlphaDstFactor,(l||t.blendColorSrcFactor!==o||t.blendColorDstFactor!==c||t.blendAlphaSrcFactor!==f||t.blendAlphaDstFactor!==u)&&e.blendFuncSeparate(o,c,f,u),o=r.blendColorOp,c=r.blendAlphaOp,(l||t.blendColorOp!==o||t.blendAlphaOp!==c)&&e.blendEquationSeparate(o,c),Ce(e,t.blendWriteMask,r.blendWriteMask,l))}function Ce(e,t,r,n=!1){(n||t!==r)&&e.colorMask(!!(1&r),!!(2&r),!!(4&r),!!(8&r))}function ke(e,t,r,n=!1){(n||t!==r)&&e.depthMask(r)}function Be(e,t,r,n=!1){(n||t!==r)&&e.stencilMask(r)}function Me(e,t,r){r?e.enable(t):e.disable(t)}function Oe(e,t,r){e.bindBuffer(34962,t.glb);for(let n=0;n<t.attributes.length;++n){const{ptr:a,step:s}=t.attributes[n],l=[...a];l[5]+=r,e.vertexAttribPointer(...l),e.vertexAttribDivisor(a[0],s)}}ye=new FinalizationRegistry((({finalizer:e,gl:t})=>{e(t)}));const De=2097151,Pe=2**32;function Ue(e,t){return(t&De)*Pe+(e>>>0)}function We(e){return e>>>0}let Re,Te;Re=Symbol.iterator;class Ae{constructor(){this.generations=[],this.freeList=[]}get size(){return this.generations.length-this.freeList.length}clear(){this.generations.length=0,this.freeList.length=0}create(){let e,t;return this.freeList.length>0?(e=this.freeList.pop(),t=Math.abs(this.generations[e]),this.generations[e]=t):(e=this.generations.length,t=e?0:1,this.generations.push(t)),Ue(e,t)}delete(e){if(!this.has(e))return!1;const t=We(e);let r=-(this.generations[t]+1&De);return t||r||++r,this.generations[t]=r,this.freeList.push(t),!0}forEach(e,t){let r=0;for(const n of this.values())e.call(t,n,r,this),r+=1}has(e){return We(e)<this.generations.length&&function(e){return e/Pe&De}(e)===this.generations[We(e)]}*values(){for(let e=0;e<this.generations.length;++e){const t=this.generations[e];this.generations[e]>=0&&(yield Ue(e,t))}}[Re](){return this.values()}}Te=Symbol.iterator;class Le{constructor(){this.allocator=new Ae,this.data=[]}add(e){const t=this.allocator.create();return this.data[We(t)]=e,t}clear(){this.allocator.clear(),this.data.length=0}delete(e){return!!this.allocator.delete(e)&&(delete this.data[We(e)],!0)}*entries(){for(const e of this.allocator.values())yield[e,this.data[We(e)]]}forEach(e,t){this.allocator.forEach((r=>{e.call(t,this.data[We(r)],r,this)}),t)}get(e){return this.has(e)?this.data[We(e)]:void 0}has(e){return this.allocator.has(e)}keys(){return this.allocator.values()}*values(){for(const e of this.allocator.values())yield this.data[We(e)]}[Te](){return this.entries()}}const ze=new TextDecoder("utf-8");let Ie=new DataView(new ArrayBuffer(0));function Ee(e){return Ie.buffer!==e.buffer&&(Ie=new DataView(e.buffer)),Ie}function Ne(e,t,r){return ze.decode(new Uint8Array(e.buffer,t,r))}const je={},Ge=new Le,Ve=new Le,qe={},He=new Le,Xe={},Ye={},Je=new Le,Ke={};function Qe(e){return je[e].memory}function Ze(e){return Qe(Ke[e])}function $e(e){const t=Je.get(e);t&&(t.destroy(),Je.delete(e))}function et(e,t){(je[e]=je[e]||{memory:null}).memory=t}function tt(e){delete je[e]}function rt(e){const t=Ge.get(e);return t?(0!==t.status&&Ge.delete(e),t.status):1}function nt(e,t,r){const n=new Image;return n.crossOrigin="anonymous",n.src=Ne(Qe(e),t,r),Ve.add(n)}function at(e,t,r){const n=Ne(Qe(e),t,r);if(qe[n])return qe[n];const a=document.getElementById(n);return a?qe[n]=Ve.add(a):0}function st(e){Ve.delete(e)}function lt(e){var t;return(null===(t=Ve.get(e))||void 0===t?void 0:t.width)||0}function it(e){var t;return(null===(t=Ve.get(e))||void 0===t?void 0:t.height)||0}function ot(e,t,r){const n=Ne(Qe(e),t,r);if(Xe[n])return Xe[n];const a=document.getElementById(n);if(!a)return 0;const s=Xe[n]=He.add(a);return Ye[s]=e,s}function ct(e){var t;return(null===(t=He.get(e))||void 0===t?void 0:t.width)||0}function ft(e){var t;return(null===(t=He.get(e))||void 0===t?void 0:t.height)||0}function ut(e,t,r){const n=He.get(e);if(n){const s=function(e,t={},r=0){const n=e.getContext("webgl2",t);if(n){let t=0;for(const e in ie)r&+e&&n.getExtension(ie[+e])&&(t|=+e);const a=xe(n),s=e=>{e.deleteFramebuffer(a.copyFrameBuffer)},l={canvas:e,gl:n,state:a,features:t,pass:null,destroy(){s(this.gl)}};return ye.register(new WeakRef(l),{finalizer:s,gl:n}),l}return null}(n,{alpha:!!(1&(a=t)),antialias:!!(2&a),depth:!!(4&a),desynchronized:!!(8&a),failIfMajorPerformanceCaveat:!!(16&a),powerPreference:32&a?"high-performance":"low-power",premultipliedAlpha:!!(64&a),preserveDrawingBuffer:!!(128&a),stencil:!!(256&a)},r);if(s){const t=Je.add(s);return Ke[t]=Ye[e],t}}var a;return 0}function gt(e,t,r){!function(e,t,r=4352){e.gl.activeTexture(d),e.gl.bindTexture(t.type,t.glt),e.gl.hint(33170,r),e.gl.generateMipmap(t.type)}(Je.get(e),Je.get(t),r)}function pt(e){!function(e){e.destroy(),Object.assign(e.state,xe(e.gl))}(Je.get(e))}function dt(e){$e(e),delete Ke[e]}function ht(e){return function(e){return e.gl.isContextLost()}(Je.get(e))}function bt(e){return function(e){return e.features}(Je.get(e))}function mt(e,t,r){const n=function(e,t){const r=64&t.usage?35345:16&t.usage?34963:34962,n=8192&t.usage?35040:4096&t.usage?35048:35044,a=e.gl.createBuffer();e.gl.bindBuffer(r,a),e.gl.bufferData(r,t.size,n);const s=e=>{e.deleteBuffer(a)},l={gl:e.gl,glb:a,type:r,size:t.size,destroy(){s(this.gl)}};return ye.register(new WeakRef(l),{finalizer:s,gl:e.gl}),l}(Je.get(e),{size:t>>>0,usage:r>>>0});return Je.add(n)}function yt(e,t,r,n,a,s,l,i,o){const c=function(e,t){const r=t.sampleCount||1,n=t.dimension||3553,a=t.format||w,s=!function(e){switch(e){case y:case k:case I:case L:case z:return!0}return!1}(a)||4&(t.usage||0),[l,i,o]=t.size||[1,1,1],c=n===g?6:3553===n?1:o;let f=null,u=null;(r>1||!s)&&(u=e.gl.createRenderbuffer(),e.gl.bindRenderbuffer(m,u),r>1?e.gl.renderbufferStorageMultisample(m,r,a,l,i):e.gl.renderbufferStorage(m,a,l,i)),s&&(f=e.gl.createTexture(),e.gl.activeTexture(d),e.gl.bindTexture(n,f),oe(n)?e.gl.texStorage3D(n,t.mipLevelCount||1,a,l,i,c):e.gl.texStorage2D(n,t.mipLevelCount||1,a,l,i));const p=e=>{e.deleteTexture(f),e.deleteRenderbuffer(u)},h={gl:e.gl,glt:f,glrb:u,type:n,format:a,width:l,height:i,depth:c,samples:r,destroy(){p(this.gl)}};return ye.register(new WeakRef(h),{finalizer:p,gl:e.gl}),h}(Je.get(e),{size:[t>>>0,r>>>0,n>>>0],mipLevelCount:a>>>0,sampleCount:s>>>0,dimension:l>>>0,format:i>>>0,usage:o>>>0});return Je.add(c)}function xt(e,t,r,n,a,s,l,i,o,c,f){const g=function(e,t={}){const r=e.gl.createSampler();let n=t.minFilter||u;t.mipmapFilter&&(n=t.mipmapFilter===u?n===u?9984:9985:n===u?9986:9987),e.gl.samplerParameteri(r,10241,n),e.gl.samplerParameteri(r,10240,t.magFilter||u),e.gl.samplerParameteri(r,10242,t.addressModeU||h),e.gl.samplerParameteri(r,10243,t.addressModeV||h),e.gl.samplerParameteri(r,32882,t.addressModeW||h),e.gl.samplerParameterf(r,33083,t.lodMaxClamp||32),e.gl.samplerParameterf(r,33082,t.lodMinClamp||0),t.compare&&(e.gl.samplerParameterf(r,34892,34894),e.gl.samplerParameterf(r,34893,t.compare)),(t.maxAnisotropy||1)>1&&e.gl.samplerParameterf(r,34046,Math.min(t.maxAnisotropy||1,e.gl.getParameter(34047)));const a=e=>{e.deleteSampler(r)},s={gls:r,gl:e.gl,destroy(){a(this.gl)}};return ye.register(new WeakRef(s),{finalizer:a,gl:e.gl}),s}(Je.get(e),{addressModeU:t>>>0,addressModeV:r>>>0,addressModeW:n>>>0,magFilter:a>>>0,minFilter:s>>>0,mipmapFilter:l>>>0,lodMinClamp:i,lodMaxClamp:o,compare:c>>>0,maxAnisotropy:f>>>0});return Je.add(g)}function Ft(e,t,r,n){const a=function(e,t){const r=1===t.usage?35633:35632,n=e.gl.createShader(r);e.gl.shaderSource(n,t.code),e.gl.compileShader(n);const a=e=>{e.deleteShader(n)},s={gl:e.gl,gls:n,destroy(){a(this.gl)}};return ye.register(new WeakRef(s),{finalizer:a,gl:e.gl}),s}(Je.get(e),{code:Ne(Ze(e),t,r),usage:n>>>0});return Je.add(a)}function _t(e,t,r){const n=Ze(e),a=[];for(let e=0;e<r;e++){const r=t+32*e,s=Ee(n).getUint32(r+0,!0),l=Ee(n).getUint32(r+4,!0),i=Ee(n).getUint8(r+16);let o=!1,c=0,f=0,u=3553,g=!1;switch(i){case 0:o=!!Ee(n).getUint8(r+20);break;case 1:c=Ee(n).getUint32(r+20,!0)>>>0;break;case 2:f=Ee(n).getUint32(r+20,!0)>>>0,u=Ee(n).getUint32(r+24,!0)>>>0,g=!!Ee(n).getUint8(r+28);break;default:throw new RangeError("invalid variant discriminant for BindingType")}a.push({label:Ne(n,s,l),binding:Ee(n).getUint32(r+8,!0)>>>0,visibility:Ee(n).getUint32(r+12,!0)>>>0,type:i,bufferDynamicOffset:o,samplerType:c,textureSampleType:f,textureDimension:u,textureMultisampled:g})}const s=(Je.get(e),{entries:{entries:a}.entries.map(((e,t)=>({binding:t,...e}))),destroy(){}});return Je.add(s)}function St(e,t,r,n){const a=Ze(e),s=[];for(let e=0;e<n;e++){const t=r+24*e;let n=null,l=0,i=0,o=null,c=null;switch(Ee(a).getUint8(t+4)){case 0:n=Je.get(Ee(a).getFloat64(t+8,!0)),l=Ee(a).getUint32(t+16,!0),i=Ee(a).getUint32(t+20,!0);break;case 1:o=Je.get(Ee(a).getFloat64(t+8,!0));break;case 2:c=Je.get(Ee(a).getFloat64(t+8,!0));break;default:throw new RangeError("invalid variant discriminant for BindingResource")}s.push({binding:Ee(a).getUint32(t+0,!0),buffer:n,bufferOffset:l,bufferSize:i,sampler:o,texture:c})}const l=(Je.get(e),{entries:{layout:Je.get(t),entries:s}.entries.map(((e,t)=>({binding:t,...e}))),destroy(){}});return Je.add(l)}function vt(e,t,r,n,a,s,l,i,o,c,f,u,g,p,d,h,b,m,y,x,F,_,S,v,w,C,k,B,M,O,D,P,U,W,R,T,A,L,z,I,E){const N=Ze(e),j=[];for(let e=0;e<a;e++){const t=n+12*e;j.push({format:Ee(N).getUint32(t+0,!0),offset:Ee(N).getUint32(t+4,!0),shaderLocation:Ee(N).getUint32(t+8,!0)})}const G=[];for(let e=0;e<l;e++){const t=s+16*e,r=Ee(N).getUint32(t+0,!0),n=Ee(N).getUint32(t+4,!0);G.push({attributes:j.slice(r,r+n),stride:Ee(N).getUint32(t+8,!0),stepMode:Ee(N).getUint32(t+12,!0)})}const V=[];for(let e=0;e<o;e++){const t=i+8*e;V.push(Je.get(Ee(N).getFloat64(t+0,!0)))}const q=[];for(let e=0;e<W;e++){const t=U+32*e;q.push({format:Ee(N).getUint32(t+0,!0)>>>0,writeMask:Ee(N).getUint32(t+4,!0)>>>0,blendColor:{operation:Ee(N).getUint32(t+8,!0)>>>0,srcFactor:Ee(N).getUint32(t+12,!0)>>>0,dstFactor:Ee(N).getUint32(t+16,!0)>>>0},blendAlpha:{operation:Ee(N).getUint32(t+20,!0)>>>0,srcFactor:Ee(N).getUint32(t+24,!0)>>>0,dstFactor:Ee(N).getUint32(t+28,!0)>>>0}})}const H=function(e,t){const r=function(e,t,r){const n=e.gl.createProgram();return e.gl.attachShader(n,t),e.gl.attachShader(n,r),e.gl.linkProgram(n),n}(e,t.vertex.gls,t.fragment.gls),n=[],a={};let s=0,l=0;if(t.bindGroups){for(let i=0;i<t.bindGroups.length;++i){const o=t.bindGroups[i].entries;n.push([]);for(let t=0;t<o.length;++t){const c=o[t];let f=null,u=4294967295;0===c.type?(u=e.gl.getUniformBlockIndex(r,c.label),e.gl.uniformBlockBinding(r,u,s++)):2===c.type&&(f=e.gl.getUniformLocation(r,c.label),a[c.label]=l++),n[i][c.binding]={...c,loc:f,index:u,slot:0===c.type?s-1:2===c.type?l-1:0}}}for(let e=0;e<t.bindGroups.length;++e){const r=t.bindGroups[e].entries;for(let t=0;t<r.length;++t)1===r[t].type&&a[r[t].label]&&(n[e][r[t].binding].slot=a[r[t].label])}}const i=e=>{e.deleteProgram(r)},o={gl:e.gl,glp:r,buffers:t.buffers,cache:n,state:ve(t),destroy(){i(this.gl)}};return ye.register(new WeakRef(o),{finalizer:i,gl:e.gl}),o}(Je.get(e),{vertex:Je.get(t),fragment:Je.get(r),buffers:G,bindGroups:V,primitive:{topology:c>>>0,indexFormat:f>>>0,frontFace:u>>>0,cullMode:g>>>0},multisample:{sampleCount:p>>>0,alphaToCoverage:!!d},depthStencil:h?{format:b>>>0,depthWrite:!!m,depthCompare:y>>>0,stencilFront:{compare:x>>>0,failOp:F>>>0,depthFailOp:_>>>0,passOp:S>>>0},stencilBack:{compare:v>>>0,failOp:w>>>0,depthFailOp:C>>>0,passOp:k>>>0},stencilReadMask:B>>>0,stencilWriteMask:M>>>0,depthBias:O,depthBiasSlopeScale:D,depthBiasClamp:P}:null,targets:{writeMask:R>>>0,blendColor:{operation:T>>>0,srcFactor:A>>>0,dstFactor:L>>>0},blendAlpha:{operation:z>>>0,srcFactor:I>>>0,dstFactor:E>>>0},targets:q}});return Je.add(H)}function wt(e,t,r,n,a,s,l,i,o,c,f,u,g){const p=Ze(e);let d;switch(i){case 0:d={clearDepth:t,clearStencil:r,clearColor:isNaN(n)?null:[n,a,s,l]};break;case 1:{const e=[];for(let t=0;t<g;t++){const r=u+32*t,n=[Ee(p).getFloat32(r+16,!0),Ee(p).getFloat32(r+20,!0),Ee(p).getFloat32(r+24,!0),Ee(p).getFloat32(r+28,!0)];e.push({view:{texture:Je.get(Ee(p).getFloat64(r+0,!0)),mipLevel:Ee(p).getUint32(r+8,!0),slice:Ee(p).getUint32(r+12,!0)},clear:isNaN(n[0])?null:n})}d={clearDepth:t,clearStencil:r,colors:e,depthStencil:{texture:Je.get(o),mipLevel:c>>>0,slice:f>>>0}};break}default:throw new RangeError("invalid variant discriminant for RenderPassDescriptor")}const h=function(e,t={}){let r=null;const n=[],a=t.depthStencil?t.depthStencil.texture:null,s=a&&function(e){switch(e){case 36168:case I:case z:return!0}return!1}(a.format)||!1;if(t.colors&&t.colors.length){r=e.gl.createFramebuffer(),e.gl.bindFramebuffer(b,r);for(let r=0;r<t.colors.length;++r)t.colors[r].view.texture.samples>1?e.gl.framebufferRenderbuffer(b,x+r,m,t.colors[r].view.texture.glrb):Fe(e.gl,x+r,t.colors[r].view);t.colors.length>1&&e.gl.drawBuffers(t.colors.map(((e,t)=>x+t))),a&&(a.glrb?e.gl.framebufferRenderbuffer(b,s?_:F,m,a.glrb):Fe(e.gl,s?_:F,t.depthStencil));for(let r=0;r<t.colors.length;++r)n.push(t.colors[r].view.texture.samples>1?_e(e.gl,x,t.colors[r].view):null);n.push(a&&a.samples>1&&a.glt?_e(e.gl,s?_:F,t.depthStencil):null)}const l=e=>{e.deleteFramebuffer(r);for(const t of n)e.deleteFramebuffer(t)},i={gl:e.gl,glfb:r,glrfb:n,depth:a,color:t.colors?t.colors.map((e=>e.view.texture)):[],clearColors:t.colors?t.colors.map((e=>e.clear)):[],clearColor:t.clearColor,clearDepth:t.clearDepth,clearStencil:t.clearStencil,destroy(){l(this.gl)}};return ye.register(new WeakRef(i),{finalizer:l,gl:e.gl}),i}(Je.get(e),d);return Je.add(h)}function Ct(e,t,r,n,a){const s=function(e,t,r,n=0){const a={status:0};return function(e,t,r,n,a){const s=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);return e.flush(),function(e,t,r,n){return new Promise(((r,n)=>{!function a(){const s=e.clientWaitSync(t,0,0);37149==s?n():37147==s?setTimeout(a,10):r()}()}))}(e,s).finally((()=>e.deleteSync(s))).then((()=>{const s=new Uint8Array(a);return e.bindBuffer(t,r),e.getBufferSubData(t,n,s,0,a),s}))}(e.gl,t.type,t.glb,n,r.byteLength).then((e=>{r.set(e),a.status=1}),(()=>a.status=2)),a}(Je.get(e),Je.get(t),new Uint8Array(Ze(e).buffer.slice(n,n+1*a),r>>>0));return Ge.add(s)}function kt(e,t,r,n,a){!function(e,t,r,n=0){e.gl.bindBuffer(t.type,t.glb),e.gl.bufferSubData(t.type,n,r)}(Je.get(e),Je.get(t),new Uint8Array(Ze(e).buffer.slice(r,r+1*n)),a>>>0)}function Bt(e,t,r,n,a,s){!function(e,t,r,n=t.size,a=0,s=0){e.gl.bindBuffer(36662,t.glb),e.gl.bindBuffer(36663,r.glb),e.gl.copyBufferSubData(36662,36663,a,s,n)}(Je.get(e),Je.get(t),Je.get(r),n>>>0,a>>>0,s>>>0)}function Mt(e,t,r,n,a,s,l,i,o,c,f,u,h,b){!function(e,{texture:t,mipLevel:r=0,origin:[n,a,s]=[0,0,0]},l,{offset:i=0,bytesPerRow:o,rowsPerImage:c=0},[f,u,h]=[t.width-n,t.height-a,t.depth-s]){const b=ge(t.format),m=de(t.format),y=t.type===g,x=y?p+s:t.type;e.gl.activeTexture(d),e.gl.bindTexture(t.type,t.glt);const F=pe(t.format),_=c||u,v=Math.floor(o/F),w=i-i%o;if(e.gl.pixelStorei(32878,_),e.gl.pixelStorei(3314,v),e.gl.pixelStorei(3316,Math.floor(i%o/F)),e.gl.pixelStorei(S,0),e.gl.pixelStorei(32877,0),oe(t.type))e.gl.texSubImage3D(x,r,n,a,s,f,u,h,t.format,m,l,w);else if(y)for(let t=s;t<s+h;++t)e.gl.pixelStorei(S,t*v*_),e.gl.texSubImage2D(x+t,r,n,a,f,u,b,m,l,w);else e.gl.texSubImage2D(x,r,n,a,f,u,b,m,l,w)}(Je.get(e),{texture:Je.get(t),mipLevel:r>>>0,origin:[n>>>0,a>>>0,s>>>0]},new Uint8Array(Ze(e).buffer.slice(l,l+1*i)),{offset:o>>>0,bytesPerRow:c>>>0,rowsPerImage:f>>>0},[u>>>0,h>>>0,b>>>0])}function Ot(e,t,r,n,a,s,l,i,o,c,f){!function(e,{src:t,origin:[r,n]=[0,0]},{texture:a,mipLevel:s=0,origin:[l,i,o]=[0,0,0]},[c,f]=[t.width-r,t.height-n]){const u=de(a.format),h=a.type===g?p+o:a.type;e.gl.activeTexture(d),e.gl.bindTexture(a.type,a.glt),e.gl.pixelStorei(3316,r),e.gl.pixelStorei(S,n),e.gl.pixelStorei(32877,0),e.gl.pixelStorei(32878,0),oe(a.type)?e.gl.texSubImage3D(h,s,l,i,o,c,f,1,a.format,u,t):e.gl.texSubImage2D(h,s,l,i,c,f,ge(a.format),u,t)}(Je.get(e),{src:Ve.get(t),origin:[r>>>0,n>>>0]},{texture:Je.get(a),mipLevel:s>>>0,origin:[l>>>0,i>>>0,o>>>0]},[c>>>0,f>>>0])}function Dt(e,t,r,n,a,s,l,i,o,c,f,u,h,m){!function(e,{texture:t,mipLevel:r=0,origin:[n,a,s]=[0,0,0]},{texture:l,mipLevel:i=0,origin:[o,c,f]=[0,0,0]},[u,h,m]=[t.width-n,t.height-a,t.depth-s]){const y=l.type===g,F=y?p+f:l.type;if(e.gl.activeTexture(d),e.gl.bindTexture(l.type,l.glt),e.gl.readBuffer(x),e.gl.bindFramebuffer(b,e.state.copyFrameBuffer),oe(t.type)||t.type===g)for(let g=s;g<s+m;++g)Fe(e.gl,x,{texture:t,mipLevel:r,slice:g}),oe(l.type)?e.gl.copyTexSubImage3D(F+(y?g:0),i,o,c,f,n,a,u,h):e.gl.copyTexSubImage2D(F+(y?g:0),i,o,c,n,a,u,h);else{const s=0;Fe(e.gl,x,{texture:t,mipLevel:r,slice:s}),oe(l.type)?e.gl.copyTexSubImage3D(F+(y?s:0),i,o,c,f,n,a,u,h):e.gl.copyTexSubImage2D(F+(y?s:0),i,o,c,n,a,u,h)}e.gl.bindFramebuffer(b,e.pass?e.pass.glfb:null)}(Je.get(e),{texture:Je.get(t),mipLevel:r>>>0,origin:[n>>>0,a>>>0,s>>>0]},{texture:Je.get(l),mipLevel:i>>>0,origin:[o>>>0,c>>>0,f>>>0]},[u>>>0,h>>>0,m>>>0])}function Pt(e,t,r,n,a,s,l,i,o,c,f,u,p){!function(e,{texture:t,mipLevel:r=0,origin:[n,a,s]=[0,0,0]},l,{offset:i=0,bytesPerRow:o,rowsPerImage:c=0},[f,u,p]=[t.width-n,t.height-a,t.depth-s]){e.gl.bindBuffer(35051,l),e.gl.readBuffer(x),e.gl.bindFramebuffer(b,e.state.copyFrameBuffer);const d=de(t.format),h=ge(t.format),m=pe(t.format),y=c||u,F=Math.floor(o/m),_=i-i%o;if(e.gl.pixelStorei(3330,F),e.gl.pixelStorei(3332,Math.floor(i%o/m)),e.gl.pixelStorei(3331,0),oe(t.type)||t.type===g)for(let l=s;l<s+p;++l)Fe(e.gl,x,{texture:t,mipLevel:r,slice:l}),e.gl.readPixels(n,a,f,u,h,d,_+(l-s)*o*y);else{const s=0;Fe(e.gl,x,{texture:t,mipLevel:r,slice:s}),e.gl.readPixels(n,a,f,u,h,d,_)}e.gl.bindFramebuffer(b,e.pass?e.pass.glfb:null)}(Je.get(e),{texture:Je.get(t),mipLevel:r>>>0,origin:[n>>>0,a>>>0,s>>>0]},Je.get(l),{offset:i>>>0,bytesPerRow:o>>>0,rowsPerImage:c>>>0},[f>>>0,u>>>0,p>>>0])}function Ut(e,t){!function(e,t){let n=e.gl.drawingBufferWidth,a=e.gl.drawingBufferHeight;t.color.length&&(n=t.color[0].width,a=t.color[0].height),e.gl.bindFramebuffer(b,t.glfb),e.gl.viewport(0,0,n,a),e.gl.depthRange(0,1),e.state.scissor&&(e.state.scissor=!1,Me(e.gl,s,!1));let l=0;if(isNaN(t.clearDepth)||(l|=256,e.gl.clearDepth(t.clearDepth),ke(e.gl,e.state.state.depthWrite,!0),e.state.state.depthWrite=!0),isNaN(t.clearStencil)||(l|=1024,e.gl.clearStencil(t.clearStencil),Be(e.gl,e.state.state.stencilWriteMask,be),e.state.state.stencilWriteMask=be),Ce(e.gl,e.state.state.blendWriteMask,15),e.state.state.blendWriteMask=15,t.color.length){for(let r=0;r<t.color.length;++r)if(t.clearColors[r]){const n=he(t.color[r].format);n===i?e.gl.clearBufferiv(v,r,t.clearColors[r]):n===o?e.gl.clearBufferuiv(v,r,t.clearColors[r]):e.gl.clearBufferfv(v,r,t.clearColors[r])}}else t.clearColor&&(l|=r,e.gl.clearColor(...t.clearColor));l&&e.gl.clear(l),e.pass=t}(Je.get(e),Je.get(t))}function Wt(e,t,n,a,l,i,o){!function(e,t={}){e.gl.bindFramebuffer(b,null),e.gl.viewport(0,0,e.gl.drawingBufferWidth,e.gl.drawingBufferHeight),e.gl.depthRange(0,1),e.state.scissor&&(e.state.scissor=!1,Me(e.gl,s,!1));let n=0;isNaN(t.clearDepth)||(n|=256,e.gl.clearDepth(t.clearDepth),ke(e.gl,e.state.state.depthWrite,!0),e.state.state.depthWrite=!0),isNaN(t.clearStencil)||(n|=1024,e.gl.clearStencil(t.clearStencil),Be(e.gl,e.state.state.stencilWriteMask,be),e.state.state.stencilWriteMask=be),t.clearColor&&(n|=r,e.gl.clearColor(...t.clearColor),Ce(e.gl,e.state.state.blendWriteMask,15),e.state.state.blendWriteMask=15),n&&e.gl.clear(n),e.pass=null}(Je.get(e),{clearColor:isNaN(a)?null:[a,l,i,o],clearDepth:t,clearStencil:n})}function Rt(e){!function(e){if(e.pass){for(let t=0;t<e.pass.color.length;++t)e.pass.glrfb[t]&&Se(e.gl,e.pass.glfb,e.pass.glrfb[t],e.pass.color[t],r,x+t);const t=e.pass.glrfb[e.pass.glrfb.length-1];e.pass.depth&&t&&Se(e.gl,e.pass.glfb,t,e.pass.depth,1280)}e.pass=null}(Je.get(e))}function Tt(e,t){!function(e,t){if(e.state.pipeline===t)return;e.state.pipeline&&e.state.pipeline.glp===t.glp||e.gl.useProgram(t.glp),we(e.gl,e.state.state,t.state,e.state.stencilRef),Object.assign(e.state.state,t.state);const r=[];for(const{attributes:t}of e.state.buffers)for(const{ptr:e}of t)r[e[0]]=1;e.state.buffers=Array(t.buffers.length);for(let n=0;n<t.buffers.length;++n){const{attributes:a,stride:s,stepMode:l=0}=t.buffers[n],i=[];e.state.buffers[n]={glb:null,attributes:i,stride:s,step:l,offset:0,instanceOffset:0};for(const{format:e,offset:t,shaderLocation:o}of a)r[o]=(r[o]||0)+2,i.push({buffer:n,ptr:[o,ce(e),fe(e),ue(e),s,t],step:l})}for(let t=0;t<r.length;++t)2===r[t]?e.gl.enableVertexAttribArray(t):1===r[t]&&e.gl.disableVertexAttribArray(t);e.state.pipeline=t}(Je.get(e),Je.get(t))}function At(e,t){!function(e,t){t.glb!==e.state.index&&e.gl.bindBuffer(34963,e.state.index=t.glb)}(Je.get(e),Je.get(t))}function Lt(e,t,r,n){!function(e,t,r,n=0){const a=e.state.buffers[t];!a||a.glb===r.glb&&a.offset===n||(a.glb=r.glb,a.offset=n,a.instanceOffset=0,Oe(e.gl,a,n))}(Je.get(e),t>>>0,Je.get(r),n>>>0)}function zt(e,t,r,n,a){!function(e,t,r,n=[]){if(e.state.pipeline)for(let a=0,s=0;a<r.entries.length;++a){const l=r.entries[a],i=e.state.pipeline.cache[t]&&e.state.pipeline.cache[t][l.binding];if(i)if(l.buffer){let t=l.bufferOffset||0;i.bufferDynamicOffset&&(t+=n[s]||0,++s),e.gl.bindBufferRange(35345,i.slot,l.buffer.glb,t,l.bufferSize||l.buffer.size-t)}else l.texture?(e.gl.activeTexture(d+i.slot),e.gl.bindTexture(l.texture.type,l.texture.glt),e.gl.uniform1i(i.loc,i.slot)):l.sampler&&e.gl.bindSampler(i.slot,l.sampler.gls)}}(Je.get(e),t>>>0,Je.get(r),new Uint32Array(Ze(e).buffer.slice(n,n+4*a)))}function It(e,t,r,n,a){!function(e,t,r=1,n=0,a=0){for(const t of e.state.buffers)t.step&&t.instanceOffset!==a&&(t.instanceOffset=a,Oe(e.gl,t,a*t.stride));e.gl.drawArraysInstanced(e.state.state.topology,n,t,r)}(Je.get(e),t>>>0,r>>>0,n>>>0,a>>>0)}function Et(e,t,r,n,a){!function(e,t,r=1,n=0,a=0){for(const t of e.state.buffers)t.step&&t.instanceOffset!==a&&(t.instanceOffset=a,Oe(e.gl,t,a*t.stride));e.gl.drawElementsInstanced(e.state.state.topology,t,e.state.state.indexFormat,n*(e.state.state.indexFormat===l?2:4),r)}(Je.get(e),t>>>0,r>>>0,n>>>0,a>>>0)}function Nt(e,t,r,n,a,s,l){!function(e,t,r,n,a,s=0,l=1){e.gl.viewport(t,r,n,a),e.gl.depthRange(s,l)}(Je.get(e),t>>>0,r>>>0,n>>>0,a>>>0,s>>>0,l>>>0)}function jt(e,t,r,n,a){!function(e,t,r,n,a){e.state.scissor||(Me(e.gl,s,!0),e.state.scissor=!0),e.gl.scissor(t,r,n,a)}(Je.get(e),t>>>0,r>>>0,n>>>0,a>>>0)}function Gt(e,t,r,n,a){!function(e,t){e.gl.blendColor(...t)}(Je.get(e),[t,r,n,a])}function Vt(e,t){!function(e,t){if(e.state.stencilRef!==t){const{stencilFrontCompare:r,stencilBackCompare:s,stencilReadMask:l}=e.state.state;e.gl.stencilFuncSeparate(n,r,t,l),e.gl.stencilFuncSeparate(a,s,t,l),e.state.stencilRef=t}}(Je.get(e),t>>>0)}return t})()},"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("mugl",[],t):"object"==typeof exports?exports.mugl=t():e.mugl=t();