{"version":3,"sources":["../../../../../src/js/gltf/shaders/chunks/normal.glsl.ts"],"names":[],"mappings":"AAAA,cAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CA5DA","sourcesContent":["export default `\r\nuniform TextureInfo normalTexture;\r\n\r\n#ifdef USE_NORMAL\r\n#ifdef USE_TANGENT\r\nvarying mat3 vTBN;\r\n#else\r\nvarying vec3 vNormal;\r\n#endif\r\n#endif\r\n\r\nstruct NormalInfo {\r\n  vec3 ng;\r\n  vec3 n;\r\n  vec3 t;\r\n  vec3 b;\r\n};\r\n\r\nNormalInfo getNormalInfo(vec3 v) {\r\n  vec3 n, t, b, ng;\r\n\r\n#ifdef USE_TANGENT\r\n  t = normalize(vTBN[0]);\r\n  b = normalize(vTBN[1]);\r\n  ng = normalize(vTBN[2]);\r\n#else\r\n#ifdef USE_NORMAL\r\n  ng = normalize(vNormal);\r\n#else\r\n  ng = normalize(cross(dFdx(v), dFdy(v)));\r\n#endif\r\n  vec2 UV = getTexCoord(normalTexture);\r\n  vec3 uvDx = dFdx(vec3(UV, 0.));\r\n  vec3 uvDy = dFdy(vec3(UV, 0.));\r\n  vec3 t_ = (uvDy.t * dFdx(v) - uvDx.t * dFdy(v)) / (uvDx.s * uvDy.t - uvDy.s * uvDx.t);\r\n\r\n  t = normalize(t_ - ng * dot(ng, t_));\r\n  b = cross(ng, t);\r\n#endif\r\n\r\n  if (gl_FrontFacing == false) {\r\n    t *= -1.;\r\n    b *= -1.;\r\n    ng *= -1.;\r\n  }\r\n\r\n  n = ng;\r\n  if (normalTexture.texCoord >= 0.) {\r\n    n = texture(normalTexture).rgb * 2. - vec3(1.);\r\n    n *= vec3(normalTexture.scale, normalTexture.scale, 1.);\r\n    n = mat3(t, b, ng) * normalize(n);\r\n  }\r\n\r\n  NormalInfo ni;\r\n  ni.ng = ng;\r\n  ni.t = t;\r\n  ni.b = b;\r\n  ni.n = n;\r\n  return ni;\r\n}\r\n`;\r\n"],"file":"normal.glsl.js"}