{"version":3,"sources":["../../js/wasm/wasm.ts"],"names":["BindingType","FutureStatus","SamplerBindingType","TextureDimension","TextureSampleType","WebGL","Arena","dataView","decodeStr","toWebGLContextAttributes","contexts","futures","images","imageMap","canvases","canvasMap","canvasContextMap","resources","deviceContextMap","getMemory","context","memory","getDeviceMemory","resource","deleteResource","id","get","destroy","delete","set_context_memory","free_context","get_future_status","future","f","status","Pending","Done","create_image","ptr","len","img","Image","crossOrigin","src","add","get_image_by_id","image","document","getElementById","delete_image","get_image_width","width","get_image_height","height","get_canvas_by_id","canvas","canvasId","get_canvas_width","get_canvas_height","webgl_request_device","attrs","features","device","requestWebGL2Device","deviceId","webgl_generate_mipmap","tex","hint","generateMipmap","reset_device","resetDevice","delete_device","is_device_lost","isDeviceLost","get_device_features","getDeviceFeatures","create_buffer","size","usage","ret","createBuffer","delete_buffer","create_texture","depth","mipLevelCount","sampleCount","dimension","format","createTexture","delete_texture","create_sampler","addressModeU","addressModeV","addressModeW","magFilter","minFilter","mipmapFilter","lodMinClamp","lodMaxClamp","compare","maxAnisotropy","createSampler","delete_sampler","create_shader","codePtr","codeLen","createShader","code","delete_shader","create_bind_group_layout","entriesPtr","entriesLen","entries","i","base","ptr0","getUint32","len0","type","getUint8","bufferDynamicOffset","samplerType","Filtering","textureSampleType","Float","textureDimension","D2","textureMultisampled","Buffer","Sampler","Texture","RangeError","push","label","binding","visibility","createBindGroupLayout","delete_bind_group_layout","create_bind_group","layout","buffer","bufferOffset","bufferSize","sampler","texture","getFloat64","createBindGroup","delete_bind_group","create_render_pipeline","vertex","fragment","attributesPtr","attributesLen","buffersPtr","buffersLen","bindGroupsPtr","bindGroupsLen","topology","indexFormat","frontFace","cullMode","alphaToCoverage","hasDepthStencil","depthStencilFormat","depthWrite","depthCompare","stencilFrontCompare","stencilFrontFailOp","stencilFrontDepthFailOp","stencilFrontPassOp","stencilBackCompare","stencilBackFailOp","stencilBackDepthFailOp","stencilBackPassOp","stencilReadMask","stencilWriteMask","depthBias","depthBiasSlopeScale","depthBiasClamp","colorsPtr","colorsLen","colorWriteMask","blendColorOperation","blendColorSrcFactor","blendColorDstFactor","blendAlphaOperation","blendAlphaSrcFactor","blendAlphaDstFactor","attributes","offset","shaderLocation","buffers","start","slice","stride","stepMode","bindGroups","targets","writeMask","blendColor","operation","srcFactor","dstFactor","blendAlpha","createRenderPipeline","primitive","multisample","depthStencil","stencilFront","failOp","depthFailOp","passOp","stencilBack","delete_render_pipeline","create_render_pass","clearDepth","clearStencil","clearColorRed","clearColorGreen","clearColorBlue","clearColorAlpha","isOffscreen","depthStencilTexture","depthStecilMipLevel","depthStecilSlice","desc","clearColor","isNaN","colors","clear","getFloat32","view","mipLevel","createRenderPass","delete_render_pass","read_buffer","outPtr","readBuffer","Uint8Array","write_buffer","dataPtr","writeBuffer","copy_buffer","dst","srcOffset","dstOffset","copyBuffer","write_texture","x","y","z","dataLen","bytesPerRow","rowsPerImage","writeTexture","origin","copy_external_image_to_texture","srcX","srcY","dstX","dstY","dstZ","copyExternalImageToTexture","copy_texture","srcMipLevel","srcZ","dstMipLevel","copyTexture","copy_texture_to_buffer","copyTextureToBuffer","begin_render_pass","pass","beginRenderPass","begin_default_pass","beginDefaultPass","submit_render_pass","submitRenderPass","set_render_pipeline","pipeline","setRenderPipeline","set_index","index","setIndex","set_vertex","slot","setVertex","set_bind_group","bindGroup","offsetsPtr","offsetsLen","setBindGroup","Uint32Array","draw","vertexCount","instanceCount","firstVertex","firstInstance","draw_indexed","indexCount","firstIndex","drawIndexed","set_viewport","minDepth","maxDepth","setViewport","set_scissor_rect","setScissorRect","set_blend_const","red","green","blue","alpha","setBlendConst","set_stencil_ref","ref","setStencilRef"],"mappings":"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","sourcesContent":["import {\n  AddressMode, BindGroup, BindGroupLayout, BindGroupLayoutEntry, BindingType, Buffer, BufferUsage, Canvas, Color,\n  ColorAttachment, ColorTargetState, CompareFunction, CullMode, Device, FilterMode, Float, FrontFace, Future,\n  FutureStatus, ImageSource, IndexFormat, MipmapHint, PrimitiveTopology, RenderPass, RenderPassDescriptor,\n  RenderPipeline, Resource, Sampler, SamplerBindingType, Shader, ShaderStage, StencilOperation, Texture,\n  TextureDimension, TextureFormat, TextureSampleType, TextureUsage, UInt, VertexAttribute, VertexBufferLayout\n} from '../gpu';\nimport * as WebGL from '../gpu/gl2';\nimport { Arena } from '../store';\nimport { dataView, decodeStr, toWebGLContextAttributes } from './deserialize';\n\nexport type ContextId = number;\nexport type FutureId = number;\nexport type ImageSourceId = number;\nexport type CanvasId = number;\nexport type ResourceId = number;\n\nconst contexts: Record<ContextId, { memory: WebAssembly.Memory | null }> = {};\nconst futures = new Arena<Future>();\nconst images = new Arena<ImageSource>();\nconst imageMap: Record<string, ImageSourceId> = {};\nconst canvases = new Arena<Canvas>();\nconst canvasMap: Record<string, CanvasId> = {};\nconst canvasContextMap: Record<CanvasId, ContextId> = {};\nconst resources = new Arena<Resource>();\nconst deviceContextMap: Record<ResourceId, ContextId> = {};\n\nfunction getMemory(context: ContextId): WebAssembly.Memory {\n  // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n  return contexts[context].memory!;\n}\n\nfunction getDeviceMemory(resource: ResourceId): WebAssembly.Memory {\n  return getMemory(deviceContextMap[resource]);\n}\n\nfunction deleteResource(id: ResourceId): void {\n  const resource = resources.get(id);\n  if (resource) {\n    resource.destroy();\n    resources.delete(id);\n  }\n}\n\nexport function set_context_memory(context: ContextId, memory: WebAssembly.Memory): void {\n  (contexts[context] = contexts[context] || { memory: null }).memory = memory;\n}\n\nexport function free_context(context: ContextId): void {\n  delete contexts[context];\n}\n\nexport function get_future_status(future: FutureId): FutureStatus {\n  const f = futures.get(future);\n  if (f) {\n    if (f.status !== FutureStatus.Pending) {\n      futures.delete(future);\n    }\n    return f.status;\n  }\n  return FutureStatus.Done;\n}\n\nexport function create_image(context: ContextId, ptr: UInt, len: UInt): ImageSourceId {\n  const img = new Image();\n  img.crossOrigin = 'anonymous';\n  img.src = decodeStr(getMemory(context), ptr, len);\n  return images.add(img);\n}\n\nexport function get_image_by_id(context: ContextId, ptr: UInt, len: UInt): ImageSourceId {\n  const id = decodeStr(getMemory(context), ptr, len);\n  if (imageMap[id]) {\n    return imageMap[id];\n  }\n  const image = document.getElementById(id) as ImageSource;\n  if (!image) {\n    return 0 as ImageSourceId;\n  }\n  return (imageMap[id] = images.add(image));\n}\n\nexport function delete_image(img: ImageSourceId): void {\n  images.delete(img);\n}\n\nexport function get_image_width(img: ImageSourceId): UInt {\n  return images.get(img)?.width || 0;\n}\n\nexport function get_image_height(img: ImageSourceId): UInt {\n  return images.get(img)?.height || 0;\n}\n\nexport function get_canvas_by_id(context: ContextId, ptr: UInt, len: UInt): CanvasId {\n  const id = decodeStr(getMemory(context), ptr, len);\n  if (canvasMap[id]) {\n    return canvasMap[id];\n  }\n  const canvas = document.getElementById(id) as Canvas;\n  if (!canvas) {\n    return 0 as CanvasId;\n  }\n  const canvasId = canvasMap[id] = canvases.add(canvas);\n  canvasContextMap[canvasId] = context;\n  return canvasId;\n}\n\nexport function get_canvas_width(canvas: CanvasId): UInt {\n  return canvases.get(canvas)?.width || 0;\n}\n\nexport function get_canvas_height(canvas: CanvasId): UInt {\n  return canvases.get(canvas)?.height || 0;\n}\n\nexport function webgl_request_device(canvasId: CanvasId, attrs: UInt, features: UInt): ResourceId {\n  const canvas = canvases.get(canvasId);\n  if (canvas) {\n    const device = WebGL.requestWebGL2Device(canvas, toWebGLContextAttributes(attrs), features);\n    if (device) {\n      const deviceId = resources.add(device);\n      deviceContextMap[deviceId] = canvasContextMap[canvasId];\n      return deviceId;\n    }\n  }\n  return 0 as ResourceId;\n}\n\nexport function webgl_generate_mipmap(device: ResourceId, tex: ResourceId, hint: MipmapHint): void {\n  WebGL.generateMipmap(resources.get(device) as Device, resources.get(tex) as Texture, hint);\n}\n\nexport function reset_device(device: ResourceId): void {\n  WebGL.resetDevice(resources.get(device) as Device);\n}\n\nexport function delete_device(device: ResourceId): void {\n  deleteResource(device);\n  delete deviceContextMap[device];\n}\n\nexport function is_device_lost(device: ResourceId): boolean {\n  return WebGL.isDeviceLost(resources.get(device) as Device);\n}\n\nexport function get_device_features(device: ResourceId): UInt {\n  return WebGL.getDeviceFeatures(resources.get(device) as Device);\n}\n\nexport function create_buffer(device: ResourceId, size: UInt, usage: BufferUsage): ResourceId {\n  const ret = WebGL.createBuffer(resources.get(device) as Device, {\n    size: size >>> 0,\n    usage: usage >>> 0,\n  });\n  return resources.add(ret);\n}\n\nexport { deleteResource as delete_buffer };\n\nexport function create_texture(\n  device: ResourceId,\n  width: UInt, height: UInt, depth: UInt,\n  mipLevelCount: UInt,\n  sampleCount: UInt,\n  dimension: TextureDimension,\n  format: TextureFormat,\n  usage: TextureUsage\n): ResourceId {\n  const ret = WebGL.createTexture(resources.get(device) as Device, {\n    size: [width >>> 0, height >>> 0, depth >>> 0],\n    mipLevelCount: mipLevelCount >>> 0,\n    sampleCount: sampleCount >>> 0,\n    dimension: dimension >>> 0,\n    format: format >>> 0,\n    usage: usage >>> 0,\n  });\n  return resources.add(ret);\n}\n\nexport { deleteResource as delete_texture };\n\nexport function create_sampler(\n  device: ResourceId,\n  addressModeU: AddressMode, addressModeV: AddressMode, addressModeW: AddressMode,\n  magFilter: FilterMode, minFilter: FilterMode, mipmapFilter: FilterMode,\n  lodMinClamp: Float, lodMaxClamp: Float,\n  compare: CompareFunction,\n  maxAnisotropy: UInt\n): ResourceId {\n  const ret = WebGL.createSampler(resources.get(device) as Device, {\n    addressModeU: addressModeU >>> 0,\n    addressModeV: addressModeV >>> 0,\n    addressModeW: addressModeW >>> 0,\n    magFilter: magFilter >>> 0,\n    minFilter: minFilter >>> 0,\n    mipmapFilter: mipmapFilter >>> 0,\n    lodMinClamp,\n    lodMaxClamp,\n    compare: compare >>> 0,\n    maxAnisotropy: maxAnisotropy >>> 0,\n  });\n  return resources.add(ret);\n}\n\nexport { deleteResource as delete_sampler };\n\nexport function create_shader(device: ResourceId, codePtr: UInt, codeLen: UInt, usage: ShaderStage): ResourceId {\n  const ret = WebGL.createShader(resources.get(device) as Device, {\n    code: decodeStr(getDeviceMemory(device), codePtr, codeLen),\n    usage: usage >>> 0,\n  });\n  return resources.add(ret);\n}\n\nexport { deleteResource as delete_shader };\n\nexport function create_bind_group_layout(device: ResourceId, entriesPtr: UInt, entriesLen: UInt): ResourceId {\n  const memory = getDeviceMemory(device);\n  const entries: BindGroupLayoutEntry[] = [];\n  for (let i = 0; i < entriesLen; i++) {\n    const base = entriesPtr + i * 32;\n    const ptr0 = dataView(memory).getUint32(base + 0, true);\n    const len0 = dataView(memory).getUint32(base + 4, true);\n    const type = dataView(memory).getUint8(base + 16);\n    let bufferDynamicOffset = false;\n    let samplerType = SamplerBindingType.Filtering;\n    let textureSampleType = TextureSampleType.Float;\n    let textureDimension = TextureDimension.D2;\n    let textureMultisampled = false;\n\n    switch (type) {\n      case BindingType.Buffer:\n        bufferDynamicOffset = !!dataView(memory).getUint8(base + 20);\n        break;\n      case BindingType.Sampler:\n        samplerType = dataView(memory).getUint32(base + 20, true) >>> 0;\n        break;\n      case BindingType.Texture:\n        textureSampleType = dataView(memory).getUint32(base + 20, true) >>> 0;\n        textureDimension = dataView(memory).getUint32(base + 24, true) >>> 0;\n        textureMultisampled = !!dataView(memory).getUint8(base + 28);\n        break;\n      default:\n        throw new RangeError('invalid variant discriminant for BindingType');\n    }\n    entries.push({\n      label: decodeStr(memory, ptr0, len0),\n      binding: dataView(memory).getUint32(base + 8, true) >>> 0,\n      visibility: dataView(memory).getUint32(base + 12, true) >>> 0,\n      type,\n      bufferDynamicOffset,\n      samplerType,\n      textureSampleType,\n      textureDimension,\n      textureMultisampled,\n    });\n  }\n  const ret = WebGL.createBindGroupLayout(resources.get(device) as Device, { entries });\n  return resources.add(ret);\n}\n\nexport { deleteResource as delete_bind_group_layout };\n\nexport function create_bind_group(device: ResourceId, layout: ResourceId, entriesPtr: UInt, entriesLen: UInt): ResourceId {\n  const memory = getDeviceMemory(device);\n  const entries = [];\n  for (let i = 0; i < entriesLen; i++) {\n    const base = entriesPtr + i * 24;\n    const type = dataView(memory).getUint8(base + 4);\n    let buffer: Buffer | null = null;\n    let bufferOffset = 0;\n    let bufferSize = 0;\n    let sampler: Sampler | null = null;\n    let texture: Texture | null = null;\n\n    switch (type) {\n      case BindingType.Buffer:\n        buffer = resources.get(dataView(memory).getFloat64(base + 8, true) as ResourceId) as Buffer;\n        bufferOffset = dataView(memory).getUint32(base + 16, true);\n        bufferSize = dataView(memory).getUint32(base + 20, true);\n        break;\n      case BindingType.Sampler:\n        sampler = resources.get(dataView(memory).getFloat64(base + 8, true) as ResourceId) as Sampler;\n        break;\n      case BindingType.Texture:\n        texture = resources.get(dataView(memory).getFloat64(base + 8, true) as ResourceId) as Texture;\n        break;\n      default:\n        throw new RangeError('invalid variant discriminant for BindingResource');\n    }\n    entries.push({\n      binding: dataView(memory).getUint32(base + 0, true),\n      buffer,\n      bufferOffset,\n      bufferSize,\n      sampler,\n      texture\n    });\n  }\n  const ret = WebGL.createBindGroup(resources.get(device) as Device, {\n    layout: resources.get(layout) as BindGroupLayout,\n    entries,\n  });\n  return resources.add(ret);\n}\n\nexport { deleteResource as delete_bind_group };\n\nexport function create_render_pipeline(\n  device: ResourceId,\n  vertex: ResourceId, fragment: ResourceId,\n  attributesPtr: UInt, attributesLen: UInt,\n  buffersPtr: UInt, buffersLen: UInt,\n  bindGroupsPtr: UInt, bindGroupsLen: UInt,\n  topology: PrimitiveTopology, indexFormat: IndexFormat, frontFace: FrontFace, cullMode: CullMode,\n  sampleCount: UInt, alphaToCoverage: UInt,\n  hasDepthStencil: UInt, depthStencilFormat: TextureFormat, depthWrite: UInt, depthCompare: CompareFunction,\n  stencilFrontCompare: CompareFunction, stencilFrontFailOp: StencilOperation, stencilFrontDepthFailOp: StencilOperation, stencilFrontPassOp: StencilOperation,\n  stencilBackCompare: CompareFunction, stencilBackFailOp: StencilOperation, stencilBackDepthFailOp: StencilOperation, stencilBackPassOp: StencilOperation,\n  stencilReadMask: UInt, stencilWriteMask: UInt, depthBias: Float, depthBiasSlopeScale: Float, depthBiasClamp: Float,\n  colorsPtr: UInt, colorsLen: UInt,\n  colorWriteMask: UInt, blendColorOperation: UInt, blendColorSrcFactor: UInt, blendColorDstFactor: UInt, blendAlphaOperation: UInt, blendAlphaSrcFactor: UInt, blendAlphaDstFactor: UInt\n): ResourceId {\n  const memory = getDeviceMemory(device);\n  const attributes: VertexAttribute[] = [];\n  for (let i = 0; i < attributesLen; i++) {\n    const base = attributesPtr + i * 12;\n    attributes.push({\n      format: dataView(memory).getUint32(base + 0, true),\n      offset: dataView(memory).getUint32(base + 4, true),\n      shaderLocation: dataView(memory).getUint32(base + 8, true),\n    });\n  }\n\n  const buffers: VertexBufferLayout[] = [];\n  for (let i = 0; i < buffersLen; i++) {\n    const base = buffersPtr + i * 16;\n    const start = dataView(memory).getUint32(base + 0, true);\n    const len = dataView(memory).getUint32(base + 4, true);\n    buffers.push({\n      attributes: attributes.slice(start, start + len),\n      stride: dataView(memory).getUint32(base + 8, true),\n      stepMode: dataView(memory).getUint32(base + 12, true),\n    });\n  }\n\n  const bindGroups: BindGroupLayout[] = [];\n  for (let i = 0; i < bindGroupsLen; i++) {\n    const base = bindGroupsPtr + i * 8;\n    bindGroups.push(resources.get(dataView(memory).getFloat64(base + 0, true) as ResourceId) as BindGroupLayout);\n  }\n\n  const targets: ColorTargetState[] = [];\n  for (let i = 0; i < colorsLen; i++) {\n    const base = colorsPtr + i * 32;\n    targets.push({\n      format: dataView(memory).getUint32(base + 0, true) >>> 0,\n      writeMask: dataView(memory).getUint32(base + 4, true) >>> 0,\n      blendColor: {\n        operation: dataView(memory).getUint32(base + 8, true) >>> 0,\n        srcFactor: dataView(memory).getUint32(base + 12, true) >>> 0,\n        dstFactor: dataView(memory).getUint32(base + 16, true) >>> 0,\n      },\n      blendAlpha: {\n        operation: dataView(memory).getUint32(base + 20, true) >>> 0,\n        srcFactor: dataView(memory).getUint32(base + 24, true) >>> 0,\n        dstFactor: dataView(memory).getUint32(base + 28, true) >>> 0,\n      }\n\n    });\n  }\n\n  const ret = WebGL.createRenderPipeline(resources.get(device) as Device, {\n    vertex: resources.get(vertex) as Shader,\n    fragment: resources.get(fragment) as Shader,\n    buffers,\n    bindGroups,\n    primitive: {\n      topology: topology >>> 0,\n      indexFormat: indexFormat >>> 0,\n      frontFace: frontFace >>> 0,\n      cullMode: cullMode >>> 0,\n    },\n    multisample: {\n      sampleCount: sampleCount >>> 0,\n      alphaToCoverage: !!alphaToCoverage,\n    },\n    depthStencil: hasDepthStencil ? {\n      format: depthStencilFormat >>> 0,\n      depthWrite: !!depthWrite,\n      depthCompare: depthCompare >>> 0,\n      stencilFront: {\n        compare: stencilFrontCompare >>> 0,\n        failOp: stencilFrontFailOp >>> 0,\n        depthFailOp: stencilFrontDepthFailOp >>> 0,\n        passOp: stencilFrontPassOp >>> 0,\n      },\n      stencilBack: {\n        compare: stencilBackCompare >>> 0,\n        failOp: stencilBackFailOp >>> 0,\n        depthFailOp: stencilBackDepthFailOp >>> 0,\n        passOp: stencilBackPassOp >>> 0,\n      },\n      stencilReadMask: stencilReadMask >>> 0,\n      stencilWriteMask: stencilWriteMask >>> 0,\n      depthBias,\n      depthBiasSlopeScale,\n      depthBiasClamp,\n    } : null,\n    targets: {\n      writeMask: colorWriteMask >>> 0,\n      blendColor: {\n        operation: blendColorOperation >>> 0,\n        srcFactor: blendColorSrcFactor >>> 0,\n        dstFactor: blendColorDstFactor >>> 0,\n      },\n      blendAlpha: {\n        operation: blendAlphaOperation >>> 0,\n        srcFactor: blendAlphaSrcFactor >>> 0,\n        dstFactor: blendAlphaDstFactor >>> 0,\n      },\n      targets,\n    }\n\n  });\n\n  return resources.add(ret);\n}\n\nexport { deleteResource as delete_render_pipeline };\n\nexport function create_render_pass(\n  device: ResourceId,\n  clearDepth: Float, clearStencil: Float,\n  clearColorRed: Float, clearColorGreen: Float, clearColorBlue: Float, clearColorAlpha: Float,\n  isOffscreen: UInt,\n  depthStencilTexture: ResourceId, depthStecilMipLevel: UInt, depthStecilSlice: UInt,\n  colorsPtr: UInt, colorsLen: UInt\n): ResourceId {\n  const memory = getDeviceMemory(device);\n  let desc: RenderPassDescriptor;\n  switch (isOffscreen) {\n    case 0:  // Default pass\n      desc = {\n        clearDepth,\n        clearStencil,\n        clearColor: isNaN(clearColorRed) ? null : [clearColorRed, clearColorGreen, clearColorBlue, clearColorAlpha],\n      };\n      break;\n    case 1: { // Offscreen pass\n      const colors: ColorAttachment[] = [];\n      for (let i = 0; i < colorsLen; i++) {\n        const base = colorsPtr + i * 32;\n        const clear: Color = [\n          dataView(memory).getFloat32(base + 16, true),\n          dataView(memory).getFloat32(base + 20, true),\n          dataView(memory).getFloat32(base + 24, true),\n          dataView(memory).getFloat32(base + 28, true)\n        ];\n        colors.push({\n          view: {\n            texture: resources.get(dataView(memory).getFloat64(base + 0, true) as ResourceId) as Texture,\n            mipLevel: dataView(memory).getUint32(base + 8, true),\n            slice: dataView(memory).getUint32(base + 12, true),\n          },\n          clear: isNaN(clear[0]) ? null : clear,\n        });\n      }\n      desc = {\n        clearDepth,\n        clearStencil,\n        colors,\n        depthStencil: {\n          texture: resources.get(depthStencilTexture) as Texture,\n          mipLevel: depthStecilMipLevel >>> 0,\n          slice: depthStecilSlice >>> 0,\n        }\n\n      };\n      break;\n    }\n    default:\n      throw new RangeError('invalid variant discriminant for RenderPassDescriptor');\n  }\n  const ret = WebGL.createRenderPass(resources.get(device) as Device, desc);\n  return resources.add(ret);\n}\n\nexport { deleteResource as delete_render_pass };\n\nexport function read_buffer(device: ResourceId, buffer: ResourceId, offset: UInt, outPtr: UInt, size: UInt): FutureId {\n  const ret = WebGL.readBuffer(\n    resources.get(device) as Device,\n    resources.get(buffer) as Buffer,\n    new Uint8Array(getDeviceMemory(device).buffer.slice(outPtr, outPtr + size * 1),\n      offset >>> 0)\n  );\n  return futures.add(ret);\n}\n\nexport function write_buffer(device: ResourceId, buffer: ResourceId, dataPtr: UInt, size: UInt, offset: UInt): void {\n  WebGL.writeBuffer(resources.get(device) as Device, resources.get(buffer) as Buffer, new Uint8Array(getDeviceMemory(device).buffer.slice(dataPtr, dataPtr + size * 1)), offset >>> 0);\n}\n\nexport function copy_buffer(device: ResourceId, src: ResourceId, dst: ResourceId, size: UInt, srcOffset: UInt, dstOffset: UInt): void {\n  WebGL.copyBuffer(resources.get(device) as Device, resources.get(src) as Buffer, resources.get(dst) as Buffer, size >>> 0, srcOffset >>> 0, dstOffset >>> 0);\n}\n\nexport function write_texture(\n  device: ResourceId,\n  texture: ResourceId, mipLevel: UInt, x: UInt, y: UInt, z: UInt,\n  dataPtr: UInt, dataLen: UInt,\n  offset: UInt, bytesPerRow: UInt, rowsPerImage: UInt,\n  width: UInt, height: UInt, depth: UInt\n) {\n  WebGL.writeTexture(resources.get(device) as Device, {\n    texture: resources.get(texture) as Texture,\n    mipLevel: mipLevel >>> 0,\n    origin: [x >>> 0, y >>> 0, z >>> 0],\n  },\n    new Uint8Array(getDeviceMemory(device).buffer.slice(dataPtr, dataPtr + dataLen * 1)), {\n    offset: offset >>> 0,\n    bytesPerRow: bytesPerRow >>> 0,\n    rowsPerImage: rowsPerImage >>> 0,\n  },\n    [width >>> 0, height >>> 0, depth >>> 0]);\n}\n\nexport function copy_external_image_to_texture(\n  device: ResourceId,\n  src: ImageSourceId, srcX: UInt, srcY: UInt,\n  dst: ResourceId, mipLevel: UInt, dstX: UInt, dstY: UInt, dstZ: UInt,\n  width: UInt, height: UInt\n): void {\n  WebGL.copyExternalImageToTexture(resources.get(device) as Device,\n    {\n      src: images.get(src) as TexImageSource,\n      origin: [srcX >>> 0, srcY >>> 0],\n    },\n    {\n      texture: resources.get(dst) as Texture,\n      mipLevel: mipLevel >>> 0,\n      origin: [dstX >>> 0, dstY >>> 0, dstZ >>> 0],\n    },\n    [width >>> 0, height >>> 0]);\n}\n\nexport function copy_texture(\n  device: ResourceId,\n  src: ResourceId, srcMipLevel: UInt, srcX: UInt, srcY: UInt, srcZ: UInt,\n  dst: ResourceId, dstMipLevel: UInt, dstX: UInt, dstY: UInt, dstZ: UInt,\n  width: UInt, height: UInt, depth: UInt\n) {\n  WebGL.copyTexture(resources.get(device) as Device,\n    {\n      texture: resources.get(src) as Texture,\n      mipLevel: srcMipLevel >>> 0,\n      origin: [srcX >>> 0, srcY >>> 0, srcZ >>> 0],\n    },\n    {\n      texture: resources.get(dst) as Texture,\n      mipLevel: dstMipLevel >>> 0,\n      origin: [dstX >>> 0, dstY >>> 0, dstZ >>> 0],\n    },\n    [width >>> 0, height >>> 0, depth >>> 0]);\n}\n\nexport function copy_texture_to_buffer(\n  device: ResourceId,\n  src: ResourceId, srcMipLevel: UInt, srcX: UInt, srcY: UInt, srcZ: UInt,\n  dst: ResourceId,\n  offset: UInt, bytesPerRow: UInt, rowsPerImage: UInt,\n  width: UInt, height: UInt, depth: UInt\n): void {\n  WebGL.copyTextureToBuffer(resources.get(device) as Device,\n    {\n      texture: resources.get(src) as Texture,\n      mipLevel: srcMipLevel >>> 0,\n      origin: [srcX >>> 0, srcY >>> 0, srcZ >>> 0],\n    },\n    resources.get(dst) as Buffer,\n    {\n      offset: offset >>> 0,\n      bytesPerRow: bytesPerRow >>> 0,\n      rowsPerImage: rowsPerImage >>> 0,\n    },\n    [width >>> 0, height >>> 0, depth >>> 0]);\n}\n\n\nexport function begin_render_pass(device: ResourceId, pass: ResourceId): void {\n  WebGL.beginRenderPass(resources.get(device) as Device, resources.get(pass) as RenderPass);\n}\n\nexport function begin_default_pass(\n  device: ResourceId,\n  clearDepth: Float, clearStencil: Float,\n  clearColorRed: Float, clearColorGreen: Float, clearColorBlue: Float, clearColorAlpha: Float,\n): void {\n  WebGL.beginDefaultPass(resources.get(device) as Device, {\n    clearColor: isNaN(clearColorRed) ? null : [clearColorRed, clearColorGreen, clearColorBlue, clearColorAlpha],\n    clearDepth,\n    clearStencil,\n  });\n}\n\nexport function submit_render_pass(device: ResourceId): void {\n  WebGL.submitRenderPass(resources.get(device) as Device);\n}\n\nexport function set_render_pipeline(device: ResourceId, pipeline: ResourceId): void {\n  WebGL.setRenderPipeline(resources.get(device) as Device, resources.get(pipeline) as RenderPipeline);\n}\n\nexport function set_index(device: ResourceId, index: ResourceId): void {\n  WebGL.setIndex(resources.get(device) as Device, resources.get(index) as Buffer);\n}\n\nexport function set_vertex(device: ResourceId, slot: UInt, vertex: ResourceId, offset: UInt): void {\n  WebGL.setVertex(resources.get(device) as Device, slot >>> 0, resources.get(vertex) as Buffer, offset >>> 0);\n}\n\nexport function set_bind_group(device: ResourceId, slot: UInt, bindGroup: ResourceId, offsetsPtr: UInt, offsetsLen: UInt): void {\n  WebGL.setBindGroup(\n    resources.get(device) as Device, slot >>> 0,\n    resources.get(bindGroup) as BindGroup,\n    new Uint32Array(getDeviceMemory(device).buffer.slice(offsetsPtr, offsetsPtr + offsetsLen * 4)) as unknown as UInt[]\n  );\n}\n\nexport function draw(device: ResourceId, vertexCount: UInt, instanceCount: UInt, firstVertex: UInt, firstInstance: UInt): void {\n  WebGL.draw(resources.get(device) as Device, vertexCount >>> 0, instanceCount >>> 0, firstVertex >>> 0, firstInstance >>> 0);\n}\n\nexport function draw_indexed(device: ResourceId, indexCount: UInt, instanceCount: UInt, firstIndex: UInt, firstInstance: UInt): void {\n  WebGL.drawIndexed(resources.get(device) as Device, indexCount >>> 0, instanceCount >>> 0, firstIndex >>> 0, firstInstance >>> 0);\n}\n\nexport function set_viewport(device: ResourceId, x: UInt, y: UInt, width: UInt, height: UInt, minDepth: UInt, maxDepth: UInt): void {\n  WebGL.setViewport(resources.get(device) as Device, x >>> 0, y >>> 0, width >>> 0, height >>> 0, minDepth >>> 0, maxDepth >>> 0);\n}\n\nexport function set_scissor_rect(device: ResourceId, x: UInt, y: UInt, width: UInt, height: UInt): void {\n  WebGL.setScissorRect(resources.get(device) as Device, x >>> 0, y >>> 0, width >>> 0, height >>> 0);\n}\n\nexport function set_blend_const(device: ResourceId, red: Float, green: Float, blue: Float, alpha: Float): void {\n  WebGL.setBlendConst(resources.get(device) as Device, [red, green, blue, alpha]);\n}\n\nexport function set_stencil_ref(device: ResourceId, ref: UInt): void {\n  WebGL.setStencilRef(resources.get(device) as Device, ref >>> 0);\n}\n"],"file":"wasm.js"}